<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Utilities – tsai</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-2c2b2e643518224cf2d75a643cacf640.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Utilities – tsai">
<meta property="og:description" content="Practical Deep Learning for Time Series / Sequential Data library based on fastai &amp; Pytorch">
<meta property="og:image" content="https://timeseriesAI.github.io/tsai/002_utils_files/figure-html/cell-103-output-1.png">
<meta property="og:site_name" content="tsai">
<meta property="og:image:height" content="413">
<meta property="og:image:width" content="543">
<meta name="twitter:title" content="Utilities – tsai">
<meta name="twitter:description" content="Practical Deep Learning for Time Series / Sequential Data library based on fastai &amp; Pytorch">
<meta name="twitter:image" content="https://timeseriesAI.github.io/tsai/002_utils_files/figure-html/cell-103-output-1.png">
<meta name="twitter:image-height" content="413">
<meta name="twitter:image-width" content="543">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">tsai</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/timeseriesAI/tsai"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./utils.html">Utilities</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">tsai</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial notebooks</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.core.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Core</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.external.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">External data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.preparation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data preparation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.validation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spliting data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.preprocessing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data preprocessing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.unwindowed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unwindowed datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.transforms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time Series Data Augmentation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.mixed_augmentation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Label-mixing transforms</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.image.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Imaging Time Series</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.features.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Featurizing Time Series</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.tabular.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time Series Tabular Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.metadatasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metadataset</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.layers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Layers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.utils.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model utilities</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">MLPs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.mlp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MLP</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.gmlp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">gMLP</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">RNNs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RNNs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rnnplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RNNPlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rnnattention.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RNNAttention</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tssequencerplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TSSequencerPlus</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">CNNs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.fcn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FCN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.fcnplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FCNPlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.resnet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ResNet</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.resnetplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ResNetPlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.xresnet1d.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">XResNet1d</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.xresnet1dplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">XResNet1dPlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rescnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ResCNN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tcn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TCN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.inceptiontime.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">InceptionTime</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.inceptiontimeplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">InceptionTimePlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.xceptiontime.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">XceptionTime</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.xceptiontimeplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">XceptionTimePlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.omniscalecnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OmniScaleCNN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.xcm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">XCM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.xcmplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">XCMPlus</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Transformers</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.positional_encoders.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Positional encoders</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.transformermodel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TransformerModel</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tst.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TST</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tstplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TSTPlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tsperceiver.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TSPerceiver</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tsitplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TSiT</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.patchtst.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PatchTST</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">ROCKETs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rocket.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ROCKET</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rocket_pytorch.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ROCKET Pytorch</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.minirocket.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MINIROCKET</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.minirocket_pytorch.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MINIROCKET Pytorch</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.minirocketplus_pytorch.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MINIROCKETPlus Pytorch</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.multirocketplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MultiRocketPlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.hydraplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HydraPlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.hydramultirocketplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HydraMultiRocketPlus</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Wavelet-based NNs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.mwdn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">mWDN</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Hybrid models</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rnn_fcn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RNN_FCN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rnn_fcnplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RNN_FCNPlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.transformerrnnplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TransformerRNNPlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.convtranplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ConvTranPlus</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Tabular models</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tabmodel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TabModel</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tabtransformer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TabTransformer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.gatedtabtransformer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GatedTabTransformer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tabfusiontransformer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TabFusionTransformer</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">Miscellaneous</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.multiinputnet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MultiInputNet</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.multimodal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multimodal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.misc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Miscellaneous</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true">
 <span class="menu-text">Training</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./learner.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learner</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tslearner.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TSLearner</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./optimizer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optimizers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./losses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Losses</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./metrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metrics</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false">
 <span class="menu-text">Callbacks</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.core.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Callback</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.predictiondynamics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PredictionDynamics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.noisy_student.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Noisy student</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.mvp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MVP (aka TSBERT)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.experimental.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimental Callbacks</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./calibration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calibration</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="true">
 <span class="menu-text">HPO &amp; experiment tracking</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./optuna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optuna</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wandb.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Weights &amp; Biases Sweeps</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.explainability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explainability</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./utils.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Utilities</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#random_rand" id="toc-random_rand" class="nav-link active" data-scroll-target="#random_rand">random_rand</a></li>
  <li><a href="#random_randint" id="toc-random_randint" class="nav-link" data-scroll-target="#random_randint">random_randint</a></li>
  <li><a href="#random_choice" id="toc-random_choice" class="nav-link" data-scroll-target="#random_choice">random_choice</a></li>
  <li><a href="#is_slice" id="toc-is_slice" class="nav-link" data-scroll-target="#is_slice">is_slice</a></li>
  <li><a href="#is_memmap" id="toc-is_memmap" class="nav-link" data-scroll-target="#is_memmap">is_memmap</a></li>
  <li><a href="#is_dask" id="toc-is_dask" class="nav-link" data-scroll-target="#is_dask">is_dask</a></li>
  <li><a href="#is_zarr" id="toc-is_zarr" class="nav-link" data-scroll-target="#is_zarr">is_zarr</a></li>
  <li><a href="#is_tensor" id="toc-is_tensor" class="nav-link" data-scroll-target="#is_tensor">is_tensor</a></li>
  <li><a href="#is_nparray" id="toc-is_nparray" class="nav-link" data-scroll-target="#is_nparray">is_nparray</a></li>
  <li><a href="#todtype" id="toc-todtype" class="nav-link" data-scroll-target="#todtype">todtype</a></li>
  <li><a href="#to3dplusarray" id="toc-to3dplusarray" class="nav-link" data-scroll-target="#to3dplusarray">to3dPlusArray</a></li>
  <li><a href="#to3dplustensor" id="toc-to3dplustensor" class="nav-link" data-scroll-target="#to3dplustensor">to3dPlusTensor</a></li>
  <li><a href="#to2dplusarray" id="toc-to2dplusarray" class="nav-link" data-scroll-target="#to2dplusarray">to2dPlusArray</a></li>
  <li><a href="#to2dplustensor" id="toc-to2dplustensor" class="nav-link" data-scroll-target="#to2dplustensor">to2dPlusTensor</a></li>
  <li><a href="#to3dplus" id="toc-to3dplus" class="nav-link" data-scroll-target="#to3dplus">to3dPlus</a></li>
  <li><a href="#to2dplus" id="toc-to2dplus" class="nav-link" data-scroll-target="#to2dplus">to2dPlus</a></li>
  <li><a href="#to1d" id="toc-to1d" class="nav-link" data-scroll-target="#to1d">to1d</a></li>
  <li><a href="#to2d" id="toc-to2d" class="nav-link" data-scroll-target="#to2d">to2d</a></li>
  <li><a href="#to3d" id="toc-to3d" class="nav-link" data-scroll-target="#to3d">to3d</a></li>
  <li><a href="#to1darray" id="toc-to1darray" class="nav-link" data-scroll-target="#to1darray">to1darray</a></li>
  <li><a href="#to2darray" id="toc-to2darray" class="nav-link" data-scroll-target="#to2darray">to2darray</a></li>
  <li><a href="#to3darray" id="toc-to3darray" class="nav-link" data-scroll-target="#to3darray">to3darray</a></li>
  <li><a href="#to1dtensor" id="toc-to1dtensor" class="nav-link" data-scroll-target="#to1dtensor">to1dtensor</a></li>
  <li><a href="#to2dtensor" id="toc-to2dtensor" class="nav-link" data-scroll-target="#to2dtensor">to2dtensor</a></li>
  <li><a href="#to3dtensor" id="toc-to3dtensor" class="nav-link" data-scroll-target="#to3dtensor">to3dtensor</a></li>
  <li><a href="#tol" id="toc-tol" class="nav-link" data-scroll-target="#tol">toL</a></li>
  <li><a href="#toarray" id="toc-toarray" class="nav-link" data-scroll-target="#toarray">toarray</a></li>
  <li><a href="#totensor" id="toc-totensor" class="nav-link" data-scroll-target="#totensor">totensor</a></li>
  <li><a href="#get_file_size" id="toc-get_file_size" class="nav-link" data-scroll-target="#get_file_size">get_file_size</a></li>
  <li><a href="#get_dir_size" id="toc-get_dir_size" class="nav-link" data-scroll-target="#get_dir_size">get_dir_size</a></li>
  <li><a href="#get_size" id="toc-get_size" class="nav-link" data-scroll-target="#get_size">get_size</a></li>
  <li><a href="#bytes2str" id="toc-bytes2str" class="nav-link" data-scroll-target="#bytes2str">bytes2str</a></li>
  <li><a href="#is_np_view" id="toc-is_np_view" class="nav-link" data-scroll-target="#is_np_view">is_np_view</a></li>
  <li><a href="#is_dir" id="toc-is_dir" class="nav-link" data-scroll-target="#is_dir">is_dir</a></li>
  <li><a href="#is_file" id="toc-is_file" class="nav-link" data-scroll-target="#is_file">is_file</a></li>
  <li><a href="#delete_all_in_dir" id="toc-delete_all_in_dir" class="nav-link" data-scroll-target="#delete_all_in_dir">delete_all_in_dir</a></li>
  <li><a href="#reverse_dict" id="toc-reverse_dict" class="nav-link" data-scroll-target="#reverse_dict">reverse_dict</a></li>
  <li><a href="#is_tuple" id="toc-is_tuple" class="nav-link" data-scroll-target="#is_tuple">is_tuple</a></li>
  <li><a href="#itemify" id="toc-itemify" class="nav-link" data-scroll-target="#itemify">itemify</a></li>
  <li><a href="#ifelse" id="toc-ifelse" class="nav-link" data-scroll-target="#ifelse">ifelse</a></li>
  <li><a href="#exists" id="toc-exists" class="nav-link" data-scroll-target="#exists">exists</a></li>
  <li><a href="#isnone" id="toc-isnone" class="nav-link" data-scroll-target="#isnone">isnone</a></li>
  <li><a href="#test_eq_nan" id="toc-test_eq_nan" class="nav-link" data-scroll-target="#test_eq_nan">test_eq_nan</a></li>
  <li><a href="#test_error" id="toc-test_error" class="nav-link" data-scroll-target="#test_error">test_error</a></li>
  <li><a href="#test_not_ok" id="toc-test_not_ok" class="nav-link" data-scroll-target="#test_not_ok">test_not_ok</a></li>
  <li><a href="#test_ok" id="toc-test_ok" class="nav-link" data-scroll-target="#test_ok">test_ok</a></li>
  <li><a href="#test_type" id="toc-test_type" class="nav-link" data-scroll-target="#test_type">test_type</a></li>
  <li><a href="#test_not_close" id="toc-test_not_close" class="nav-link" data-scroll-target="#test_not_close">test_not_close</a></li>
  <li><a href="#is_not_close" id="toc-is_not_close" class="nav-link" data-scroll-target="#is_not_close">is_not_close</a></li>
  <li><a href="#assert_fn" id="toc-assert_fn" class="nav-link" data-scroll-target="#assert_fn">assert_fn</a></li>
  <li><a href="#test_le" id="toc-test_le" class="nav-link" data-scroll-target="#test_le">test_le</a></li>
  <li><a href="#test_lt" id="toc-test_lt" class="nav-link" data-scroll-target="#test_lt">test_lt</a></li>
  <li><a href="#test_ge" id="toc-test_ge" class="nav-link" data-scroll-target="#test_ge">test_ge</a></li>
  <li><a href="#test_gt" id="toc-test_gt" class="nav-link" data-scroll-target="#test_gt">test_gt</a></li>
  <li><a href="#stack_pad" id="toc-stack_pad" class="nav-link" data-scroll-target="#stack_pad">stack_pad</a></li>
  <li><a href="#stack" id="toc-stack" class="nav-link" data-scroll-target="#stack">stack</a></li>
  <li><a href="#pad_sequences" id="toc-pad_sequences" class="nav-link" data-scroll-target="#pad_sequences">pad_sequences</a></li>
  <li><a href="#match_seq_len" id="toc-match_seq_len" class="nav-link" data-scroll-target="#match_seq_len">match_seq_len</a></li>
  <li><a href="#random_shuffle" id="toc-random_shuffle" class="nav-link" data-scroll-target="#random_shuffle">random_shuffle</a></li>
  <li><a href="#cat2int" id="toc-cat2int" class="nav-link" data-scroll-target="#cat2int">cat2int</a></li>
  <li><a href="#cycle_dl_estimate" id="toc-cycle_dl_estimate" class="nav-link" data-scroll-target="#cycle_dl_estimate">cycle_dl_estimate</a></li>
  <li><a href="#cycle_dl_to_device" id="toc-cycle_dl_to_device" class="nav-link" data-scroll-target="#cycle_dl_to_device">cycle_dl_to_device</a></li>
  <li><a href="#cycle_dl" id="toc-cycle_dl" class="nav-link" data-scroll-target="#cycle_dl">cycle_dl</a></li>
  <li><a href="#cache_data" id="toc-cache_data" class="nav-link" data-scroll-target="#cache_data">cache_data</a></li>
  <li><a href="#get_func_defaults" id="toc-get_func_defaults" class="nav-link" data-scroll-target="#get_func_defaults">get_func_defaults</a></li>
  <li><a href="#get_idx_from_df_col_vals" id="toc-get_idx_from_df_col_vals" class="nav-link" data-scroll-target="#get_idx_from_df_col_vals">get_idx_from_df_col_vals</a></li>
  <li><a href="#get_sublist_idxs" id="toc-get_sublist_idxs" class="nav-link" data-scroll-target="#get_sublist_idxs">get_sublist_idxs</a></li>
  <li><a href="#flatten_list" id="toc-flatten_list" class="nav-link" data-scroll-target="#flatten_list">flatten_list</a></li>
  <li><a href="#display_pd_df" id="toc-display_pd_df" class="nav-link" data-scroll-target="#display_pd_df">display_pd_df</a></li>
  <li><a href="#tscore" id="toc-tscore" class="nav-link" data-scroll-target="#tscore">tscore</a></li>
  <li><a href="#kstest" id="toc-kstest" class="nav-link" data-scroll-target="#kstest">kstest</a></li>
  <li><a href="#ttest" id="toc-ttest" class="nav-link" data-scroll-target="#ttest">ttest</a></li>
  <li><a href="#scc" id="toc-scc" class="nav-link" data-scroll-target="#scc">scc</a></li>
  <li><a href="#pcc" id="toc-pcc" class="nav-link" data-scroll-target="#pcc">pcc</a></li>
  <li><a href="#remove_fn" id="toc-remove_fn" class="nav-link" data-scroll-target="#remove_fn">remove_fn</a></li>
  <li><a href="#npsave" id="toc-npsave" class="nav-link" data-scroll-target="#npsave">npsave</a></li>
  <li><a href="#permute_2d" id="toc-permute_2d" class="nav-link" data-scroll-target="#permute_2d">permute_2D</a></li>
  <li><a href="#random_half_normal_tensor" id="toc-random_half_normal_tensor" class="nav-link" data-scroll-target="#random_half_normal_tensor">random_half_normal_tensor</a></li>
  <li><a href="#random_normal_tensor" id="toc-random_normal_tensor" class="nav-link" data-scroll-target="#random_normal_tensor">random_normal_tensor</a></li>
  <li><a href="#random_half_normal" id="toc-random_half_normal" class="nav-link" data-scroll-target="#random_half_normal">random_half_normal</a></li>
  <li><a href="#random_normal" id="toc-random_normal" class="nav-link" data-scroll-target="#random_normal">random_normal</a></li>
  <li><a href="#fig2buf" id="toc-fig2buf" class="nav-link" data-scroll-target="#fig2buf">fig2buf</a></li>
  <li><a href="#get_plot_fig" id="toc-get_plot_fig" class="nav-link" data-scroll-target="#get_plot_fig">get_plot_fig</a></li>
  <li><a href="#default_dpi" id="toc-default_dpi" class="nav-link" data-scroll-target="#default_dpi">default_dpi</a></li>
  <li><a href="#plot_scatter" id="toc-plot_scatter" class="nav-link" data-scroll-target="#plot_scatter">plot_scatter</a></li>
  <li><a href="#get_idxs" id="toc-get_idxs" class="nav-link" data-scroll-target="#get_idxs">get_idxs</a></li>
  <li><a href="#apply_cmap" id="toc-apply_cmap" class="nav-link" data-scroll-target="#apply_cmap">apply_cmap</a></li>
  <li><a href="#torch_tile" id="toc-torch_tile" class="nav-link" data-scroll-target="#torch_tile">torch_tile</a></li>
  <li><a href="#to_tsfresh_df" id="toc-to_tsfresh_df" class="nav-link" data-scroll-target="#to_tsfresh_df">to_tsfresh_df</a></li>
  <li><a href="#scorr" id="toc-scorr" class="nav-link" data-scroll-target="#scorr">scorr</a></li>
  <li><a href="#pcorr" id="toc-pcorr" class="nav-link" data-scroll-target="#pcorr">pcorr</a></li>
  <li><a href="#torch_diff" id="toc-torch_diff" class="nav-link" data-scroll-target="#torch_diff">torch_diff</a></li>
  <li><a href="#torch_clamp" id="toc-torch_clamp" class="nav-link" data-scroll-target="#torch_clamp">torch_clamp</a></li>
  <li><a href="#get_percentile" id="toc-get_percentile" class="nav-link" data-scroll-target="#get_percentile">get_percentile</a></li>
  <li><a href="#clip_outliers" id="toc-clip_outliers" class="nav-link" data-scroll-target="#clip_outliers">clip_outliers</a></li>
  <li><a href="#get_outliers_iqr" id="toc-get_outliers_iqr" class="nav-link" data-scroll-target="#get_outliers_iqr">get_outliers_IQR</a></li>
  <li><a href="#get_robustscale_params" id="toc-get_robustscale_params" class="nav-link" data-scroll-target="#get_robustscale_params">get_robustscale_params</a></li>
  <li><a href="#torch_slice_by_dim" id="toc-torch_slice_by_dim" class="nav-link" data-scroll-target="#torch_slice_by_dim">torch_slice_by_dim</a></li>
  <li><a href="#torch_nanstd" id="toc-torch_nanstd" class="nav-link" data-scroll-target="#torch_nanstd">torch_nanstd</a></li>
  <li><a href="#torch_nanmean" id="toc-torch_nanmean" class="nav-link" data-scroll-target="#torch_nanmean">torch_nanmean</a></li>
  <li><a href="#concat" id="toc-concat" class="nav-link" data-scroll-target="#concat">concat</a></li>
  <li><a href="#reduce_memory_usage" id="toc-reduce_memory_usage" class="nav-link" data-scroll-target="#reduce_memory_usage">reduce_memory_usage</a></li>
  <li><a href="#cls_name" id="toc-cls_name" class="nav-link" data-scroll-target="#cls_name">cls_name</a></li>
  <li><a href="#rotate_axis2" id="toc-rotate_axis2" class="nav-link" data-scroll-target="#rotate_axis2">rotate_axis2</a></li>
  <li><a href="#rotate_axis1" id="toc-rotate_axis1" class="nav-link" data-scroll-target="#rotate_axis1">rotate_axis1</a></li>
  <li><a href="#rotate_axis0" id="toc-rotate_axis0" class="nav-link" data-scroll-target="#rotate_axis0">rotate_axis0</a></li>
  <li><a href="#random_roll3d" id="toc-random_roll3d" class="nav-link" data-scroll-target="#random_roll3d">random_roll3d</a></li>
  <li><a href="#random_roll2d" id="toc-random_roll2d" class="nav-link" data-scroll-target="#random_roll2d">random_roll2d</a></li>
  <li><a href="#roll3d" id="toc-roll3d" class="nav-link" data-scroll-target="#roll3d">roll3d</a></li>
  <li><a href="#roll2d" id="toc-roll2d" class="nav-link" data-scroll-target="#roll2d">roll2d</a></li>
  <li><a href="#chunks_calculator" id="toc-chunks_calculator" class="nav-link" data-scroll-target="#chunks_calculator">chunks_calculator</a></li>
  <li><a href="#is_memory_shared" id="toc-is_memory_shared" class="nav-link" data-scroll-target="#is_memory_shared">is_memory_shared</a></li>
  <li><a href="#assign_in_chunks" id="toc-assign_in_chunks" class="nav-link" data-scroll-target="#assign_in_chunks">assign_in_chunks</a></li>
  <li><a href="#create_array" id="toc-create_array" class="nav-link" data-scroll-target="#create_array">create_array</a></li>
  <li><a href="#np_load_compressed" id="toc-np_load_compressed" class="nav-link" data-scroll-target="#np_load_compressed">np_load_compressed</a></li>
  <li><a href="#np_save_compressed" id="toc-np_save_compressed" class="nav-link" data-scroll-target="#np_save_compressed">np_save_compressed</a></li>
  <li><a href="#np2memmap" id="toc-np2memmap" class="nav-link" data-scroll-target="#np2memmap">np2memmap</a></li>
  <li><a href="#torch_mean_groupby" id="toc-torch_mean_groupby" class="nav-link" data-scroll-target="#torch_mean_groupby">torch_mean_groupby</a></li>
  <li><a href="#torch_flip" id="toc-torch_flip" class="nav-link" data-scroll-target="#torch_flip">torch_flip</a></li>
  <li><a href="#torch_masked_to_num" id="toc-torch_masked_to_num" class="nav-link" data-scroll-target="#torch_masked_to_num">torch_masked_to_num</a></li>
  <li><a href="#torch_nan_to_num" id="toc-torch_nan_to_num" class="nav-link" data-scroll-target="#torch_nan_to_num">torch_nan_to_num</a></li>
  <li><a href="#mpl_trend" id="toc-mpl_trend" class="nav-link" data-scroll-target="#mpl_trend">mpl_trend</a></li>
  <li><a href="#array2digits" id="toc-array2digits" class="nav-link" data-scroll-target="#array2digits">array2digits</a></li>
  <li><a href="#int2digits" id="toc-int2digits" class="nav-link" data-scroll-target="#int2digits">int2digits</a></li>
  <li><a href="#sincos_encoding" id="toc-sincos_encoding" class="nav-link" data-scroll-target="#sincos_encoding">sincos_encoding</a></li>
  <li><a href="#linear_encoding" id="toc-linear_encoding" class="nav-link" data-scroll-target="#linear_encoding">linear_encoding</a></li>
  <li><a href="#encode_positions" id="toc-encode_positions" class="nav-link" data-scroll-target="#encode_positions">encode_positions</a></li>
  <li><a href="#sort_generator" id="toc-sort_generator" class="nav-link" data-scroll-target="#sort_generator">sort_generator</a></li>
  <li><a href="#get_subset_dict" id="toc-get_subset_dict" class="nav-link" data-scroll-target="#get_subset_dict">get_subset_dict</a></li>
  <li><a href="#remove_dir" id="toc-remove_dir" class="nav-link" data-scroll-target="#remove_dir">remove_dir</a></li>
  <li><a href="#create_dir" id="toc-create_dir" class="nav-link" data-scroll-target="#create_dir">create_dir</a></li>
  <li><a href="#named_partial" id="toc-named_partial" class="nav-link" data-scroll-target="#named_partial">named_partial</a></li>
  <li><a href="#dict2attrdict" id="toc-dict2attrdict" class="nav-link" data-scroll-target="#dict2attrdict">dict2attrdict</a></li>
  <li><a href="#attrdict2dict" id="toc-attrdict2dict" class="nav-link" data-scroll-target="#attrdict2dict">attrdict2dict</a></li>
  <li><a href="#get_config" id="toc-get_config" class="nav-link" data-scroll-target="#get_config">get_config</a></li>
  <li><a href="#yaml2dict" id="toc-yaml2dict" class="nav-link" data-scroll-target="#yaml2dict">yaml2dict</a></li>
  <li><a href="#dict2yaml" id="toc-dict2yaml" class="nav-link" data-scroll-target="#dict2yaml">dict2yaml</a></li>
  <li><a href="#get_cat_cols" id="toc-get_cat_cols" class="nav-link" data-scroll-target="#get_cat_cols">get_cat_cols</a></li>
  <li><a href="#get_cont_cols" id="toc-get_cont_cols" class="nav-link" data-scroll-target="#get_cont_cols">get_cont_cols</a></li>
  <li><a href="#str2index" id="toc-str2index" class="nav-link" data-scroll-target="#str2index">str2index</a></li>
  <li><a href="#str2list" id="toc-str2list" class="nav-link" data-scroll-target="#str2list">str2list</a></li>
  <li><a href="#map_array" id="toc-map_array" class="nav-link" data-scroll-target="#map_array">map_array</a></li>
  <li><a href="#get_mapping" id="toc-get_mapping" class="nav-link" data-scroll-target="#get_mapping">get_mapping</a></li>
  <li><a href="#log_tfm" id="toc-log_tfm" class="nav-link" data-scroll-target="#log_tfm">log_tfm</a></li>
  <li><a href="#to_sincos_time" id="toc-to_sincos_time" class="nav-link" data-scroll-target="#to_sincos_time">to_sincos_time</a></li>
  <li><a href="#plot_feature_dist" id="toc-plot_feature_dist" class="nav-link" data-scroll-target="#plot_feature_dist">plot_feature_dist</a></li>
  <li><a href="#rolling_moving_average" id="toc-rolling_moving_average" class="nav-link" data-scroll-target="#rolling_moving_average">rolling_moving_average</a></li>
  <li><a href="#fbfill_sequence" id="toc-fbfill_sequence" class="nav-link" data-scroll-target="#fbfill_sequence">fbfill_sequence</a></li>
  <li><a href="#bfill_sequence" id="toc-bfill_sequence" class="nav-link" data-scroll-target="#bfill_sequence">bfill_sequence</a></li>
  <li><a href="#ffill_sequence" id="toc-ffill_sequence" class="nav-link" data-scroll-target="#ffill_sequence">ffill_sequence</a></li>
  <li><a href="#dummify" id="toc-dummify" class="nav-link" data-scroll-target="#dummify">dummify</a></li>
  <li><a href="#shuffle_along_axis" id="toc-shuffle_along_axis" class="nav-link" data-scroll-target="#shuffle_along_axis">shuffle_along_axis</a></li>
  <li><a href="#analyze_array" id="toc-analyze_array" class="nav-link" data-scroll-target="#analyze_array">analyze_array</a></li>
  <li><a href="#analyze_feature" id="toc-analyze_feature" class="nav-link" data-scroll-target="#analyze_feature">analyze_feature</a></li>
  <li><a href="#get_relpath" id="toc-get_relpath" class="nav-link" data-scroll-target="#get_relpath">get_relpath</a></li>
  <li><a href="#to_root_path" id="toc-to_root_path" class="nav-link" data-scroll-target="#to_root_path">to_root_path</a></li>
  <li><a href="#get_root" id="toc-get_root" class="nav-link" data-scroll-target="#get_root">get_root</a></li>
  <li><a href="#split_in_chunks" id="toc-split_in_chunks" class="nav-link" data-scroll-target="#split_in_chunks">split_in_chunks</a></li>
  <li><a href="#load_object" id="toc-load_object" class="nav-link" data-scroll-target="#load_object">load_object</a></li>
  <li><a href="#save_object" id="toc-save_object" class="nav-link" data-scroll-target="#save_object">save_object</a></li>
  <li><a href="#get_idxs_to_keep" id="toc-get_idxs_to_keep" class="nav-link" data-scroll-target="#get_idxs_to_keep">get_idxs_to_keep</a></li>
  <li><a href="#zerofy" id="toc-zerofy" class="nav-link" data-scroll-target="#zerofy">zerofy</a></li>
  <li><a href="#feat2list" id="toc-feat2list" class="nav-link" data-scroll-target="#feat2list">feat2list</a></li>
  <li><a href="#smallest_dtype" id="toc-smallest_dtype" class="nav-link" data-scroll-target="#smallest_dtype">smallest_dtype</a></li>
  <li><a href="#plot_forecast" id="toc-plot_forecast" class="nav-link" data-scroll-target="#plot_forecast">plot_forecast</a></li>
  <li><a href="#str2callable" id="toc-str2callable" class="nav-link" data-scroll-target="#str2callable">str2callable</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/timeseriesAI/tsai/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Utilities</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<blockquote class="blockquote">
<p>General helper functions used throughout the library</p>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L74" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="random_rand" class="level3">
<h3 class="anchored" data-anchor-id="random_rand">random_rand</h3>
<blockquote class="blockquote">
<pre><code> random_rand (*d, dtype=None, out=None, seed=None)</code></pre>
</blockquote>
<p><em>Same as np.random.rand but with a faster random generator, dtype and seed</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>d</td>
<td>VAR_POSITIONAL</td>
<td></td>
<td>int or tuple of ints, optional. The dimensions of the returned array, must be non-negative.</td>
</tr>
<tr class="even">
<td>dtype</td>
<td>NoneType</td>
<td>None</td>
<td>data type of the output.</td>
</tr>
<tr class="odd">
<td>out</td>
<td>NoneType</td>
<td>None</td>
<td>ndarray, optional. Alternative output array in which to place the result.</td>
</tr>
<tr class="even">
<td>seed</td>
<td>NoneType</td>
<td>None</td>
<td>int or None, optional. Seed for the random number generator.</td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L61" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="random_randint" class="level3">
<h3 class="anchored" data-anchor-id="random_randint">random_randint</h3>
<blockquote class="blockquote">
<pre><code> random_randint (low, high=None, size=None, dtype=&lt;class 'int'&gt;,
                 endpoint=False, seed=None)</code></pre>
</blockquote>
<p><em>Same as np.random.randint but with a faster random generator and seed</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>low</td>
<td></td>
<td></td>
<td>int, lower endpoint of interval (inclusive)</td>
</tr>
<tr class="even">
<td>high</td>
<td>NoneType</td>
<td>None</td>
<td>int, upper endpoint of interval (exclusive), or None for a single-argument form of low.</td>
</tr>
<tr class="odd">
<td>size</td>
<td>NoneType</td>
<td>None</td>
<td>int or tuple of ints, optional. Output shape.</td>
</tr>
<tr class="even">
<td>dtype</td>
<td>type</td>
<td>int</td>
<td>data type of the output.</td>
</tr>
<tr class="odd">
<td>endpoint</td>
<td>bool</td>
<td>False</td>
<td>bool, optional. If True, <code>high</code> is an inclusive endpoint. If False, the range is open on the right.</td>
</tr>
<tr class="even">
<td>seed</td>
<td>NoneType</td>
<td>None</td>
<td>int or None, optional. Seed for the random number generator.</td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L43" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="random_choice" class="level3">
<h3 class="anchored" data-anchor-id="random_choice">random_choice</h3>
<blockquote class="blockquote">
<pre><code> random_choice (a, size=None, replace=True, p=None, axis=0, shuffle=True,
                dtype=None, seed=None)</code></pre>
</blockquote>
<p><em>Same as np.random.choice but with a faster random generator, dtype and seed</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a</td>
<td></td>
<td></td>
<td>1-D array-like or int. The values from which to draw the samples.</td>
</tr>
<tr class="even">
<td>size</td>
<td>NoneType</td>
<td>None</td>
<td>int or tuple of ints, optional. The shape of the output.</td>
</tr>
<tr class="odd">
<td>replace</td>
<td>bool</td>
<td>True</td>
<td>bool, optional. Whether or not to allow the same value to be drawn multiple times.</td>
</tr>
<tr class="even">
<td>p</td>
<td>NoneType</td>
<td>None</td>
<td>1-D array-like, optional. The probabilities associated with each entry in a.</td>
</tr>
<tr class="odd">
<td>axis</td>
<td>int</td>
<td>0</td>
<td>int, optional. The axis along which the samples are drawn.</td>
</tr>
<tr class="even">
<td>shuffle</td>
<td>bool</td>
<td>True</td>
<td>bool, optional. Whether or not to shuffle the samples before returning them.</td>
</tr>
<tr class="odd">
<td>dtype</td>
<td>NoneType</td>
<td>None</td>
<td>data type of the output.</td>
</tr>
<tr class="even">
<td>seed</td>
<td>NoneType</td>
<td>None</td>
<td>int or None, optional. Seed for the random number generator.</td>
</tr>
</tbody>
</table>
<div id="cell-6" class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> random_choice(<span class="dv">10</span>, size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), replace<span class="op">=</span><span class="va">True</span>, p<span class="op">=</span><span class="va">None</span>, seed<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> random_choice(<span class="dv">10</span>, size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), replace<span class="op">=</span><span class="va">True</span>, p<span class="op">=</span><span class="va">None</span>, seed<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>test_eq(a, b)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> random_choice(<span class="dv">10</span>, size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), replace<span class="op">=</span><span class="va">True</span>, p<span class="op">=</span><span class="va">None</span>, seed<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>test_ne(a, c)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> random_choice(<span class="dv">10</span>, size<span class="op">=</span><span class="dv">3</span>, replace<span class="op">=</span><span class="va">True</span>, p<span class="op">=</span><span class="va">None</span>).shape <span class="op">==</span> (<span class="dv">3</span>,)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> random_choice(<span class="dv">10</span>, size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), replace<span class="op">=</span><span class="va">True</span>, p<span class="op">=</span><span class="va">None</span>).shape <span class="op">==</span> (<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(random_choice(<span class="dv">10</span>, size<span class="op">=</span><span class="dv">3</span>, replace<span class="op">=</span><span class="va">True</span>, p<span class="op">=</span><span class="va">None</span>))</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(random_choice(<span class="dv">10</span>, size<span class="op">=</span><span class="dv">3</span>, replace<span class="op">=</span><span class="va">False</span>, p<span class="op">=</span><span class="va">None</span>))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">13</span>, <span class="dv">25</span>, <span class="dv">56</span>, <span class="dv">83</span>, <span class="dv">99</span>, <span class="dv">100</span>]</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(random_choice(a, size<span class="op">=</span><span class="dv">3</span>, replace<span class="op">=</span><span class="va">False</span>, p<span class="op">=</span><span class="va">None</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[5 7 5]
[0 1 6]
[  4  83 100]</code></pre>
</div>
</div>
<div id="cell-7" class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> random_randint(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">100</span>, seed<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> random_randint(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">100</span>, seed<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>test_eq(a, b)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> random_randint(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">100</span>, seed<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>test_ne(a, c)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> (a <span class="op">&gt;=</span> <span class="dv">10</span>).<span class="bu">all</span>() <span class="kw">and</span> (a <span class="op">&lt;</span> <span class="dv">20</span>).<span class="bu">all</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-8" class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> random_rand(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, seed<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> random_rand(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, seed<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>test_eq(a, b)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> random_rand(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, seed<span class="op">=</span><span class="dv">124</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>test_ne(a, c)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> (a <span class="op">&gt;=</span> <span class="dv">0</span>).<span class="bu">all</span>() <span class="kw">and</span> (a <span class="op">&lt;</span> <span class="dv">1</span>).<span class="bu">all</span>()</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> random_rand(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>a_copy <span class="op">=</span> a.copy()</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>random_rand(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, out<span class="op">=</span>a)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>test_ne(a, a_copy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L93" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_slice" class="level3">
<h3 class="anchored" data-anchor-id="is_slice">is_slice</h3>
<blockquote class="blockquote">
<pre><code> is_slice (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L92" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_memmap" class="level3">
<h3 class="anchored" data-anchor-id="is_memmap">is_memmap</h3>
<blockquote class="blockquote">
<pre><code> is_memmap (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L91" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_dask" class="level3">
<h3 class="anchored" data-anchor-id="is_dask">is_dask</h3>
<blockquote class="blockquote">
<pre><code> is_dask (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L90" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_zarr" class="level3">
<h3 class="anchored" data-anchor-id="is_zarr">is_zarr</h3>
<blockquote class="blockquote">
<pre><code> is_zarr (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L89" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_tensor" class="level3">
<h3 class="anchored" data-anchor-id="is_tensor">is_tensor</h3>
<blockquote class="blockquote">
<pre><code> is_tensor (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L88" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_nparray" class="level3">
<h3 class="anchored" data-anchor-id="is_nparray">is_nparray</h3>
<blockquote class="blockquote">
<pre><code> is_nparray (o)</code></pre>
</blockquote>
<div id="cell-15" class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ensure these folders exist for testing purposes</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fns <span class="op">=</span> [<span class="st">'data'</span>, <span class="st">'export'</span>, <span class="st">'models'</span>]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> fn <span class="kw">in</span> fns:</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> Path(<span class="st">'.'</span>)<span class="op">/</span>fn</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> os.path.exists(path): os.makedirs(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L216" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="todtype" class="level3">
<h3 class="anchored" data-anchor-id="todtype">todtype</h3>
<blockquote class="blockquote">
<pre><code> todtype (dtype)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L212" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to3dplusarray" class="level3">
<h3 class="anchored" data-anchor-id="to3dplusarray">to3dPlusArray</h3>
<blockquote class="blockquote">
<pre><code> to3dPlusArray (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L208" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to3dplustensor" class="level3">
<h3 class="anchored" data-anchor-id="to3dplustensor">to3dPlusTensor</h3>
<blockquote class="blockquote">
<pre><code> to3dPlusTensor (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L204" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to2dplusarray" class="level3">
<h3 class="anchored" data-anchor-id="to2dplusarray">to2dPlusArray</h3>
<blockquote class="blockquote">
<pre><code> to2dPlusArray (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L200" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to2dplustensor" class="level3">
<h3 class="anchored" data-anchor-id="to2dplustensor">to2dPlusTensor</h3>
<blockquote class="blockquote">
<pre><code> to2dPlusTensor (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L194" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to3dplus" class="level3">
<h3 class="anchored" data-anchor-id="to3dplus">to3dPlus</h3>
<blockquote class="blockquote">
<pre><code> to3dPlus (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L188" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to2dplus" class="level3">
<h3 class="anchored" data-anchor-id="to2dplus">to2dPlus</h3>
<blockquote class="blockquote">
<pre><code> to2dPlus (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L182" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to1d" class="level3">
<h3 class="anchored" data-anchor-id="to1d">to1d</h3>
<blockquote class="blockquote">
<pre><code> to1d (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L176" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to2d" class="level3">
<h3 class="anchored" data-anchor-id="to2d">to2d</h3>
<blockquote class="blockquote">
<pre><code> to2d (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L170" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to3d" class="level3">
<h3 class="anchored" data-anchor-id="to3d">to3d</h3>
<blockquote class="blockquote">
<pre><code> to3d (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L162" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to1darray" class="level3">
<h3 class="anchored" data-anchor-id="to1darray">to1darray</h3>
<blockquote class="blockquote">
<pre><code> to1darray (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L154" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to2darray" class="level3">
<h3 class="anchored" data-anchor-id="to2darray">to2darray</h3>
<blockquote class="blockquote">
<pre><code> to2darray (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L146" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to3darray" class="level3">
<h3 class="anchored" data-anchor-id="to3darray">to3darray</h3>
<blockquote class="blockquote">
<pre><code> to3darray (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L138" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to1dtensor" class="level3">
<h3 class="anchored" data-anchor-id="to1dtensor">to1dtensor</h3>
<blockquote class="blockquote">
<pre><code> to1dtensor (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L130" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to2dtensor" class="level3">
<h3 class="anchored" data-anchor-id="to2dtensor">to2dtensor</h3>
<blockquote class="blockquote">
<pre><code> to2dtensor (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L122" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to3dtensor" class="level3">
<h3 class="anchored" data-anchor-id="to3dtensor">to3dtensor</h3>
<blockquote class="blockquote">
<pre><code> to3dtensor (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L114" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="tol" class="level3">
<h3 class="anchored" data-anchor-id="tol">toL</h3>
<blockquote class="blockquote">
<pre><code> toL (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L105" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="toarray" class="level3">
<h3 class="anchored" data-anchor-id="toarray">toarray</h3>
<blockquote class="blockquote">
<pre><code> toarray (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L96" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="totensor" class="level3">
<h3 class="anchored" data-anchor-id="totensor">totensor</h3>
<blockquote class="blockquote">
<pre><code> totensor (o)</code></pre>
</blockquote>
<div id="cell-35" class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">100</span>).astype(np.float32)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> torch.from_numpy(a).<span class="bu">float</span>()</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>test_eq(totensor(a), b)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>test_eq(a, toarray(b))</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>test_eq(to3dtensor(a).ndim, <span class="dv">3</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>test_eq(to2dtensor(a).ndim, <span class="dv">2</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>test_eq(to1dtensor(a).ndim, <span class="dv">1</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>test_eq(to3darray(b).ndim, <span class="dv">3</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>test_eq(to2darray(b).ndim, <span class="dv">2</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>test_eq(to1darray(b).ndim, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-36" class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.random.rand(<span class="dv">10</span>, <span class="dv">20</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'target'</span>] <span class="op">=</span> np.random.randint(<span class="dv">0</span>, <span class="dv">3</span>, <span class="bu">len</span>(df))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df[df.columns[:<span class="op">-</span><span class="dv">1</span>]]</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'target'</span>]</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>test_eq(to3darray(X).shape, (<span class="dv">10</span>, <span class="dv">1</span>, <span class="dv">20</span>))</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>test_eq(toarray(y).shape, (<span class="dv">10</span>,))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L284" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_file_size" class="level3">
<h3 class="anchored" data-anchor-id="get_file_size">get_file_size</h3>
<blockquote class="blockquote">
<pre><code> get_file_size (file_path:str, return_str:bool=True, decimals:int=2)</code></pre>
</blockquote>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>file_path</td>
<td>str</td>
<td></td>
<td>path to file</td>
</tr>
<tr class="even">
<td>return_str</td>
<td>bool</td>
<td>True</td>
<td>True returns size in human-readable format (KB, MB, GB, …). False in bytes.</td>
</tr>
<tr class="odd">
<td>decimals</td>
<td>int</td>
<td>2</td>
<td>Number of decimals in the output</td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L264" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_dir_size" class="level3">
<h3 class="anchored" data-anchor-id="get_dir_size">get_dir_size</h3>
<blockquote class="blockquote">
<pre><code> get_dir_size (dir_path:str, return_str:bool=True, decimals:int=2,
               verbose:bool=False)</code></pre>
</blockquote>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>dir_path</td>
<td>str</td>
<td></td>
<td>path to directory</td>
</tr>
<tr class="even">
<td>return_str</td>
<td>bool</td>
<td>True</td>
<td>True returns size in human-readable format (KB, MB, GB, …). False in bytes.</td>
</tr>
<tr class="odd">
<td>decimals</td>
<td>int</td>
<td>2</td>
<td>Number of decimals in the output</td>
</tr>
<tr class="even">
<td>verbose</td>
<td>bool</td>
<td>False</td>
<td>Controls verbosity</td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L240" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_size" class="level3">
<h3 class="anchored" data-anchor-id="get_size">get_size</h3>
<blockquote class="blockquote">
<pre><code> get_size (o, return_str=False, decimals=2)</code></pre>
</blockquote>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>o</td>
<td></td>
<td></td>
<td>Any python object</td>
</tr>
<tr class="even">
<td>return_str</td>
<td>bool</td>
<td>False</td>
<td>True returns size in human-readable format (KB, MB, GB, …). False in bytes.</td>
</tr>
<tr class="odd">
<td>decimals</td>
<td>int</td>
<td>2</td>
<td>Number of decimals in the output</td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L225" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="bytes2str" class="level3">
<h3 class="anchored" data-anchor-id="bytes2str">bytes2str</h3>
<blockquote class="blockquote">
<pre><code> bytes2str (size_bytes:int, decimals=2)</code></pre>
</blockquote>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>size_bytes</td>
<td>int</td>
<td></td>
<td>Number of bytes</td>
</tr>
<tr class="even">
<td>decimals</td>
<td>int</td>
<td>2</td>
<td>Number of decimals in the output</td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>str</strong></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div id="cell-41" class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">3</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>test_eq(get_size(a, <span class="va">True</span>, <span class="dv">1</span>), <span class="st">'1.2 KB'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L296" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_np_view" class="level3">
<h3 class="anchored" data-anchor-id="is_np_view">is_np_view</h3>
<blockquote class="blockquote">
<pre><code> is_np_view (o)</code></pre>
</blockquote>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>o</td>
<td>a numpy array</td>
</tr>
</tbody>
</table>
<div id="cell-43" class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="fl">1.</span>, <span class="fl">2.</span>, <span class="fl">3.</span>])</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>test_eq(is_np_view(a), <span class="va">False</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>test_eq(is_np_view(a[<span class="dv">1</span>:]), <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L305" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_dir" class="level3">
<h3 class="anchored" data-anchor-id="is_dir">is_dir</h3>
<blockquote class="blockquote">
<pre><code> is_dir (path)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L302" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_file" class="level3">
<h3 class="anchored" data-anchor-id="is_file">is_file</h3>
<blockquote class="blockquote">
<pre><code> is_file (path)</code></pre>
</blockquote>
<div id="cell-46" class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>test_eq(is_file(<span class="st">"002_utils.ipynb"</span>), <span class="va">True</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>test_eq(is_file(<span class="st">"utils.ipynb"</span>), <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L309" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="delete_all_in_dir" class="level3">
<h3 class="anchored" data-anchor-id="delete_all_in_dir">delete_all_in_dir</h3>
<blockquote class="blockquote">
<pre><code> delete_all_in_dir (tgt_dir, exception=None)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L319" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="reverse_dict" class="level3">
<h3 class="anchored" data-anchor-id="reverse_dict">reverse_dict</h3>
<blockquote class="blockquote">
<pre><code> reverse_dict (dictionary)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L323" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_tuple" class="level3">
<h3 class="anchored" data-anchor-id="is_tuple">is_tuple</h3>
<blockquote class="blockquote">
<pre><code> is_tuple (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L326" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="itemify" class="level3">
<h3 class="anchored" data-anchor-id="itemify">itemify</h3>
<blockquote class="blockquote">
<pre><code> itemify (*o, tup_id=None)</code></pre>
</blockquote>
<div id="cell-51" class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(itemify(a, b))</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">len</span>(itemify(a, b)), <span class="bu">len</span>(a))</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="va">None</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(itemify(a, b))</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">len</span>(itemify(a, b)), <span class="bu">len</span>(a))</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="va">None</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(itemify(a, b, c))</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">len</span>(itemify(a, b, c)), <span class="bu">len</span>(a))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[(1, 4), (2, 5), (3, 6)]
[(1,), (2,), (3,)]
[(1, 4), (2, 5), (3, 6)]</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L338" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="ifelse" class="level3">
<h3 class="anchored" data-anchor-id="ifelse">ifelse</h3>
<blockquote class="blockquote">
<pre><code> ifelse (a, b, c)</code></pre>
</blockquote>
<p><em><code>b</code> if <code>a</code> is True else <code>c</code></em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L336" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="exists" class="level3">
<h3 class="anchored" data-anchor-id="exists">exists</h3>
<blockquote class="blockquote">
<pre><code> exists (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L333" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="isnone" class="level3">
<h3 class="anchored" data-anchor-id="isnone">isnone</h3>
<blockquote class="blockquote">
<pre><code> isnone (o)</code></pre>
</blockquote>
<div id="cell-55" class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array(<span class="dv">3</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>test_eq(isnone(a), <span class="va">False</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>test_eq(exists(a), <span class="va">True</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="va">None</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>test_eq(isnone(b), <span class="va">True</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>test_eq(exists(b), <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L384" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="test_eq_nan" class="level3">
<h3 class="anchored" data-anchor-id="test_eq_nan">test_eq_nan</h3>
<blockquote class="blockquote">
<pre><code> test_eq_nan (a, b)</code></pre>
</blockquote>
<p><em><code>test</code> that <code>a==b</code> excluding nan values (valid for torch.Tensor and np.ndarray)</em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L379" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="test_error" class="level3">
<h3 class="anchored" data-anchor-id="test_error">test_error</h3>
<blockquote class="blockquote">
<pre><code> test_error (error, f, *args, **kwargs)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L370" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="test_not_ok" class="level3">
<h3 class="anchored" data-anchor-id="test_not_ok">test_not_ok</h3>
<blockquote class="blockquote">
<pre><code> test_not_ok (f, *args, **kwargs)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L361" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="test_ok" class="level3">
<h3 class="anchored" data-anchor-id="test_ok">test_ok</h3>
<blockquote class="blockquote">
<pre><code> test_ok (f, *args, **kwargs)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L357" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="test_type" class="level3">
<h3 class="anchored" data-anchor-id="test_type">test_type</h3>
<blockquote class="blockquote">
<pre><code> test_type (a, b)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L352" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="test_not_close" class="level3">
<h3 class="anchored" data-anchor-id="test_not_close">test_not_close</h3>
<blockquote class="blockquote">
<pre><code> test_not_close (a, b, eps=1e-05)</code></pre>
</blockquote>
<p><em><code>test</code> that <code>a</code> is within <code>eps</code> of <code>b</code></em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L343" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_not_close" class="level3">
<h3 class="anchored" data-anchor-id="is_not_close">is_not_close</h3>
<blockquote class="blockquote">
<pre><code> is_not_close (a, b, eps=1e-05)</code></pre>
</blockquote>
<p><em>Is <code>a</code> within <code>eps</code> of <code>b</code></em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L391" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="assert_fn" class="level3">
<h3 class="anchored" data-anchor-id="assert_fn">assert_fn</h3>
<blockquote class="blockquote">
<pre><code> assert_fn (*args, **kwargs)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L407" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="test_le" class="level3">
<h3 class="anchored" data-anchor-id="test_le">test_le</h3>
<blockquote class="blockquote">
<pre><code> test_le (a, b)</code></pre>
</blockquote>
<p><em><code>test</code> that <code>a&gt;b</code></em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L403" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="test_lt" class="level3">
<h3 class="anchored" data-anchor-id="test_lt">test_lt</h3>
<blockquote class="blockquote">
<pre><code> test_lt (a, b)</code></pre>
</blockquote>
<p><em><code>test</code> that <code>a&gt;b</code></em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L399" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="test_ge" class="level3">
<h3 class="anchored" data-anchor-id="test_ge">test_ge</h3>
<blockquote class="blockquote">
<pre><code> test_ge (a, b)</code></pre>
</blockquote>
<p><em><code>test</code> that <code>a&gt;=b</code></em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L395" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="test_gt" class="level3">
<h3 class="anchored" data-anchor-id="test_gt">test_gt</h3>
<blockquote class="blockquote">
<pre><code> test_gt (a, b)</code></pre>
</blockquote>
<p><em><code>test</code> that <code>a&gt;b</code></em></p>
<div id="cell-68" class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>test_ok(test_gt, <span class="dv">5</span>, <span class="dv">4</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>test_not_ok(test_gt, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>test_ok(test_ge, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>test_not_ok(test_ge, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>test_ok(test_lt, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>test_not_ok(test_lt, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>test_ok(test_le, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>test_not_ok(test_le, <span class="dv">5</span>, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-69" class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.rand(<span class="dv">100</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>test_eq(t, t)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>test_eq_nan(t, t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L420" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="stack_pad" class="level3">
<h3 class="anchored" data-anchor-id="stack_pad">stack_pad</h3>
<blockquote class="blockquote">
<pre><code> stack_pad (o, padding_value=nan)</code></pre>
</blockquote>
<p><em>Converts a an iterable into a numpy array using padding if necessary</em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L412" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="stack" class="level3">
<h3 class="anchored" data-anchor-id="stack">stack</h3>
<blockquote class="blockquote">
<pre><code> stack (o, axis=0, retain=True)</code></pre>
</blockquote>
<div id="cell-72" class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> [[<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>]]</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>test_eq(stack_pad(o).shape, (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>))</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">type</span>(stack_pad(o)), np.ndarray)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>test_eq(np.isnan(stack_pad(o)).<span class="bu">sum</span>(), <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-73" class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stack_pad(o))</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>test_eq(stack_pad(o), np.array([[<span class="fl">3.</span>]]))</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> [<span class="dv">4</span>,<span class="dv">5</span>]</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stack_pad(o))</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>test_eq(stack_pad(o), np.array([[<span class="fl">4.</span>, <span class="fl">5.</span>]]))</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> [[<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>]]</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stack_pad(o))</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> np.array([<span class="dv">0</span>, [<span class="dv">1</span>,<span class="dv">2</span>]], dtype<span class="op">=</span><span class="bu">object</span>)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stack_pad(o))</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> np.array([[[<span class="dv">0</span>], [<span class="dv">10</span>, <span class="dv">20</span>], [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>]], [[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">10</span>, <span class="dv">20</span>], [<span class="dv">100</span>]]], dtype<span class="op">=</span><span class="bu">object</span>)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stack_pad(o))</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> np.array([<span class="dv">0</span>, [<span class="dv">10</span>, <span class="dv">20</span>]], dtype<span class="op">=</span><span class="bu">object</span>)</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stack_pad(o))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[3.]]
[[4. 5.]]
[[[ 0.  1.  2. nan]
  [ 4.  5.  6.  7.]]]
[[ 0. nan]
 [ 1.  2.]]
[[[  0.  nan  nan  nan]
  [ 10.  20.  nan  nan]
  [100. 200. 300.  nan]]

 [[  0.   1.   2.   3.]
  [ 10.  20.  nan  nan]
  [100.  nan  nan  nan]]]
[[ 0. nan]
 [10. 20.]]</code></pre>
</div>
</div>
<div id="cell-74" class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.from_numpy(a)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>test_eq_type(stack(itemify(a, tup_id<span class="op">=</span><span class="dv">0</span>)), a)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>test_eq_type(stack(itemify(t, tup_id<span class="op">=</span><span class="dv">0</span>)), t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L443" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="pad_sequences" class="level3">
<h3 class="anchored" data-anchor-id="pad_sequences">pad_sequences</h3>
<blockquote class="blockquote">
<pre><code> pad_sequences (o, maxlen:int=None,
                dtype:(&lt;class'str'&gt;,&lt;class'type'&gt;)=&lt;class
                'numpy.float64'&gt;, padding:str='pre', truncating:str='pre',
                padding_value:float=nan)</code></pre>
</blockquote>
<p><em>Transforms an iterable with sequences into a 3d numpy array using padding or truncating sequences if necessary</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>o</td>
<td></td>
<td></td>
<td>Iterable object</td>
</tr>
<tr class="even">
<td>maxlen</td>
<td>int</td>
<td>None</td>
<td>Optional max length of the output. If None, max length of the longest individual sequence.</td>
</tr>
<tr class="odd">
<td>dtype</td>
<td>(&lt;class ‘str’&gt;, &lt;class ‘type’&gt;)</td>
<td>float64</td>
<td>Type of the output sequences. To pad sequences with variable length strings, you can use object.</td>
</tr>
<tr class="even">
<td>padding</td>
<td>str</td>
<td>pre</td>
<td>‘pre’ or ‘post’ pad either before or after each sequence.</td>
</tr>
<tr class="odd">
<td>truncating</td>
<td>str</td>
<td>pre</td>
<td>‘pre’ or ‘post’ remove values from sequences larger than maxlen, either at the beginning or at the end of the sequences.</td>
</tr>
<tr class="even">
<td>padding_value</td>
<td>float</td>
<td>nan</td>
<td>Value used for padding.</td>
</tr>
</tbody>
</table>
<p>This function transforms a list (of length n_samples) of sequences into a 3d numpy array of shape:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>                          <span class="ex">[n_samples</span> x n_vars x seq_len]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>seq_len is either the maxlen argument if provided, or the length of the longest sequence in the list.</p>
<p>Sequences that are shorter than seq_len are padded with value until they are seq_len long.</p>
<p>Sequences longer than seq_len are truncated so that they fit the desired length.</p>
<p>The position where padding or truncation happens is determined by the arguments padding and truncating, respectively. Pre-padding or removing values from the beginning of the sequence is the default.</p>
<p>Input sequences to pad_sequences may be have 1, 2 or 3 dimensions:</p>
<div id="cell-77" class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 dim</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">=</span> np.arange(<span class="dv">6</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>a2 <span class="op">=</span> np.arange(<span class="dv">3</span>) <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>a3 <span class="op">=</span> np.arange(<span class="dv">2</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>o  <span class="op">=</span> [a1, a2, a3]</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>padded_o <span class="op">=</span> pad_sequences(o, maxlen<span class="op">=</span><span class="dv">4</span>, dtype<span class="op">=</span>np.float64, padding<span class="op">=</span><span class="st">'post'</span>, truncating<span class="op">=</span><span class="st">'pre'</span>, padding_value<span class="op">=</span>np.nan)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>test_eq(padded_o.shape, (<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>))</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>padded_o</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[[  2.,   3.,   4.,   5.]],

       [[  0.,  10.,  20.,  nan]],

       [[  0., 100.,  nan,  nan]]])</code></pre>
</div>
</div>
<div id="cell-78" class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 dim</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">=</span> np.arange(<span class="dv">12</span>).reshape(<span class="dv">2</span>, <span class="dv">6</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>a2 <span class="op">=</span> np.arange(<span class="dv">6</span>).reshape(<span class="dv">2</span>, <span class="dv">3</span>) <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>a3 <span class="op">=</span> np.arange(<span class="dv">4</span>).reshape(<span class="dv">2</span>, <span class="dv">2</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>o  <span class="op">=</span> [a1, a2, a3]</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>padded_o <span class="op">=</span> pad_sequences(o, maxlen<span class="op">=</span><span class="dv">4</span>, dtype<span class="op">=</span>np.float64, padding<span class="op">=</span><span class="st">'post'</span>, truncating<span class="op">=</span><span class="st">'pre'</span>, padding_value<span class="op">=</span>np.nan)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>test_eq(padded_o.shape, (<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>))</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>padded_o</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[[  2.,   3.,   4.,   5.],
        [  8.,   9.,  10.,  11.]],

       [[  0.,  10.,  20.,  nan],
        [ 30.,  40.,  50.,  nan]],

       [[  0., 100.,  nan,  nan],
        [200., 300.,  nan,  nan]]])</code></pre>
</div>
</div>
<div id="cell-79" class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 dim</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">=</span> np.arange(<span class="dv">10</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>a2 <span class="op">=</span> np.arange(<span class="dv">6</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>a3 <span class="op">=</span> np.arange(<span class="dv">4</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>o  <span class="op">=</span> [a1, a2, a3]</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>padded_o <span class="op">=</span> pad_sequences(o, maxlen<span class="op">=</span><span class="va">None</span>, dtype<span class="op">=</span>np.float64, padding<span class="op">=</span><span class="st">'pre'</span>, truncating<span class="op">=</span><span class="st">'pre'</span>, padding_value<span class="op">=</span>np.nan)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>test_eq(padded_o.shape, (<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>))</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>padded_o</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[[  0.,   1.,   2.,   3.,   4.],
        [  5.,   6.,   7.,   8.,   9.]],

       [[ nan,  nan,   0.,  10.,  20.],
        [ nan,  nan,  30.,  40.,  50.]],

       [[ nan,  nan,  nan,   0., 100.],
        [ nan,  nan,  nan, 200., 300.]]])</code></pre>
</div>
</div>
<div id="cell-80" class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 dim</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">=</span> np.arange(<span class="dv">10</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>a2 <span class="op">=</span> np.arange(<span class="dv">6</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>a3 <span class="op">=</span> np.arange(<span class="dv">4</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>o  <span class="op">=</span> [a1, a2, a3]</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>padded_o <span class="op">=</span> pad_sequences(o, maxlen<span class="op">=</span><span class="dv">4</span>, dtype<span class="op">=</span>np.float64, padding<span class="op">=</span><span class="st">'pre'</span>, truncating<span class="op">=</span><span class="st">'pre'</span>, padding_value<span class="op">=</span>np.nan)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>test_eq(padded_o.shape, (<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>))</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>padded_o</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[[  1.,   2.,   3.,   4.],
        [  6.,   7.,   8.,   9.]],

       [[ nan,   0.,  10.,  20.],
        [ nan,  30.,  40.,  50.]],

       [[ nan,  nan,   0., 100.],
        [ nan,  nan, 200., 300.]]])</code></pre>
</div>
</div>
<div id="cell-81" class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 dim</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">=</span> np.arange(<span class="dv">10</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>a2 <span class="op">=</span> np.arange(<span class="dv">6</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>a3 <span class="op">=</span> np.arange(<span class="dv">4</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>o  <span class="op">=</span> [a1, a2, a3]</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>padded_o <span class="op">=</span> pad_sequences(o, maxlen<span class="op">=</span><span class="dv">4</span>, dtype<span class="op">=</span>np.float64, padding<span class="op">=</span><span class="st">'post'</span>, truncating<span class="op">=</span><span class="st">'pre'</span>, padding_value<span class="op">=</span>np.nan)</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>test_eq(padded_o.shape, (<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>))</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>padded_o</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[[  1.,   2.,   3.,   4.],
        [  6.,   7.,   8.,   9.]],

       [[  0.,  10.,  20.,  nan],
        [ 30.,  40.,  50.,  nan]],

       [[  0., 100.,  nan,  nan],
        [200., 300.,  nan,  nan]]])</code></pre>
</div>
</div>
<div id="cell-82" class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 dim</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">=</span> np.arange(<span class="dv">10</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>a2 <span class="op">=</span> np.arange(<span class="dv">6</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>a3 <span class="op">=</span> np.arange(<span class="dv">4</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>o  <span class="op">=</span> [a1, a2, a3]</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>padded_o <span class="op">=</span> pad_sequences(o, maxlen<span class="op">=</span><span class="dv">4</span>, dtype<span class="op">=</span>np.float64, padding<span class="op">=</span><span class="st">'post'</span>, truncating<span class="op">=</span><span class="st">'post'</span>, padding_value<span class="op">=</span>np.nan)</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>test_eq(padded_o.shape, (<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>))</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>padded_o</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[[  0.,   1.,   2.,   3.],
        [  5.,   6.,   7.,   8.]],

       [[  0.,  10.,  20.,  nan],
        [ 30.,  40.,  50.,  nan]],

       [[  0., 100.,  nan,  nan],
        [200., 300.,  nan,  nan]]])</code></pre>
</div>
</div>
<div id="cell-83" class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># iterable is a list of lists</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">=</span> np.arange(<span class="dv">12</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">6</span>).tolist()</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>a2 <span class="op">=</span> (np.arange(<span class="dv">6</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="op">*</span> <span class="dv">10</span>).tolist()</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>a3 <span class="op">=</span> (np.arange(<span class="dv">4</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>) <span class="op">*</span> <span class="dv">100</span>).tolist()</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>o  <span class="op">=</span> [a1, a2, a3]</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>padded_o <span class="op">=</span> pad_sequences(o, maxlen<span class="op">=</span><span class="va">None</span>, dtype<span class="op">=</span>np.float64, padding<span class="op">=</span><span class="st">'post'</span>, truncating<span class="op">=</span><span class="st">'pre'</span>, padding_value<span class="op">=</span>np.nan)</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>test_eq(padded_o.shape, (<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">6</span>))</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>padded_o</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[[  0.,   1.,   2.,   3.,   4.,   5.],
        [  6.,   7.,   8.,   9.,  10.,  11.]],

       [[  0.,  10.,  20.,  nan,  nan,  nan],
        [ 30.,  40.,  50.,  nan,  nan,  nan]],

       [[  0., 100.,  nan,  nan,  nan,  nan],
        [200., 300.,  nan,  nan,  nan,  nan]]])</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L473" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="match_seq_len" class="level3">
<h3 class="anchored" data-anchor-id="match_seq_len">match_seq_len</h3>
<blockquote class="blockquote">
<pre><code> match_seq_len (*arrays)</code></pre>
</blockquote>
<div id="cell-85" class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">8</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.random.rand(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>c, d <span class="op">=</span> match_seq_len(a, b)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>test_eq(c.shape[<span class="op">-</span><span class="dv">1</span>], d.shape[<span class="op">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L478" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="random_shuffle" class="level3">
<h3 class="anchored" data-anchor-id="random_shuffle">random_shuffle</h3>
<blockquote class="blockquote">
<pre><code> random_shuffle (o, random_state=None)</code></pre>
</blockquote>
<div id="cell-87" class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.arange(<span class="dv">10</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>test_eq_type(random_shuffle(a, <span class="dv">1</span>), np.array([<span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">5</span>]))</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.arange(<span class="dv">10</span>)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>test_eq_type(random_shuffle(t, <span class="dv">1</span>), tensor([<span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">5</span>]))</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>l <span class="op">=</span> <span class="bu">list</span>(a)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>test_eq(random_shuffle(l, <span class="dv">1</span>), [<span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">5</span>])</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>l2 <span class="op">=</span> L(l)</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>test_eq_type(random_shuffle(l2, <span class="dv">1</span>), L([<span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">5</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L485" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="cat2int" class="level3">
<h3 class="anchored" data-anchor-id="cat2int">cat2int</h3>
<blockquote class="blockquote">
<pre><code> cat2int (o)</code></pre>
</blockquote>
<div id="cell-89" class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="st">'b'</span>, <span class="st">'a'</span>, <span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'a'</span>])</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>test_eq_type(cat2int(a), TensorCategory([<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-90" class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>TensorBase([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>TensorBase([1, 2, 3])</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L512" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="cycle_dl_estimate" class="level3">
<h3 class="anchored" data-anchor-id="cycle_dl_estimate">cycle_dl_estimate</h3>
<blockquote class="blockquote">
<pre><code> cycle_dl_estimate (dl, iters=10)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L503" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="cycle_dl_to_device" class="level3">
<h3 class="anchored" data-anchor-id="cycle_dl_to_device">cycle_dl_to_device</h3>
<blockquote class="blockquote">
<pre><code> cycle_dl_to_device (dl, show_progress_bar=True)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L493" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="cycle_dl" class="level3">
<h3 class="anchored" data-anchor-id="cycle_dl">cycle_dl</h3>
<blockquote class="blockquote">
<pre><code> cycle_dl (dl, show_progress_bar=True)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L524" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="cache_data" class="level3">
<h3 class="anchored" data-anchor-id="cache_data">cache_data</h3>
<blockquote class="blockquote">
<pre><code> cache_data (o, slice_len=10000, verbose=False)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L539" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_func_defaults" class="level3">
<h3 class="anchored" data-anchor-id="get_func_defaults">get_func_defaults</h3>
<blockquote class="blockquote">
<pre><code> get_func_defaults (f)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L546" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_idx_from_df_col_vals" class="level3">
<h3 class="anchored" data-anchor-id="get_idx_from_df_col_vals">get_idx_from_df_col_vals</h3>
<blockquote class="blockquote">
<pre><code> get_idx_from_df_col_vals (df, col, val_list)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L550" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_sublist_idxs" class="level3">
<h3 class="anchored" data-anchor-id="get_sublist_idxs">get_sublist_idxs</h3>
<blockquote class="blockquote">
<pre><code> get_sublist_idxs (aList, bList)</code></pre>
</blockquote>
<p><em>Get idxs that when applied to aList will return bList. aList must contain all values in bList</em></p>
<div id="cell-98" class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">2</span>])</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([<span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">7</span>])</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> get_sublist_idxs(x, y)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>test_eq(x[idx], y)</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">2</span>])</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([<span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">5</span>])</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> get_sublist_idxs(x, y)</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>test_eq(x[idx], y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L556" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="flatten_list" class="level3">
<h3 class="anchored" data-anchor-id="flatten_list">flatten_list</h3>
<blockquote class="blockquote">
<pre><code> flatten_list (l)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L560" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="display_pd_df" class="level3">
<h3 class="anchored" data-anchor-id="display_pd_df">display_pd_df</h3>
<blockquote class="blockquote">
<pre><code> display_pd_df (df, max_rows:Union[bool,int]=False,
                max_columns:Union[bool,int]=False)</code></pre>
</blockquote>
<div id="cell-101" class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>old_max_rows, old_max_columns <span class="op">=</span> pd.get_option(<span class="st">'display.max_rows'</span>), pd.get_option(<span class="st">'display.max_columns'</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.random.rand(<span class="dv">70</span>, <span class="dv">25</span>))</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>display_pd_df(df, max_rows<span class="op">=</span><span class="dv">2</span>, max_columns<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>test_eq(old_max_rows, pd.get_option(<span class="st">'display.max_rows'</span>))</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>test_eq(old_max_columns, pd.get_option(<span class="st">'display.max_columns'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">24</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.436034</td>
<td>...</td>
<td>0.231616</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">69</td>
<td>0.633051</td>
<td>...</td>
<td>0.051762</td>
</tr>
</tbody>
</table>

<p>70 rows × 25 columns</p>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L603" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="tscore" class="level3">
<h3 class="anchored" data-anchor-id="tscore">tscore</h3>
<blockquote class="blockquote">
<pre><code> tscore (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L579" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="kstest" class="level3">
<h3 class="anchored" data-anchor-id="kstest">kstest</h3>
<blockquote class="blockquote">
<pre><code> kstest (data1, data2, alternative='two-sided', mode='auto', by_axis=None)</code></pre>
</blockquote>
<p>*Performs the two-sample Kolmogorov-Smirnov test for goodness of fit.</p>
<p>Parameters data1, data2: Two arrays of sample observations assumed to be drawn from a continuous distributions. Sample sizes can be different. alternative: {‘two-sided’, ‘less’, ‘greater’}, optional. Defines the null and alternative hypotheses. Default is ‘two-sided’. mode: {‘auto’, ‘exact’, ‘asymp’}, optional. Defines the method used for calculating the p-value. by_axis (optional, int): for arrays with more than 1 dimension, the test will be run for each variable in that axis if by_axis is not None.*</p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L574" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="ttest" class="level3">
<h3 class="anchored" data-anchor-id="ttest">ttest</h3>
<blockquote class="blockquote">
<pre><code> ttest (data1, data2, equal_var=False)</code></pre>
</blockquote>
<p><em>Calculates t-statistic and p-value based on 2 sample distributions</em></p>
<div id="cell-105" class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.normal(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.random.normal(<span class="fl">0.15</span>, <span class="fl">.5</span>, <span class="dv">50</span>)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>plt.hist(a, <span class="dv">50</span>)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>plt.hist(b, <span class="dv">50</span>)</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>ttest(a,b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="002_utils_files/figure-html/cell-103-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-106" class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.normal(<span class="fl">0.5</span>, <span class="dv">1</span>, (<span class="dv">100</span>,<span class="dv">3</span>))</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.random.normal(<span class="fl">0.5</span>, <span class="dv">1</span>, (<span class="dv">50</span>,))</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>kstest(a,b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(0.22333333333333333, 0.02452803315700394)</code></pre>
</div>
</div>
<div id="cell-107" class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.normal(<span class="fl">0.5</span>, <span class="dv">1</span>, (<span class="dv">100</span>,<span class="dv">3</span>))</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.random.normal(<span class="fl">0.15</span>, <span class="fl">.5</span>, (<span class="dv">50</span>,))</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>kstest(a,b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(0.31, 0.0004061333917852463)</code></pre>
</div>
</div>
<div id="cell-108" class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>data1 <span class="op">=</span> np.random.normal(<span class="dv">0</span>,<span class="dv">1</span>,(<span class="dv">100</span>, <span class="dv">5</span>, <span class="dv">3</span>))</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>data2 <span class="op">=</span> np.random.normal(<span class="dv">0</span>,<span class="dv">2</span>,(<span class="dv">100</span>, <span class="dv">5</span>, <span class="dv">3</span>))</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>kstest(data1, data2, by_axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>([0.22,
  0.16333333333333333,
  0.16333333333333333,
  0.18666666666666668,
  0.21666666666666667],
 [8.994053173844458e-07,
  0.0006538374533623971,
  0.0006538374533623971,
  5.522790313356146e-05,
  1.4007759411179028e-06])</code></pre>
</div>
</div>
<div id="cell-109" class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.normal(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.normal(<span class="fl">0.5</span>, <span class="dv">1</span>, (<span class="dv">100</span>, ))</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>tscore(a), tscore(t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(4.33309224863388, tensor(5.7798))</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L611" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="scc" class="level3">
<h3 class="anchored" data-anchor-id="scc">scc</h3>
<blockquote class="blockquote">
<pre><code> scc (a, b)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L608" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="pcc" class="level3">
<h3 class="anchored" data-anchor-id="pcc">pcc</h3>
<blockquote class="blockquote">
<pre><code> pcc (a, b)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L619" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="remove_fn" class="level3">
<h3 class="anchored" data-anchor-id="remove_fn">remove_fn</h3>
<blockquote class="blockquote">
<pre><code> remove_fn (fn, verbose=False)</code></pre>
</blockquote>
<p><em>Removes a file (fn) if exists</em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L629" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="npsave" class="level3">
<h3 class="anchored" data-anchor-id="npsave">npsave</h3>
<blockquote class="blockquote">
<pre><code> npsave (array_fn, array, verbose=True)</code></pre>
</blockquote>
<div id="cell-114" class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>fn <span class="op">=</span> <span class="st">'data/remove_fn_test.npy'</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.zeros(<span class="dv">1</span>)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>npsave(fn, a)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> a</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>np.load(fn, mmap_mode<span class="op">=</span><span class="st">'r+'</span>)</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>remove_fn(fn, <span class="va">True</span>)</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>remove_fn(fn, <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>data/remove_fn_test.npy does not exist
saving data/remove_fn_test.npy...
...data/remove_fn_test.npy saved
data/remove_fn_test.npy file removed
data/remove_fn_test.npy does not exist</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L638" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="permute_2d" class="level3">
<h3 class="anchored" data-anchor-id="permute_2d">permute_2D</h3>
<blockquote class="blockquote">
<pre><code> permute_2D (array, axis=None)</code></pre>
</blockquote>
<p><em>Permute rows or columns in an array. This can be used, for example, in feature permutation</em></p>
<div id="cell-116" class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> np.arange(<span class="dv">100</span> <span class="op">*</span> <span class="dv">50</span>).reshape(<span class="dv">100</span>, <span class="dv">50</span>)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>test_eq(permute_2D(s, axis<span class="op">=</span><span class="dv">0</span>).mean(<span class="dv">0</span>), s.mean(<span class="dv">0</span>))</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>test_ne(permute_2D(s, axis<span class="op">=</span><span class="dv">0</span>), s)</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>test_eq(permute_2D(s, axis<span class="op">=</span><span class="dv">1</span>).mean(<span class="dv">1</span>), s.mean(<span class="dv">1</span>))</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>test_ne(permute_2D(s, axis<span class="op">=</span><span class="dv">1</span>), s)</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>test_ne(permute_2D(s), s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L663" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="random_half_normal_tensor" class="level3">
<h3 class="anchored" data-anchor-id="random_half_normal_tensor">random_half_normal_tensor</h3>
<blockquote class="blockquote">
<pre><code> random_half_normal_tensor (shape=1, device=None)</code></pre>
</blockquote>
<p><em>Returns a tensor of a predefined shape between 0 and 1 with a half-normal distribution</em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L659" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="random_normal_tensor" class="level3">
<h3 class="anchored" data-anchor-id="random_normal_tensor">random_normal_tensor</h3>
<blockquote class="blockquote">
<pre><code> random_normal_tensor (shape=1, device=None)</code></pre>
</blockquote>
<p><em>Returns a tensor of a predefined shape between -1 and 1 with a normal distribution</em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L652" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="random_half_normal" class="level3">
<h3 class="anchored" data-anchor-id="random_half_normal">random_half_normal</h3>
<blockquote class="blockquote">
<pre><code> random_half_normal ()</code></pre>
</blockquote>
<p><em>Returns a number between 0 and 1 with a half-normal distribution</em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L645" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="random_normal" class="level3">
<h3 class="anchored" data-anchor-id="random_normal">random_normal</h3>
<blockquote class="blockquote">
<pre><code> random_normal ()</code></pre>
</blockquote>
<p><em>Returns a number between -1 and 1 with a normal distribution</em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L688" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="fig2buf" class="level3">
<h3 class="anchored" data-anchor-id="fig2buf">fig2buf</h3>
<blockquote class="blockquote">
<pre><code> fig2buf (fig)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L675" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_plot_fig" class="level3">
<h3 class="anchored" data-anchor-id="get_plot_fig">get_plot_fig</h3>
<blockquote class="blockquote">
<pre><code> get_plot_fig (size=None, dpi=100)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L670" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="default_dpi" class="level3">
<h3 class="anchored" data-anchor-id="default_dpi">default_dpi</h3>
<blockquote class="blockquote">
<pre><code> default_dpi ()</code></pre>
</blockquote>
<div id="cell-124" class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>default_dpi()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>100</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L694" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_scatter" class="level3">
<h3 class="anchored" data-anchor-id="plot_scatter">plot_scatter</h3>
<blockquote class="blockquote">
<pre><code> plot_scatter (x, y, deg=1)</code></pre>
</blockquote>
<div id="cell-126" class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">100</span>)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.random.rand(<span class="dv">100</span>)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>plot_scatter(a, b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="002_utils_files/figure-html/cell-124-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L702" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_idxs" class="level3">
<h3 class="anchored" data-anchor-id="get_idxs">get_idxs</h3>
<blockquote class="blockquote">
<pre><code> get_idxs (o, aList)</code></pre>
</blockquote>
<div id="cell-128" class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> random_shuffle(np.arange(<span class="dv">100</span>, <span class="dv">200</span>))</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.random.choice(a, <span class="dv">10</span>, <span class="va">False</span>)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>idxs <span class="op">=</span> get_idxs(a, b)</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>test_eq(a[idxs], b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L705" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="apply_cmap" class="level3">
<h3 class="anchored" data-anchor-id="apply_cmap">apply_cmap</h3>
<blockquote class="blockquote">
<pre><code> apply_cmap (o, cmap)</code></pre>
</blockquote>
<div id="cell-130" class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">16</span>, <span class="dv">1</span>, <span class="dv">40</span>, <span class="dv">50</span>)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> L(a.shape)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>s[<span class="dv">1</span>] <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>test_eq(L(apply_cmap(a, <span class="st">'viridis'</span>).shape), s)</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>s[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">1</span>, <span class="dv">40</span>, <span class="dv">50</span>)</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>test_eq(L(apply_cmap(a, <span class="st">'viridis'</span>).shape), s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L712" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="torch_tile" class="level3">
<h3 class="anchored" data-anchor-id="torch_tile">torch_tile</h3>
<blockquote class="blockquote">
<pre><code> torch_tile (a, n_tile, dim=0)</code></pre>
</blockquote>
<div id="cell-132" class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>test_eq(torch_tile(torch.arange(<span class="dv">2</span>), <span class="dv">3</span>), tensor([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L725" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to_tsfresh_df" class="level3">
<h3 class="anchored" data-anchor-id="to_tsfresh_df">to_tsfresh_df</h3>
<blockquote class="blockquote">
<pre><code> to_tsfresh_df (ts)</code></pre>
</blockquote>
<p><em>Prepares a time series (Tensor/ np.ndarray) to be used as a tsfresh dataset to allow feature extraction</em></p>
<div id="cell-134" class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>ts <span class="op">=</span> torch.rand(<span class="dv">16</span>, <span class="dv">3</span>, <span class="dv">20</span>)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> to_tsfresh_df(ts)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>ts <span class="op">=</span> ts.numpy()</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> to_tsfresh_df(ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L746" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="scorr" class="level3">
<h3 class="anchored" data-anchor-id="scorr">scorr</h3>
<blockquote class="blockquote">
<pre><code> scorr (a, b)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L743" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="pcorr" class="level3">
<h3 class="anchored" data-anchor-id="pcorr">pcorr</h3>
<blockquote class="blockquote">
<pre><code> pcorr (a, b)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L751" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="torch_diff" class="level3">
<h3 class="anchored" data-anchor-id="torch_diff">torch_diff</h3>
<blockquote class="blockquote">
<pre><code> torch_diff (t, lag=1, pad=True, append=0)</code></pre>
</blockquote>
<div id="cell-138" class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.arange(<span class="dv">24</span>).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>test_eq(torch_diff(t, <span class="dv">1</span>)[..., <span class="dv">1</span>:].<span class="bu">float</span>().mean(), <span class="fl">1.</span>)</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>test_eq(torch_diff(t, <span class="dv">2</span>)[..., <span class="dv">2</span>:].<span class="bu">float</span>().mean(), <span class="fl">2.</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L783" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="torch_clamp" class="level3">
<h3 class="anchored" data-anchor-id="torch_clamp">torch_clamp</h3>
<blockquote class="blockquote">
<pre><code> torch_clamp (o, min=None, max=None)</code></pre>
</blockquote>
<p><em>Clamp torch.Tensor using 1 or multiple dimensions</em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L777" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_percentile" class="level3">
<h3 class="anchored" data-anchor-id="get_percentile">get_percentile</h3>
<blockquote class="blockquote">
<pre><code> get_percentile (o, percentile, axis=None)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L770" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="clip_outliers" class="level3">
<h3 class="anchored" data-anchor-id="clip_outliers">clip_outliers</h3>
<blockquote class="blockquote">
<pre><code> clip_outliers (o, axis=None)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L760" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_outliers_iqr" class="level3">
<h3 class="anchored" data-anchor-id="get_outliers_iqr">get_outliers_IQR</h3>
<blockquote class="blockquote">
<pre><code> get_outliers_IQR (o, axis=None, quantile_range=(25.0, 75.0))</code></pre>
</blockquote>
<div id="cell-143" class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.randn(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">100</span>)</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">type</span>(get_outliers_IQR(t, <span class="op">-</span><span class="dv">1</span>)[<span class="dv">0</span>]), torch.Tensor)</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> t.numpy()</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">type</span>(get_outliers_IQR(a, <span class="op">-</span><span class="dv">1</span>)[<span class="dv">0</span>]), np.ndarray)</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>test_close(get_percentile(t, <span class="dv">25</span>).numpy(), get_percentile(a, <span class="dv">25</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L790" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_robustscale_params" class="level3">
<h3 class="anchored" data-anchor-id="get_robustscale_params">get_robustscale_params</h3>
<blockquote class="blockquote">
<pre><code> get_robustscale_params (o, sel_vars=None, not_sel_vars=None, by_var=True,
                         percentiles=(25, 75), eps=1e-06)</code></pre>
</blockquote>
<p><em>Calculates median and inter-quartile range required to robust scaler inputs</em></p>
<div id="cell-145" class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">16</span>, <span class="dv">3</span>, <span class="dv">100</span>)</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>a[a<span class="op">&gt;</span><span class="fl">.8</span>] <span class="op">=</span> np.nan</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>median, IQR <span class="op">=</span> get_robustscale_params(a, by_var<span class="op">=</span><span class="va">True</span>, percentiles<span class="op">=</span>(<span class="dv">25</span>, <span class="dv">75</span>))</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>a_scaled <span class="op">=</span> (a <span class="op">-</span> median) <span class="op">/</span> IQR</span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>test_eq(a.shape, a_scaled.shape)</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>test_eq(np.isnan(median).<span class="bu">sum</span>(),<span class="dv">0</span>)</span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>test_eq(np.isnan(IQR).<span class="bu">sum</span>(),<span class="dv">0</span>)</span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>test_eq(np.isnan(a), np.isnan(a_scaled))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L818" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="torch_slice_by_dim" class="level3">
<h3 class="anchored" data-anchor-id="torch_slice_by_dim">torch_slice_by_dim</h3>
<blockquote class="blockquote">
<pre><code> torch_slice_by_dim (t, index, dim=-1, **kwargs)</code></pre>
</blockquote>
<div id="cell-147" class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.rand(<span class="dv">5</span>, <span class="dv">3</span>)</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>index <span class="op">=</span> torch.randint(<span class="dv">0</span>, <span class="dv">3</span>, (<span class="dv">5</span>, <span class="dv">1</span>))</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="co"># index = [[0, 2], [0, 1], [1, 2], [0, 2], [0, 1]]</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>torch_slice_by_dim(t, index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>tensor([[0.5341],
        [0.4543],
        [0.0942],
        [0.9645],
        [0.0405]])</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L837" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="torch_nanstd" class="level3">
<h3 class="anchored" data-anchor-id="torch_nanstd">torch_nanstd</h3>
<blockquote class="blockquote">
<pre><code> torch_nanstd (o, dim=None, keepdim=False)</code></pre>
</blockquote>
<p><em>There’s currently no torch.nanstd function</em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L825" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="torch_nanmean" class="level3">
<h3 class="anchored" data-anchor-id="torch_nanmean">torch_nanmean</h3>
<blockquote class="blockquote">
<pre><code> torch_nanmean (o, dim=None, keepdim=False)</code></pre>
</blockquote>
<p><em>There’s currently no torch.nanmean function</em></p>
<div id="cell-150" class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.rand(<span class="dv">1000</span>)</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>t[:<span class="dv">100</span>] <span class="op">=</span> <span class="bu">float</span>(<span class="st">'nan'</span>)</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> torch_nanmean(t).item() <span class="op">&gt;</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L849" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="concat" class="level3">
<h3 class="anchored" data-anchor-id="concat">concat</h3>
<blockquote class="blockquote">
<pre><code> concat (*ls, dim=0)</code></pre>
</blockquote>
<p><em>Concatenate tensors, arrays, lists, or tuples by a dimension</em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L860" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="reduce_memory_usage" class="level3">
<h3 class="anchored" data-anchor-id="reduce_memory_usage">reduce_memory_usage</h3>
<blockquote class="blockquote">
<pre><code> reduce_memory_usage (df)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L898" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="cls_name" class="level3">
<h3 class="anchored" data-anchor-id="cls_name">cls_name</h3>
<blockquote class="blockquote">
<pre><code> cls_name (o)</code></pre>
</blockquote>
<div id="cell-154" class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>test_eq(cls_name(timer), <span class="st">'Timer'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L971" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="rotate_axis2" class="level3">
<h3 class="anchored" data-anchor-id="rotate_axis2">rotate_axis2</h3>
<blockquote class="blockquote">
<pre><code> rotate_axis2 (o, steps=1)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L968" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="rotate_axis1" class="level3">
<h3 class="anchored" data-anchor-id="rotate_axis1">rotate_axis1</h3>
<blockquote class="blockquote">
<pre><code> rotate_axis1 (o, steps=1)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L965" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="rotate_axis0" class="level3">
<h3 class="anchored" data-anchor-id="rotate_axis0">rotate_axis0</h3>
<blockquote class="blockquote">
<pre><code> rotate_axis0 (o, steps=1)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L950" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="random_roll3d" class="level3">
<h3 class="anchored" data-anchor-id="random_roll3d">random_roll3d</h3>
<blockquote class="blockquote">
<pre><code> random_roll3d (o, axis=(), replace=False)</code></pre>
</blockquote>
<p><em>Randomly rolls a 3D object along the indicated axes This solution is based on https://stackoverflow.com/questions/20360675/roll-rows-of-a-matrix-independently</em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L936" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="random_roll2d" class="level3">
<h3 class="anchored" data-anchor-id="random_roll2d">random_roll2d</h3>
<blockquote class="blockquote">
<pre><code> random_roll2d (o, axis=(), replace=False)</code></pre>
</blockquote>
<p><em>Rolls a 2D object on the indicated axis This solution is based on https://stackoverflow.com/questions/20360675/roll-rows-of-a-matrix-independently</em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L917" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="roll3d" class="level3">
<h3 class="anchored" data-anchor-id="roll3d">roll3d</h3>
<blockquote class="blockquote">
<pre><code> roll3d (o, roll1:Union[NoneType,list,int]=None,
         roll2:Union[NoneType,list,int]=None,
         roll3:Union[NoneType,list,int]=None)</code></pre>
</blockquote>
<p><em>Rolls a 3D object on the indicated axis This solution is based on https://stackoverflow.com/questions/20360675/roll-rows-of-a-matrix-independently</em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L901" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="roll2d" class="level3">
<h3 class="anchored" data-anchor-id="roll2d">roll2d</h3>
<blockquote class="blockquote">
<pre><code> roll2d (o, roll1:Union[NoneType,list,int]=None,
         roll2:Union[NoneType,list,int]=None)</code></pre>
</blockquote>
<p><em>Rolls a 2D object on the indicated axis This solution is based on https://stackoverflow.com/questions/20360675/roll-rows-of-a-matrix-independently</em></p>
<div id="cell-162" class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.tile(np.arange(<span class="dv">10</span>), <span class="dv">3</span>).reshape(<span class="dv">3</span>, <span class="dv">10</span>) <span class="op">*</span> np.array([<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>]).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[  0,   1,   2,   3,   4,   5,   6,   7,   8,   9],
       [  0,  10,  20,  30,  40,  50,  60,  70,  80,  90],
       [  0, 100, 200, 300, 400, 500, 600, 700, 800, 900]])</code></pre>
</div>
</div>
<div id="cell-163" class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>roll2d(a, roll1<span class="op">=</span>[<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[  0, 100, 200, 300, 400, 500, 600, 700, 800, 900],
       [  0,  10,  20,  30,  40,  50,  60,  70,  80,  90],
       [  0,   1,   2,   3,   4,   5,   6,   7,   8,   9]])</code></pre>
</div>
</div>
<div id="cell-164" class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>roll2d(a, roll2<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[  7,   8,   9,   0,   1,   2,   3,   4,   5,   6],
       [ 70,  80,  90,   0,  10,  20,  30,  40,  50,  60],
       [700, 800, 900,   0, 100, 200, 300, 400, 500, 600]])</code></pre>
</div>
</div>
<div id="cell-165" class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> torch.arange(<span class="dv">24</span>).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>test_eq(rotate_axis0(o)[<span class="dv">1</span>], o[<span class="dv">0</span>])</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>test_eq(rotate_axis1(o)[:,<span class="dv">1</span>], o[:,<span class="dv">0</span>])</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>test_eq(rotate_axis2(o)[...,<span class="dv">1</span>], o[...,<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L975" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="chunks_calculator" class="level3">
<h3 class="anchored" data-anchor-id="chunks_calculator">chunks_calculator</h3>
<blockquote class="blockquote">
<pre><code> chunks_calculator (shape, dtype='float32', n_bytes=1073741824)</code></pre>
</blockquote>
<p>*Function to calculate chunks for a given size of n_bytes (default = 1024**3 == 1GB). It guarantees &gt; 50% of the chunk will be filled*</p>
<div id="cell-167" class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>shape <span class="op">=</span> (<span class="dv">1_000</span>, <span class="dv">10</span>, <span class="dv">1000</span>)</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>dtype <span class="op">=</span> <span class="st">'float32'</span></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>test_eq(chunks_calculator(shape, dtype), <span class="va">False</span>)</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>shape <span class="op">=</span> (<span class="dv">54684</span>, <span class="dv">10</span>, <span class="dv">1000</span>)</span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>dtype <span class="op">=</span> <span class="st">'float32'</span></span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a>test_eq(chunks_calculator(shape, dtype), (<span class="dv">27342</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L990" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_memory_shared" class="level3">
<h3 class="anchored" data-anchor-id="is_memory_shared">is_memory_shared</h3>
<blockquote class="blockquote">
<pre><code> is_memory_shared (a, b)</code></pre>
</blockquote>
<p><em>Check if 2 array-like objects share memory</em></p>
<div id="cell-169" class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">=</span> torch.from_numpy(a)</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>test_eq(is_memory_shared(a, t1), <span class="va">True</span>)</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>t2 <span class="op">=</span> torch.as_tensor(a)</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>test_eq(is_memory_shared(a, t2), <span class="va">True</span>)</span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>t3 <span class="op">=</span> torch.tensor(a)</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a>test_eq(is_memory_shared(a, t3), <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L996" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="assign_in_chunks" class="level3">
<h3 class="anchored" data-anchor-id="assign_in_chunks">assign_in_chunks</h3>
<blockquote class="blockquote">
<pre><code> assign_in_chunks (a, b, chunksize='auto', inplace=True, verbose=True)</code></pre>
</blockquote>
<p><em>Assigns values in b to an array-like object a using chunks to avoid memory overload. The resulting a retains it’s dtype and share it’s memory. a: array-like object b: may be an integer, float, str, ‘rand’ (for random data), or another array like object. chunksize: is the size of chunks. If ‘auto’ chunks will have around 1GB each.</em></p>
<div id="cell-171" class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>).astype(<span class="st">'float32'</span>)</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>a_dtype <span class="op">=</span> a.dtype</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>a_id <span class="op">=</span> <span class="bu">id</span>(a)</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>).astype(<span class="st">'float64'</span>)</span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>assign_in_chunks(a, b, chunksize<span class="op">=</span><span class="dv">2</span>, inplace<span class="op">=</span><span class="va">True</span>, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>test_close(a, b)</span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>test_eq(a.dtype, a_dtype)</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">id</span>(a), a_id)</span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>).astype(<span class="st">'float32'</span>)</span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>a_dtype <span class="op">=</span> a.dtype</span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a>a_id <span class="op">=</span> <span class="bu">id</span>(a)</span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a>assign_in_chunks(a, b, chunksize<span class="op">=</span><span class="dv">2</span>, inplace<span class="op">=</span><span class="va">True</span>, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a>test_eq(a, np.ones_like(a).astype(a.dtype))</span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a>test_eq(a.dtype, a_dtype)</span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">id</span>(a), a_id)</span>
<span id="cb190-18"><a href="#cb190-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-19"><a href="#cb190-19" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>).astype(<span class="st">'float32'</span>)</span>
<span id="cb190-20"><a href="#cb190-20" aria-hidden="true" tabindex="-1"></a>a_dtype <span class="op">=</span> a.dtype</span>
<span id="cb190-21"><a href="#cb190-21" aria-hidden="true" tabindex="-1"></a>a_id <span class="op">=</span> <span class="bu">id</span>(a)</span>
<span id="cb190-22"><a href="#cb190-22" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb190-23"><a href="#cb190-23" aria-hidden="true" tabindex="-1"></a>assign_in_chunks(a, b, chunksize<span class="op">=</span><span class="dv">2</span>, inplace<span class="op">=</span><span class="va">True</span>, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb190-24"><a href="#cb190-24" aria-hidden="true" tabindex="-1"></a>test_eq(a.dtype, a_dtype)</span>
<span id="cb190-25"><a href="#cb190-25" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">id</span>(a), a_id)</span>
<span id="cb190-26"><a href="#cb190-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-27"><a href="#cb190-27" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>).astype(<span class="st">'float32'</span>)</span>
<span id="cb190-28"><a href="#cb190-28" aria-hidden="true" tabindex="-1"></a>a_dtype <span class="op">=</span> a.dtype</span>
<span id="cb190-29"><a href="#cb190-29" aria-hidden="true" tabindex="-1"></a>a_id <span class="op">=</span> <span class="bu">id</span>(a)</span>
<span id="cb190-30"><a href="#cb190-30" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="st">'rand'</span></span>
<span id="cb190-31"><a href="#cb190-31" aria-hidden="true" tabindex="-1"></a>assign_in_chunks(a, b, chunksize<span class="op">=</span><span class="dv">2</span>, inplace<span class="op">=</span><span class="va">True</span>, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb190-32"><a href="#cb190-32" aria-hidden="true" tabindex="-1"></a>test_eq(a.dtype, a_dtype)</span>
<span id="cb190-33"><a href="#cb190-33" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">id</span>(a), a_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
<div id="cell-172" class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>).astype(<span class="st">'float32'</span>)</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>).astype(<span class="st">'float64'</span>)</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> assign_in_chunks(a, b, chunksize<span class="op">=</span><span class="dv">2</span>, inplace<span class="op">=</span><span class="va">False</span>, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>test_close(c, b)</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>test_eq(a.dtype, c.dtype)</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>test_eq(is_memory_shared(a, c), <span class="va">True</span>)</span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>).astype(<span class="st">'float32'</span>)</span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> assign_in_chunks(a, b, chunksize<span class="op">=</span><span class="dv">2</span>, inplace<span class="op">=</span><span class="va">False</span>, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a>test_eq(a, np.ones_like(a).astype(a.dtype))</span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a>test_eq(a.dtype, c.dtype)</span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a>test_eq(is_memory_shared(a, c), <span class="va">True</span>)</span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>).astype(<span class="st">'float32'</span>)</span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb191-17"><a href="#cb191-17" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> assign_in_chunks(a, b, chunksize<span class="op">=</span><span class="dv">2</span>, inplace<span class="op">=</span><span class="va">False</span>, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb191-18"><a href="#cb191-18" aria-hidden="true" tabindex="-1"></a>test_eq(a.dtype, c.dtype)</span>
<span id="cb191-19"><a href="#cb191-19" aria-hidden="true" tabindex="-1"></a>test_eq(is_memory_shared(a, c), <span class="va">True</span>)</span>
<span id="cb191-20"><a href="#cb191-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-21"><a href="#cb191-21" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>).astype(<span class="st">'float32'</span>)</span>
<span id="cb191-22"><a href="#cb191-22" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="st">'rand'</span></span>
<span id="cb191-23"><a href="#cb191-23" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> assign_in_chunks(a, b, chunksize<span class="op">=</span><span class="dv">2</span>, inplace<span class="op">=</span><span class="va">False</span>, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb191-24"><a href="#cb191-24" aria-hidden="true" tabindex="-1"></a>test_eq(a.dtype, c.dtype)</span>
<span id="cb191-25"><a href="#cb191-25" aria-hidden="true" tabindex="-1"></a>test_eq(is_memory_shared(a, c), <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1026" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="create_array" class="level3">
<h3 class="anchored" data-anchor-id="create_array">create_array</h3>
<blockquote class="blockquote">
<pre><code> create_array (shape, fname=None, path='./data', on_disk=True,
               dtype='float32', mode='r+', fill_value='rand',
               chunksize='auto', verbose=True, **kwargs)</code></pre>
</blockquote>
<p><em>mode: ‘r’: Open existing file for reading only. ‘r+’: Open existing file for reading and writing. ‘w+’: Create or overwrite existing file for reading and writing. ‘c’: Copy-on-write: assignments affect data in memory, but changes are not saved to disk. The file on disk is read-only. fill_value: ‘rand’ (for random numbers), int or float chunksize = ‘auto’ to calculate chunks of 1GB, or any integer (for a given number of samples)</em></p>
<div id="cell-174" class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>fname <span class="op">=</span> <span class="st">'X_on_disk'</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>shape <span class="op">=</span> (<span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> create_array(shape, fname, on_disk<span class="op">=</span><span class="va">True</span>, mode<span class="op">=</span><span class="st">'r+'</span>)</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>test_ne(<span class="bu">abs</span>(X).<span class="bu">sum</span>(), <span class="dv">0</span>)</span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>os.remove(X.filename)</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>auto chunksize: 100</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
<div id="cell-175" class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>fname <span class="op">=</span> <span class="st">'X_on_disk'</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>shape <span class="op">=</span> (<span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> create_empty_array(shape, fname, on_disk<span class="op">=</span><span class="va">True</span>, mode<span class="op">=</span><span class="st">'r+'</span>)</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">abs</span>(X).<span class="bu">sum</span>(), <span class="dv">0</span>)</span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>chunksize <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>pbar <span class="op">=</span> progress_bar(<span class="bu">range</span>(math.ceil(<span class="bu">len</span>(X) <span class="op">/</span> chunksize)), leave<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> pbar:</span>
<span id="cb195-10"><a href="#cb195-10" aria-hidden="true" tabindex="-1"></a>    end <span class="op">=</span> <span class="bu">min</span>(start <span class="op">+</span> chunksize, <span class="bu">len</span>(X))</span>
<span id="cb195-11"><a href="#cb195-11" aria-hidden="true" tabindex="-1"></a>    partial_data <span class="op">=</span> np.random.rand(end <span class="op">-</span> start, X.shape[<span class="dv">1</span>] , X.shape[<span class="dv">2</span>])</span>
<span id="cb195-12"><a href="#cb195-12" aria-hidden="true" tabindex="-1"></a>    X[start:end] <span class="op">=</span> partial_data</span>
<span id="cb195-13"><a href="#cb195-13" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> end</span>
<span id="cb195-14"><a href="#cb195-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> partial_data</span>
<span id="cb195-15"><a href="#cb195-15" aria-hidden="true" tabindex="-1"></a>    gc.collect()</span>
<span id="cb195-16"><a href="#cb195-16" aria-hidden="true" tabindex="-1"></a>filename <span class="op">=</span> X.filename</span>
<span id="cb195-17"><a href="#cb195-17" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> X</span>
<span id="cb195-18"><a href="#cb195-18" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.load(filename, mmap_mode<span class="op">=</span><span class="st">'r+'</span>)</span>
<span id="cb195-19"><a href="#cb195-19" aria-hidden="true" tabindex="-1"></a>test_eq((X <span class="op">==</span> <span class="dv">0</span>).<span class="bu">sum</span>(), <span class="dv">0</span>)</span>
<span id="cb195-20"><a href="#cb195-20" aria-hidden="true" tabindex="-1"></a>test_eq(X.shape, shape)</span>
<span id="cb195-21"><a href="#cb195-21" aria-hidden="true" tabindex="-1"></a>os.remove(X.filename)</span>
<span id="cb195-22"><a href="#cb195-22" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1074" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="np_load_compressed" class="level3">
<h3 class="anchored" data-anchor-id="np_load_compressed">np_load_compressed</h3>
<blockquote class="blockquote">
<pre><code> np_load_compressed (fname=None, path='./data', **kwargs)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1063" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="np_save_compressed" class="level3">
<h3 class="anchored" data-anchor-id="np_save_compressed">np_save_compressed</h3>
<blockquote class="blockquote">
<pre><code> np_save_compressed (arr, fname=None, path='./data', verbose=False,
                     **kwargs)</code></pre>
</blockquote>
<div id="cell-178" class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>X1 <span class="op">=</span> np.random.rand(<span class="dv">10</span>)</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>np_save_compressed(X1, <span class="st">'X_comp'</span>, path<span class="op">=</span><span class="st">'./data'</span>)</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>X2 <span class="op">=</span> np_load_compressed(<span class="st">'X_comp'</span>)</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>test_eq(X1, X2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1085" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="np2memmap" class="level3">
<h3 class="anchored" data-anchor-id="np2memmap">np2memmap</h3>
<blockquote class="blockquote">
<pre><code> np2memmap (arr, fname=None, path='./data', dtype='float32', mode='c',
            **kwargs)</code></pre>
</blockquote>
<p><em>Function that turns an ndarray into a memmap ndarray mode: ‘r’: Open existing file for reading only. ‘r+’: Open existing file for reading and writing. ‘w+’: Create or overwrite existing file for reading and writing. ‘c’: Copy-on-write: assignments affect data in memory, but changes are not saved to disk. The file on disk is read-only.</em></p>
<div id="cell-180" class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>X1 <span class="op">=</span> np.random.rand(<span class="dv">10</span>)</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>X2 <span class="op">=</span> np2memmap(X1, <span class="st">'X1_test'</span>)</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>test_eq(X1, X2)</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>test_ne(<span class="bu">type</span>(X1), <span class="bu">type</span>(X2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1104" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="torch_mean_groupby" class="level3">
<h3 class="anchored" data-anchor-id="torch_mean_groupby">torch_mean_groupby</h3>
<blockquote class="blockquote">
<pre><code> torch_mean_groupby (o, idxs)</code></pre>
</blockquote>
<p><em>Computes torch mean along axis 0 grouped by the idxs. Need to ensure that idxs have the same order as o</em></p>
<div id="cell-182" class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> torch.arange(<span class="dv">6</span><span class="op">*</span><span class="dv">2</span><span class="op">*</span><span class="dv">3</span>).reshape(<span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">3</span>).<span class="bu">float</span>()</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>idxs <span class="op">=</span> np.array([[<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>], [<span class="dv">2</span>,<span class="dv">3</span>]], dtype<span class="op">=</span><span class="bu">object</span>)</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>output <span class="op">=</span> torch_mean_groupby(o, idxs)</span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>test_eq(o[:<span class="dv">2</span>], output[:<span class="dv">2</span>])</span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>test_eq(o[<span class="dv">2</span>:<span class="dv">4</span>].mean(<span class="dv">0</span>), output[<span class="dv">2</span>])</span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>test_eq(o[<span class="dv">4</span>:<span class="dv">6</span>].mean(<span class="dv">0</span>), output[<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1114" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="torch_flip" class="level3">
<h3 class="anchored" data-anchor-id="torch_flip">torch_flip</h3>
<blockquote class="blockquote">
<pre><code> torch_flip (t, dims=-1)</code></pre>
</blockquote>
<div id="cell-184" class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.randn(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>test_eq(torch.flip(t, (<span class="dv">2</span>,)), torch_flip(t, dims<span class="op">=-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1127" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="torch_masked_to_num" class="level3">
<h3 class="anchored" data-anchor-id="torch_masked_to_num">torch_masked_to_num</h3>
<blockquote class="blockquote">
<pre><code> torch_masked_to_num (o, mask, num=0, inplace=False)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1121" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="torch_nan_to_num" class="level3">
<h3 class="anchored" data-anchor-id="torch_nan_to_num">torch_nan_to_num</h3>
<blockquote class="blockquote">
<pre><code> torch_nan_to_num (o, num=0, inplace=False)</code></pre>
</blockquote>
<div id="cell-187" class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> torch.rand(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>x[:, :<span class="dv">3</span>][x[:, :<span class="dv">3</span>] <span class="op">&lt;</span> <span class="fl">.5</span>] <span class="op">=</span> np.nan</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>nan_values <span class="op">=</span> torch.isnan(x).<span class="bu">sum</span>()</span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> torch_nan_to_num(x[:, :<span class="dv">3</span>], inplace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>test_eq(torch.isnan(y).<span class="bu">sum</span>(), <span class="dv">0</span>)</span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a>test_eq(torch.isnan(x).<span class="bu">sum</span>(), nan_values)</span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>torch_nan_to_num(x[:, :<span class="dv">3</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a>test_eq(torch.isnan(x).<span class="bu">sum</span>(), <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-188" class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> torch.rand(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> x[:, :<span class="dv">3</span>] <span class="op">&gt;</span> <span class="fl">.5</span></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>x[:, :<span class="dv">3</span>] <span class="op">=</span> torch_masked_to_num(x[:, :<span class="dv">3</span>], mask, num<span class="op">=</span><span class="dv">0</span>, inplace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>test_eq(x[:, :<span class="dv">3</span>][mask].<span class="bu">sum</span>(), <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-189" class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> torch.rand(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> x[:, :<span class="dv">3</span>] <span class="op">&gt;</span> <span class="fl">.5</span></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>torch_masked_to_num(x[:, :<span class="dv">3</span>], mask, num<span class="op">=</span><span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>test_eq(x[:, :<span class="dv">3</span>][mask].<span class="bu">sum</span>(), <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1134" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="mpl_trend" class="level3">
<h3 class="anchored" data-anchor-id="mpl_trend">mpl_trend</h3>
<blockquote class="blockquote">
<pre><code> mpl_trend (x, y, deg=1)</code></pre>
</blockquote>
<div id="cell-191" class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.sort(np.random.randint(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">100</span>)<span class="op">/</span><span class="dv">10</span>)</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.random.rand(<span class="dv">100</span>) <span class="op">+</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>trend <span class="op">=</span> mpl_trend(x, y)</span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>plt.scatter(x, y)</span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>plt.plot(x, trend, <span class="st">'r'</span>)</span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="002_utils_files/figure-html/cell-189-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1150" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="array2digits" class="level3">
<h3 class="anchored" data-anchor-id="array2digits">array2digits</h3>
<blockquote class="blockquote">
<pre><code> array2digits (o, n_digits=None, normalize=True)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1138" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="int2digits" class="level3">
<h3 class="anchored" data-anchor-id="int2digits">int2digits</h3>
<blockquote class="blockquote">
<pre><code> int2digits (o, n_digits=None, normalize=True)</code></pre>
</blockquote>
<div id="cell-194" class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> <span class="op">-</span><span class="dv">9645</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>test_eq(int2digits(o, <span class="dv">6</span>), np.array([ <span class="dv">0</span>,  <span class="dv">0</span>, <span class="op">-</span><span class="fl">.9</span>, <span class="op">-</span><span class="fl">.6</span>, <span class="op">-</span><span class="fl">.4</span>, <span class="op">-</span><span class="fl">.5</span>]))</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.randint(<span class="op">-</span><span class="dv">1000</span>, <span class="dv">1000</span>, <span class="dv">10</span>)</span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a>test_eq(array2digits(a,<span class="dv">5</span>).shape, (<span class="dv">10</span>,<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1157" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="sincos_encoding" class="level3">
<h3 class="anchored" data-anchor-id="sincos_encoding">sincos_encoding</h3>
<blockquote class="blockquote">
<pre><code> sincos_encoding (seq_len, device=None, to_np=False)</code></pre>
</blockquote>
<div id="cell-196" class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>sin, cos <span class="op">=</span> sincos_encoding(<span class="dv">100</span>)</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>plt.plot(sin.cpu().numpy())</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>plt.plot(cos.cpu().numpy())</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="002_utils_files/figure-html/cell-194-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1168" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="linear_encoding" class="level3">
<h3 class="anchored" data-anchor-id="linear_encoding">linear_encoding</h3>
<blockquote class="blockquote">
<pre><code> linear_encoding (seq_len, device=None, to_np=False, lin_range=(-1, 1))</code></pre>
</blockquote>
<div id="cell-198" class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>lin <span class="op">=</span> linear_encoding(<span class="dv">100</span>)</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>plt.plot(lin.cpu().numpy())</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="002_utils_files/figure-html/cell-196-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1177" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="encode_positions" class="level3">
<h3 class="anchored" data-anchor-id="encode_positions">encode_positions</h3>
<blockquote class="blockquote">
<pre><code> encode_positions (pos_arr, min_val=None, max_val=None, linear=False,
                   lin_range=(-1, 1))</code></pre>
</blockquote>
<p><em>Encodes an array with positions using a linear or sincos methods</em></p>
<div id="cell-200" class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>_a <span class="op">=</span> []</span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_samples):</span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">4000</span>, <span class="dv">4000</span>, <span class="dv">10</span>)</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>    mask <span class="op">=</span> np.random.rand(<span class="bu">len</span>(a)) <span class="op">&gt;</span> <span class="fl">.5</span></span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> a[mask]</span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> np.concatenate([a, np.array([np.nan] <span class="op">*</span> (length <span class="op">-</span> <span class="bu">len</span>(a)))])</span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a>    _a.append(a.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.concatenate(_a, <span class="op">-</span><span class="dv">1</span>).transpose(<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a>sin, cos <span class="op">=</span> encode_positions(a, linear<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a>test_eq(a.shape, (n_samples, length))</span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true" tabindex="-1"></a>test_eq(sin.shape, (n_samples, length))</span>
<span id="cb220-14"><a href="#cb220-14" aria-hidden="true" tabindex="-1"></a>test_eq(cos.shape, (n_samples, length))</span>
<span id="cb220-15"><a href="#cb220-15" aria-hidden="true" tabindex="-1"></a>plt.plot(sin.T)</span>
<span id="cb220-16"><a href="#cb220-16" aria-hidden="true" tabindex="-1"></a>plt.plot(cos.T)</span>
<span id="cb220-17"><a href="#cb220-17" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="dv">0</span>, <span class="dv">500</span>)</span>
<span id="cb220-18"><a href="#cb220-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="002_utils_files/figure-html/cell-198-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-201" class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>_a <span class="op">=</span> []</span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_samples):</span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">4000</span>, <span class="dv">4000</span>, <span class="dv">10</span>)</span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a>    mask <span class="op">=</span> np.random.rand(<span class="bu">len</span>(a)) <span class="op">&gt;</span> <span class="fl">.5</span></span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> a[mask]</span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> np.concatenate([a, np.array([np.nan] <span class="op">*</span> (length <span class="op">-</span> <span class="bu">len</span>(a)))])</span>
<span id="cb221-9"><a href="#cb221-9" aria-hidden="true" tabindex="-1"></a>    _a.append(a.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb221-10"><a href="#cb221-10" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.concatenate(_a, <span class="op">-</span><span class="dv">1</span>).transpose(<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb221-11"><a href="#cb221-11" aria-hidden="true" tabindex="-1"></a>lin <span class="op">=</span> encode_positions(a, linear<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb221-12"><a href="#cb221-12" aria-hidden="true" tabindex="-1"></a>test_eq(a.shape, (n_samples, length))</span>
<span id="cb221-13"><a href="#cb221-13" aria-hidden="true" tabindex="-1"></a>test_eq(lin.shape, (n_samples, length))</span>
<span id="cb221-14"><a href="#cb221-14" aria-hidden="true" tabindex="-1"></a>plt.plot(lin.T)</span>
<span id="cb221-15"><a href="#cb221-15" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="dv">0</span>, <span class="dv">500</span>)</span>
<span id="cb221-16"><a href="#cb221-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="002_utils_files/figure-html/cell-199-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1194" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="sort_generator" class="level3">
<h3 class="anchored" data-anchor-id="sort_generator">sort_generator</h3>
<blockquote class="blockquote">
<pre><code> sort_generator (generator, bs)</code></pre>
</blockquote>
<div id="cell-203" class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>generator <span class="op">=</span> (i <span class="cf">for</span> i <span class="kw">in</span> np.random.permutation(np.arange(<span class="dv">1000000</span>)).tolist())</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>l <span class="op">=</span> <span class="bu">list</span>(sort_generator(generator, <span class="dv">512</span>))</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>test_eq(l[:<span class="dv">512</span>], <span class="bu">sorted</span>(l[:<span class="dv">512</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1200" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_subset_dict" class="level3">
<h3 class="anchored" data-anchor-id="get_subset_dict">get_subset_dict</h3>
<blockquote class="blockquote">
<pre><code> get_subset_dict (d, keys)</code></pre>
</blockquote>
<div id="cell-205" class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>keys <span class="op">=</span> string.ascii_lowercase</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> np.arange(<span class="bu">len</span>(keys))</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> {k:v <span class="cf">for</span> k,v <span class="kw">in</span> <span class="bu">zip</span>(keys,values)}</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>test_eq(get_subset_dict(d, [<span class="st">'a'</span>, <span class="st">'k'</span>, <span class="st">'j'</span>, <span class="st">'e'</span>]), {<span class="st">'a'</span>: <span class="dv">0</span>, <span class="st">'k'</span>: <span class="dv">10</span>, <span class="st">'j'</span>: <span class="dv">9</span>, <span class="st">'e'</span>: <span class="dv">4</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1216" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="remove_dir" class="level3">
<h3 class="anchored" data-anchor-id="remove_dir">remove_dir</h3>
<blockquote class="blockquote">
<pre><code> remove_dir (directory, verbose=True)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1204" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="create_dir" class="level3">
<h3 class="anchored" data-anchor-id="create_dir">create_dir</h3>
<blockquote class="blockquote">
<pre><code> create_dir (directory, verbose=True)</code></pre>
</blockquote>
<div id="cell-208" class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">"wandb3/wandb2/wandb"</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>create_dir(path)</span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> Path(path).exists()</span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a>paths <span class="op">=</span> [<span class="st">"wandb3/wandb2/wandb"</span>, <span class="st">"wandb3/wandb2"</span>, <span class="st">"wandb"</span>]</span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a>remove_dir(paths)</span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p <span class="kw">in</span> paths:</span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> <span class="kw">not</span> Path(p).exists()</span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">"wandb3"</span></span>
<span id="cb228-11"><a href="#cb228-11" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> Path(path).exists()</span>
<span id="cb228-12"><a href="#cb228-12" aria-hidden="true" tabindex="-1"></a>remove_dir(path)</span>
<span id="cb228-13"><a href="#cb228-13" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="kw">not</span> Path(path).exists()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>wandb3/wandb2/wandb directory created.
wandb3/wandb2/wandb directory removed.
wandb3/wandb2 directory removed.
wandb directory doesn't exist.
wandb3 directory removed.</code></pre>
</div>
</div>
<div id="cell-209" class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>create_dir(<span class="st">'./test'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>test directory created.</code></pre>
</div>
</div>
<div id="cell-210" class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fn(b): <span class="cf">return</span> a <span class="op">+</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Writing ./test/mod_dev.py</code></pre>
</div>
</div>
<div id="cell-211" class="cell">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>fname <span class="op">=</span> <span class="st">"./test/mod_dev.py"</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> fname[<span class="dv">0</span>] <span class="kw">in</span> <span class="st">"/ ."</span>: fname <span class="op">=</span> fname.split(fname[<span class="dv">0</span>], <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>: <span class="cf">break</span></span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'/'</span> <span class="kw">in</span> fname <span class="kw">and</span> fname.rsplit(<span class="st">'/'</span>, <span class="dv">1</span>)[<span class="dv">0</span>] <span class="kw">not</span> <span class="kw">in</span> sys.path: sys.path.append(fname.rsplit(<span class="st">'/'</span>, <span class="dv">1</span>)[<span class="dv">0</span>])</span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>mod <span class="op">=</span> import_file_as_module(fname)</span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a>test_eq(mod.fn(<span class="dv">3</span>), <span class="dv">8</span>)</span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a>sys.path <span class="op">=</span> sys.path[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a>remove_dir(<span class="st">'./test/'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>test directory removed.</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1230" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="named_partial" class="level3">
<h3 class="anchored" data-anchor-id="named_partial">named_partial</h3>
<blockquote class="blockquote">
<pre><code> named_partial (name, func, *args, **kwargs)</code></pre>
</blockquote>
<p><em>Create a partial function with a <strong>name</strong></em></p>
<div id="cell-213" class="cell">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_1(x, add<span class="op">=</span><span class="dv">1</span>): <span class="cf">return</span> x<span class="op">+</span>add</span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>test_eq(add_1(<span class="dv">1</span>), <span class="dv">2</span>)</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>add_2 <span class="op">=</span> partial(add_1, add<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>test_eq(add_2(<span class="dv">2</span>), <span class="dv">4</span>)</span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a>test_ne(<span class="bu">str</span>(add_2), <span class="st">"add_2"</span>)</span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a>add_2 <span class="op">=</span> named_partial(<span class="st">'add_2'</span>, add_1, add<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a>test_eq(add_2(<span class="dv">2</span>), <span class="dv">4</span>)</span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">str</span>(add_2), <span class="st">"add_2"</span>)</span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-10"><a href="#cb237-10" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> _A():</span>
<span id="cb237-11"><a href="#cb237-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, add<span class="op">=</span><span class="dv">1</span>): <span class="va">self</span>.add <span class="op">=</span> add</span>
<span id="cb237-12"><a href="#cb237-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, x): <span class="cf">return</span> x <span class="op">+</span> <span class="va">self</span>.add</span>
<span id="cb237-13"><a href="#cb237-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-14"><a href="#cb237-14" aria-hidden="true" tabindex="-1"></a>test_eq(_A()(<span class="dv">1</span>), <span class="dv">2</span>)</span>
<span id="cb237-15"><a href="#cb237-15" aria-hidden="true" tabindex="-1"></a>_A2 <span class="op">=</span> partial(_A, add<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb237-16"><a href="#cb237-16" aria-hidden="true" tabindex="-1"></a>test_eq(_A2()(<span class="dv">1</span>), <span class="dv">3</span>)</span>
<span id="cb237-17"><a href="#cb237-17" aria-hidden="true" tabindex="-1"></a>test_ne(<span class="bu">str</span>(_A2), <span class="st">'_A2'</span>)</span>
<span id="cb237-18"><a href="#cb237-18" aria-hidden="true" tabindex="-1"></a>_A2 <span class="op">=</span> named_partial(<span class="st">'_A2'</span>, _A, add<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb237-19"><a href="#cb237-19" aria-hidden="true" tabindex="-1"></a>test_eq(_A2()(<span class="dv">1</span>), <span class="dv">3</span>)</span>
<span id="cb237-20"><a href="#cb237-20" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">str</span>(_A2), <span class="st">'_A2'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1255" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="dict2attrdict" class="level3">
<h3 class="anchored" data-anchor-id="dict2attrdict">dict2attrdict</h3>
<blockquote class="blockquote">
<pre><code> dict2attrdict (d:dict)</code></pre>
</blockquote>
<p><em>Converts a (nested) dict to an AttrDict.</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>d</td>
<td>dict</td>
<td>a dict</td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1242" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="attrdict2dict" class="level3">
<h3 class="anchored" data-anchor-id="attrdict2dict">attrdict2dict</h3>
<blockquote class="blockquote">
<pre><code> attrdict2dict (d:dict)</code></pre>
</blockquote>
<p><em>Converts a (nested) AttrDict dict to a dict.</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>d</td>
<td>dict</td>
<td>a dict</td>
</tr>
</tbody>
</table>
<div id="cell-216" class="cell">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test attrdict2dict</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> AttrDict({<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'b'</span>: AttrDict({<span class="st">'c'</span>: <span class="dv">2</span>, <span class="st">'d'</span>: <span class="dv">3</span>})})</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>test_eq(attrdict2dict(d), {<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'b'</span>: {<span class="st">'c'</span>: <span class="dv">2</span>, <span class="st">'d'</span>: <span class="dv">3</span>}})</span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Test dict2attrdict</span></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> {<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'b'</span>: {<span class="st">'c'</span>: <span class="dv">2</span>, <span class="st">'d'</span>: <span class="dv">3</span>}}</span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a>test_eq(dict2attrdict(d), AttrDict({<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'b'</span>: AttrDict({<span class="st">'c'</span>: <span class="dv">2</span>, <span class="st">'d'</span>: <span class="dv">3</span>})}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1297" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_config" class="level3">
<h3 class="anchored" data-anchor-id="get_config">get_config</h3>
<blockquote class="blockquote">
<pre><code> get_config (file_path)</code></pre>
</blockquote>
<p><em>Gets a config from a yaml file.</em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1282" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="yaml2dict" class="level3">
<h3 class="anchored" data-anchor-id="yaml2dict">yaml2dict</h3>
<blockquote class="blockquote">
<pre><code> yaml2dict (file_path, attrdict=True)</code></pre>
</blockquote>
<p><em>Converts a yaml file to a dict (optionally AttrDict).</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>file_path</td>
<td></td>
<td></td>
<td>a path to a yaml file</td>
</tr>
<tr class="even">
<td>attrdict</td>
<td>bool</td>
<td>True</td>
<td>if True, convert output to AttrDict</td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1268" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="dict2yaml" class="level3">
<h3 class="anchored" data-anchor-id="dict2yaml">dict2yaml</h3>
<blockquote class="blockquote">
<pre><code> dict2yaml (d, file_path, sort_keys=False)</code></pre>
</blockquote>
<p><em>Converts a dict to a yaml file.</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>d</td>
<td></td>
<td></td>
<td>a dict</td>
</tr>
<tr class="even">
<td>file_path</td>
<td></td>
<td></td>
<td>a path to a yaml file</td>
</tr>
<tr class="odd">
<td>sort_keys</td>
<td>bool</td>
<td>False</td>
<td>if True, sort the keys</td>
</tr>
</tbody>
</table>
<div id="cell-220" class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>program: wandb_scripts<span class="op">/</span>train_script.py          <span class="co"># (required) Path to training script.</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>method: bayes                                   <span class="co"># (required) Specify the search strategy: grid, random or bayes</span></span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>parameters:                                     <span class="co"># (required) Specify parameters bounds to search.</span></span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a>   bs:</span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a>      values: [<span class="dv">32</span>, <span class="dv">64</span>, <span class="dv">128</span>]</span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a>   depth:</span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a>      values: [<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>]</span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a>   fc_dropout:</span>
<span id="cb244-9"><a href="#cb244-9" aria-hidden="true" tabindex="-1"></a>      distribution: uniform</span>
<span id="cb244-10"><a href="#cb244-10" aria-hidden="true" tabindex="-1"></a>      <span class="bu">min</span>: <span class="fl">0.</span></span>
<span id="cb244-11"><a href="#cb244-11" aria-hidden="true" tabindex="-1"></a>      <span class="bu">max</span>: <span class="fl">0.5</span></span>
<span id="cb244-12"><a href="#cb244-12" aria-hidden="true" tabindex="-1"></a>   lr_max:</span>
<span id="cb244-13"><a href="#cb244-13" aria-hidden="true" tabindex="-1"></a>      values: [<span class="fl">0.001</span>, <span class="fl">0.003</span>, <span class="fl">0.01</span>, <span class="fl">0.03</span>, <span class="fl">0.1</span>]</span>
<span id="cb244-14"><a href="#cb244-14" aria-hidden="true" tabindex="-1"></a>   n_epoch:</span>
<span id="cb244-15"><a href="#cb244-15" aria-hidden="true" tabindex="-1"></a>      values: [<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>]</span>
<span id="cb244-16"><a href="#cb244-16" aria-hidden="true" tabindex="-1"></a>   nb_filters:</span>
<span id="cb244-17"><a href="#cb244-17" aria-hidden="true" tabindex="-1"></a>      values: [<span class="dv">32</span>, <span class="dv">64</span>, <span class="dv">128</span>]</span>
<span id="cb244-18"><a href="#cb244-18" aria-hidden="true" tabindex="-1"></a>name: LSST_sweep_01</span>
<span id="cb244-19"><a href="#cb244-19" aria-hidden="true" tabindex="-1"></a>metric:</span>
<span id="cb244-20"><a href="#cb244-20" aria-hidden="true" tabindex="-1"></a>   name: accuracy                              <span class="co"># This must match one of the metrics in the training script</span></span>
<span id="cb244-21"><a href="#cb244-21" aria-hidden="true" tabindex="-1"></a>   goal: maximize</span>
<span id="cb244-22"><a href="#cb244-22" aria-hidden="true" tabindex="-1"></a>early_terminate:</span>
<span id="cb244-23"><a href="#cb244-23" aria-hidden="true" tabindex="-1"></a>   <span class="bu">type</span>: hyperband</span>
<span id="cb244-24"><a href="#cb244-24" aria-hidden="true" tabindex="-1"></a>   min_iter: <span class="dv">3</span></span>
<span id="cb244-25"><a href="#cb244-25" aria-hidden="true" tabindex="-1"></a>project: LSST_wandb_hpo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Writing sweep_config.yaml</code></pre>
</div>
</div>
<div id="cell-221" class="cell">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>fname <span class="op">=</span> <span class="st">"sweep_config.yaml"</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>sweep_config <span class="op">=</span> yaml2dict(fname)</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sweep_config)</span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a>test_eq(sweep_config.method, <span class="st">'bayes'</span>)</span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a>test_eq(sweep_config[<span class="st">'metric'</span>], {<span class="st">'name'</span>: <span class="st">'accuracy'</span>, <span class="st">'goal'</span>: <span class="st">'maximize'</span>})</span>
<span id="cb246-6"><a href="#cb246-6" aria-hidden="true" tabindex="-1"></a>os.remove(fname)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'program': 'wandb_scripts/train_script.py', 'method': 'bayes', 'parameters': {'bs': {'values': [32, 64, 128]}, 'depth': {'values': [3, 6, 9, 12]}, 'fc_dropout': {'distribution': 'uniform', 'min': 0.0, 'max': 0.5}, 'lr_max': {'values': [0.001, 0.003, 0.01, 0.03, 0.1]}, 'n_epoch': {'values': [10, 15, 20]}, 'nb_filters': {'values': [32, 64, 128]}}, 'name': 'LSST_sweep_01', 'metric': {'name': 'accuracy', 'goal': 'maximize'}, 'early_terminate': {'type': 'hyperband', 'min_iter': 3}, 'project': 'LSST_wandb_hpo'}</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1324" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_cat_cols" class="level3">
<h3 class="anchored" data-anchor-id="get_cat_cols">get_cat_cols</h3>
<blockquote class="blockquote">
<pre><code> get_cat_cols (df)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1321" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_cont_cols" class="level3">
<h3 class="anchored" data-anchor-id="get_cont_cols">get_cont_cols</h3>
<blockquote class="blockquote">
<pre><code> get_cont_cols (df)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1315" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="str2index" class="level3">
<h3 class="anchored" data-anchor-id="str2index">str2index</h3>
<blockquote class="blockquote">
<pre><code> str2index (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1308" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="str2list" class="level3">
<h3 class="anchored" data-anchor-id="str2list">str2list</h3>
<blockquote class="blockquote">
<pre><code> str2list (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1341" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="map_array" class="level3">
<h3 class="anchored" data-anchor-id="map_array">map_array</h3>
<blockquote class="blockquote">
<pre><code> map_array (arr, dim=1)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1334" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_mapping" class="level3">
<h3 class="anchored" data-anchor-id="get_mapping">get_mapping</h3>
<blockquote class="blockquote">
<pre><code> get_mapping (arr, dim=1, return_counts=False)</code></pre>
</blockquote>
<div id="cell-228" class="cell">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.asarray(alphabet[np.random.randint(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">30</span>)]).reshape(<span class="dv">10</span>,<span class="dv">3</span>)</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.asarray(ALPHABET[np.random.randint(<span class="dv">6</span>,<span class="dv">10</span>,<span class="dv">30</span>)]).reshape(<span class="dv">10</span>,<span class="dv">3</span>)</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> concat(a,b,dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>maps, counts <span class="op">=</span> get_mapping(x, dim<span class="op">=</span><span class="dv">1</span>, return_counts<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>x, maps, counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(array([['d', 'k', 'l', 'I', 'I', 'G'],
        ['g', 'i', 'l', 'I', 'J', 'I'],
        ['e', 'l', 'n', 'G', 'H', 'I'],
        ['e', 'l', 'a', 'I', 'H', 'G'],
        ['k', 'l', 'b', 'I', 'I', 'J'],
        ['c', 'f', 'k', 'I', 'H', 'I'],
        ['e', 'j', 'f', 'I', 'H', 'J'],
        ['n', 'd', 'g', 'G', 'J', 'J'],
        ['d', 'f', 'a', 'I', 'H', 'H'],
        ['i', 'c', 'm', 'J', 'G', 'G']], dtype='&lt;U1'),
 [(#7) ['c','d','e','g','i','k','n'],
  (#7) ['c','d','f','i','j','k','l'],
  (#8) ['a','b','f','g','k','l','m','n'],
  (#3) ['G','I','J'],
  (#4) ['G','H','I','J'],
  (#4) ['G','H','I','J']],
 [7, 7, 8, 3, 4, 4])</code></pre>
</div>
</div>
<div id="cell-229" class="cell">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.asarray(alphabet[np.random.randint(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">30</span>)]).reshape(<span class="dv">10</span>,<span class="dv">3</span>)</span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>x, map_array(x), map_array(x, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(array([['i', 'm', 'd'],
        ['h', 'm', 'g'],
        ['i', 'g', 'd'],
        ['k', 'm', 'n'],
        ['n', 'j', 'l'],
        ['n', 'l', 'i'],
        ['f', 'c', 'k'],
        ['i', 'm', 'a'],
        ['l', 'i', 'f'],
        ['k', 'o', 'g']], dtype='&lt;U1'),
 array([[2, 5, 1],
        [1, 5, 3],
        [2, 1, 1],
        [3, 5, 7],
        [5, 3, 6],
        [5, 4, 4],
        [0, 0, 5],
        [2, 5, 0],
        [4, 2, 2],
        [3, 6, 3]]),
 array([[2, 5, 1],
        [1, 5, 3],
        [2, 1, 1],
        [3, 5, 7],
        [5, 3, 6],
        [5, 4, 4],
        [0, 0, 5],
        [2, 5, 0],
        [4, 2, 2],
        [3, 6, 3]]))</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1347" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="log_tfm" class="level3">
<h3 class="anchored" data-anchor-id="log_tfm">log_tfm</h3>
<blockquote class="blockquote">
<pre><code> log_tfm (o, inplace=False)</code></pre>
</blockquote>
<p><em>Log transforms an array-like object with positive and/or negative values</em></p>
<div id="cell-231" class="cell">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.asarray([<span class="op">-</span><span class="dv">1000</span>, <span class="op">-</span><span class="dv">100</span>, <span class="op">-</span><span class="dv">10</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>]).astype(<span class="bu">float</span>)</span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a>plt.plot(arr, log_tfm(arr, <span class="va">False</span>))</span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="002_utils_files/figure-html/cell-229-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-232" class="cell">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> tensor([<span class="op">-</span><span class="dv">1000</span>, <span class="op">-</span><span class="dv">100</span>, <span class="op">-</span><span class="dv">10</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>]).<span class="bu">float</span>()</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>plt.plot(t, log_tfm(t, <span class="va">False</span>))</span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="002_utils_files/figure-html/cell-230-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1367" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to_sincos_time" class="level3">
<h3 class="anchored" data-anchor-id="to_sincos_time">to_sincos_time</h3>
<blockquote class="blockquote">
<pre><code> to_sincos_time (arr, max_value)</code></pre>
</blockquote>
<div id="cell-234" class="cell">
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.sort(np.random.rand(<span class="dv">100</span>) <span class="op">*</span> <span class="dv">5</span>)</span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>arr_sin, arr_cos <span class="op">=</span> to_sincos_time(arr, <span class="dv">5</span>)</span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>plt.scatter(arr, arr_sin)</span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a>plt.scatter(arr, arr_cos)</span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="002_utils_files/figure-html/cell-232-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1373" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_feature_dist" class="level3">
<h3 class="anchored" data-anchor-id="plot_feature_dist">plot_feature_dist</h3>
<blockquote class="blockquote">
<pre><code> plot_feature_dist (X, percentiles=[0, 0.1, 0.5, 1, 5, 10, 25, 50, 75, 90,
                    95, 99, 99.5, 99.9, 100])</code></pre>
</blockquote>
<div id="cell-236" class="cell">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.random.rand(<span class="dv">10</span>, <span class="dv">3</span>, <span class="dv">100</span>)</span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>plot_feature_dist(arr, percentiles<span class="op">=</span>[<span class="dv">0</span>,<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">90</span>,<span class="dv">95</span>,<span class="dv">99</span>,<span class="fl">99.5</span>,<span class="fl">99.9</span>,<span class="dv">100</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="002_utils_files/figure-html/cell-234-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="002_utils_files/figure-html/cell-234-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="002_utils_files/figure-html/cell-234-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1385" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="rolling_moving_average" class="level3">
<h3 class="anchored" data-anchor-id="rolling_moving_average">rolling_moving_average</h3>
<blockquote class="blockquote">
<pre><code> rolling_moving_average (o, window=2)</code></pre>
</blockquote>
<div id="cell-238" class="cell">
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.arange(<span class="dv">60</span>).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">10</span>).astype(<span class="bu">float</span>)</span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.arange(<span class="dv">60</span>).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">10</span>).<span class="bu">float</span>()</span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a>test_close(rolling_moving_average(a, window<span class="op">=</span><span class="dv">3</span>), rolling_moving_average(t, window<span class="op">=</span><span class="dv">3</span>).numpy())</span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(t)</span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(rolling_moving_average(t, window<span class="op">=</span><span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor([[[ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9.],
         [10., 11., 12., 13., 14., 15., 16., 17., 18., 19.],
         [20., 21., 22., 23., 24., 25., 26., 27., 28., 29.]],

        [[30., 31., 32., 33., 34., 35., 36., 37., 38., 39.],
         [40., 41., 42., 43., 44., 45., 46., 47., 48., 49.],
         [50., 51., 52., 53., 54., 55., 56., 57., 58., 59.]]])
tensor([[[ 0.0000,  0.5000,  1.0000,  2.0000,  3.0000,  4.0000,  5.0000,
           6.0000,  7.0000,  8.0000],
         [10.0000, 10.5000, 11.0000, 12.0000, 13.0000, 14.0000, 15.0000,
          16.0000, 17.0000, 18.0000],
         [20.0000, 20.5000, 21.0000, 22.0000, 23.0000, 24.0000, 25.0000,
          26.0000, 27.0000, 28.0000]],

        [[30.0000, 30.5000, 31.0000, 32.0000, 33.0000, 34.0000, 35.0000,
          36.0000, 37.0000, 38.0000],
         [40.0000, 40.5000, 41.0000, 42.0000, 43.0000, 44.0000, 45.0000,
          46.0000, 47.0000, 48.0000],
         [50.0000, 50.5000, 51.0000, 52.0000, 53.0000, 54.0000, 55.0000,
          56.0000, 57.0000, 58.0000]]])</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1422" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="fbfill_sequence" class="level3">
<h3 class="anchored" data-anchor-id="fbfill_sequence">fbfill_sequence</h3>
<blockquote class="blockquote">
<pre><code> fbfill_sequence (o)</code></pre>
</blockquote>
<p><em>Forward and backward fills an array-like object alongside sequence dimension</em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1411" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="bfill_sequence" class="level3">
<h3 class="anchored" data-anchor-id="bfill_sequence">bfill_sequence</h3>
<blockquote class="blockquote">
<pre><code> bfill_sequence (o)</code></pre>
</blockquote>
<p><em>Backward fills an array-like object alongside sequence dimension</em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1398" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="ffill_sequence" class="level3">
<h3 class="anchored" data-anchor-id="ffill_sequence">ffill_sequence</h3>
<blockquote class="blockquote">
<pre><code> ffill_sequence (o)</code></pre>
</blockquote>
<p><em>Forward fills an array-like object alongside sequence dimension</em></p>
<div id="cell-242" class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.arange(<span class="dv">80</span>).reshape(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">10</span>).astype(<span class="bu">float</span>)</span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> np.random.rand(<span class="op">*</span>a.shape)</span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>a[mask <span class="op">&gt;</span> <span class="fl">.8</span>] <span class="op">=</span> np.nan</span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.from_numpy(a)</span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>tensor([[[ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8., nan],
         [10., 11., nan, nan, 14., 15., nan, 17., nan, 19.],
         [20., 21., 22., 23., nan, 25., 26., 27., 28., 29.],
         [30., 31., 32., 33., nan, 35., 36., 37., 38., 39.]],

        [[40., 41., 42., 43., 44., 45., 46., 47., nan, 49.],
         [nan, 51., nan, 53., 54., 55., nan, 57., 58., 59.],
         [60., 61., 62., 63., 64., nan, nan, 67., 68., 69.],
         [70., nan, 72., 73., 74., 75., 76., nan, 78., 79.]]],
       dtype=torch.float64)</code></pre>
</div>
</div>
<div id="cell-243" class="cell">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co"># forward fill</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>filled_a <span class="op">=</span> ffill_sequence(a)</span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(filled_a)</span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> np.isnan(filled_a)</span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a>test_eq(filled_a[<span class="op">~</span>m], ffill_sequence(t).numpy()[<span class="op">~</span>m])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[[ 0.  1.  2.  3.  4.  5.  6.  7.  8.  8.]
  [10. 11. 11. 11. 14. 15. 15. 17. 17. 19.]
  [20. 21. 22. 23. 23. 25. 26. 27. 28. 29.]
  [30. 31. 32. 33. 33. 35. 36. 37. 38. 39.]]

 [[40. 41. 42. 43. 44. 45. 46. 47. 47. 49.]
  [nan 51. 51. 53. 54. 55. 55. 57. 58. 59.]
  [60. 61. 62. 63. 64. 64. 64. 67. 68. 69.]
  [70. 70. 72. 73. 74. 75. 76. 76. 78. 79.]]]</code></pre>
</div>
</div>
<div id="cell-244" class="cell">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="co"># backward fill</span></span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>filled_a <span class="op">=</span> bfill_sequence(a)</span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(filled_a)</span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> np.isnan(filled_a)</span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a>test_eq(filled_a[<span class="op">~</span>m], bfill_sequence(t).numpy()[<span class="op">~</span>m])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[[ 0.  1.  2.  3.  4.  5.  6.  7.  8. nan]
  [10. 11. 14. 14. 14. 15. 17. 17. 19. 19.]
  [20. 21. 22. 23. 25. 25. 26. 27. 28. 29.]
  [30. 31. 32. 33. 35. 35. 36. 37. 38. 39.]]

 [[40. 41. 42. 43. 44. 45. 46. 47. 49. 49.]
  [51. 51. 53. 53. 54. 55. 57. 57. 58. 59.]
  [60. 61. 62. 63. 64. 67. 67. 67. 68. 69.]
  [70. 72. 72. 73. 74. 75. 76. 78. 78. 79.]]]</code></pre>
</div>
</div>
<div id="cell-245" class="cell">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="co"># forward &amp; backward fill</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>filled_a <span class="op">=</span> fbfill_sequence(a)</span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(filled_a)</span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> np.isnan(filled_a)</span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true" tabindex="-1"></a>test_eq(filled_a[<span class="op">~</span>m], fbfill_sequence(t).numpy()[<span class="op">~</span>m])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[[ 0.  1.  2.  3.  4.  5.  6.  7.  8.  8.]
  [10. 11. 11. 11. 14. 15. 15. 17. 17. 19.]
  [20. 21. 22. 23. 23. 25. 26. 27. 28. 29.]
  [30. 31. 32. 33. 33. 35. 36. 37. 38. 39.]]

 [[40. 41. 42. 43. 44. 45. 46. 47. 47. 49.]
  [51. 51. 51. 53. 54. 55. 55. 57. 58. 59.]
  [60. 61. 62. 63. 64. 64. 64. 67. 68. 69.]
  [70. 70. 72. 73. 74. 75. 76. 76. 78. 79.]]]</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1429" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="dummify" class="level3">
<h3 class="anchored" data-anchor-id="dummify">dummify</h3>
<blockquote class="blockquote">
<pre><code> dummify (o:Union[numpy.ndarray,torch.Tensor], by_var:bool=True,
          inplace:bool=False, skip:Optional[list]=None, random_state=None)</code></pre>
</blockquote>
<p><em>Shuffles an array-like object along all dimensions or dimension 1 (variables) if by_var is True.</em></p>
<div id="cell-247" class="cell">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.random.rand(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">10</span>)</span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>arr_original <span class="op">=</span> arr.copy()</span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a>dummy_arr <span class="op">=</span> dummify(arr)</span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a>test_ne(arr_original, dummy_arr)</span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a>test_eq(arr_original, arr)</span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a>dummify(arr, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb280-7"><a href="#cb280-7" aria-hidden="true" tabindex="-1"></a>test_ne(arr_original, arr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
<div id="cell-248" class="cell">
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.rand(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">10</span>)</span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a>t_original <span class="op">=</span> t.clone()</span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a>dummy_t <span class="op">=</span> dummify(t)</span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a>test_ne(t_original, dummy_t)</span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a>test_eq(t_original, t)</span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a>dummify(t, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb281-7"><a href="#cb281-7" aria-hidden="true" tabindex="-1"></a>test_ne(t_original, t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1445" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="shuffle_along_axis" class="level3">
<h3 class="anchored" data-anchor-id="shuffle_along_axis">shuffle_along_axis</h3>
<blockquote class="blockquote">
<pre><code> shuffle_along_axis (o, axis=-1, random_state=None)</code></pre>
</blockquote>
<div id="cell-250" class="cell">
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.arange(<span class="dv">60</span>).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">10</span>) <span class="op">+</span> <span class="dv">10</span></span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a>X_shuffled <span class="op">=</span> shuffle_along_axis(X,(<span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>), random_state<span class="op">=</span><span class="dv">23</span>)</span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a>test_eq(X_shuffled, np.array([[[<span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">41</span>, <span class="dv">14</span>, <span class="dv">40</span>, <span class="dv">49</span>, <span class="dv">18</span>, <span class="dv">42</span>, <span class="dv">47</span>, <span class="dv">46</span>],</span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a>                               [<span class="dv">28</span>, <span class="dv">56</span>, <span class="dv">53</span>, <span class="dv">50</span>, <span class="dv">52</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">57</span>, <span class="dv">51</span>, <span class="dv">59</span>],</span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true" tabindex="-1"></a>                               [<span class="dv">34</span>, <span class="dv">30</span>, <span class="dv">38</span>, <span class="dv">35</span>, <span class="dv">69</span>, <span class="dv">66</span>, <span class="dv">63</span>, <span class="dv">67</span>, <span class="dv">61</span>, <span class="dv">62</span>]],</span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-7"><a href="#cb283-7" aria-hidden="true" tabindex="-1"></a>                              [[<span class="dv">19</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">16</span>, <span class="dv">43</span>, <span class="dv">12</span>, <span class="dv">17</span>, <span class="dv">48</span>, <span class="dv">45</span>, <span class="dv">44</span>],</span>
<span id="cb283-8"><a href="#cb283-8" aria-hidden="true" tabindex="-1"></a>                               [<span class="dv">23</span>, <span class="dv">20</span>, <span class="dv">26</span>, <span class="dv">22</span>, <span class="dv">21</span>, <span class="dv">27</span>, <span class="dv">58</span>, <span class="dv">29</span>, <span class="dv">54</span>, <span class="dv">55</span>],</span>
<span id="cb283-9"><a href="#cb283-9" aria-hidden="true" tabindex="-1"></a>                               [<span class="dv">36</span>, <span class="dv">31</span>, <span class="dv">39</span>, <span class="dv">60</span>, <span class="dv">33</span>, <span class="dv">68</span>, <span class="dv">37</span>, <span class="dv">32</span>, <span class="dv">65</span>, <span class="dv">64</span>]]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1481" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="analyze_array" class="level3">
<h3 class="anchored" data-anchor-id="analyze_array">analyze_array</h3>
<blockquote class="blockquote">
<pre><code> analyze_array (o, bins=100, density=False, feature_names=None,
                clip_outliers_plot=False, quantile_range=(25.0, 75.0),
                percentiles=[1, 25, 50, 75, 99], text_len=12, figsize=(10,
                6))</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1454" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="analyze_feature" class="level3">
<h3 class="anchored" data-anchor-id="analyze_feature">analyze_feature</h3>
<blockquote class="blockquote">
<pre><code> analyze_feature (feature, bins=100, density=False, feature_name=None,
                  clip_outliers_plot=False, quantile_range=(25.0, 75.0),
                  percentiles=[1, 25, 50, 75, 99], text_len=12,
                  figsize=(10, 6))</code></pre>
</blockquote>
<div id="cell-253" class="cell">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.random.normal(size<span class="op">=</span>(<span class="dv">1000</span>))</span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a>analyze_array(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> array shape: (1000,)
       dtype: float64
  nan values: 0.0%
         max: 3.581094060980321
           1: -2.1615590829115185
          25: -0.5910961139851849
          50: -0.002247946765973052
          75: 0.6259274030927355
          99: 2.3412961380708084
         min: -2.9413736207935037
 outlier min: -2.416631389602066
 outlier max: 2.4514626787096163
    outliers: 1.3%
        mean: 0.0252125277963861
         std: 0.946955486669799
 normal dist: True</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="002_utils_files/figure-html/cell-251-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-254" class="cell">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> np.random.normal(size<span class="op">=</span>(<span class="dv">1000</span>,<span class="dv">2</span>))</span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> np.random.normal(<span class="dv">3</span>, <span class="dv">5</span>, size<span class="op">=</span>(<span class="dv">1000</span>,<span class="dv">2</span>))</span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x1 <span class="op">+</span> x2</span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a>analyze_array(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> array shape: (1000, 2)

  0  feature: 0

       dtype: float64
  nan values: 0.0%
         max: 20.323075761234193
           1: -8.260661592413742
          25: -0.6268118569038604
          50: 2.7491159998190335
          75: 6.1659732833324234
          99: 15.387037197243288
         min: -13.122296090020368
 outlier min: -10.815989567258287
 outlier max: 16.35515099368685
    outliers: 0.9%
        mean: 2.9347218553275445
         std: 5.134940196769919
 normal dist: True</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="002_utils_files/figure-html/cell-252-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
  1  feature: 1

       dtype: float64
  nan values: 0.0%
         max: 19.86661808715871
           1: -8.727124941895372
          25: -0.45908489661153007
          50: 2.875134866985423
          75: 6.288434737224429
          99: 14.424046274543118
         min: -10.963913297285615
 outlier min: -10.58036434736547
 outlier max: 16.409714187978366
    outliers: 0.6%
        mean: 2.9552584127690014
         std: 4.99683092772426
 normal dist: True</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="002_utils_files/figure-html/cell-252-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1495" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_relpath" class="level3">
<h3 class="anchored" data-anchor-id="get_relpath">get_relpath</h3>
<blockquote class="blockquote">
<pre><code> get_relpath (path)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1513" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to_root_path" class="level3">
<h3 class="anchored" data-anchor-id="to_root_path">to_root_path</h3>
<blockquote class="blockquote">
<pre><code> to_root_path (path)</code></pre>
</blockquote>
<p><em>Converts a path to an absolute path from the root directory of the repository.</em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1506" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_root" class="level3">
<h3 class="anchored" data-anchor-id="get_root">get_root</h3>
<blockquote class="blockquote">
<pre><code> get_root ()</code></pre>
</blockquote>
<p><em>Returns the root directory of the git repository.</em></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1524" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="split_in_chunks" class="level3">
<h3 class="anchored" data-anchor-id="split_in_chunks">split_in_chunks</h3>
<blockquote class="blockquote">
<pre><code> split_in_chunks (o, chunksize, start=0, shuffle=False, drop_last=False)</code></pre>
</blockquote>
<div id="cell-259" class="cell">
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.arange(<span class="dv">5</span>, <span class="dv">15</span>)</span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a>test_eq(split_in_chunks(a, <span class="dv">3</span>, drop_last<span class="op">=</span><span class="va">False</span>), [array([<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>]), array([ <span class="dv">8</span>,  <span class="dv">9</span>, <span class="dv">10</span>]), array([<span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>]), array([<span class="dv">14</span>])])</span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a>test_eq(split_in_chunks(a, <span class="dv">3</span>, drop_last<span class="op">=</span><span class="va">True</span>), [array([<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>]), array([ <span class="dv">8</span>,  <span class="dv">9</span>, <span class="dv">10</span>]), array([<span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>])])</span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true" tabindex="-1"></a>test_eq(split_in_chunks(a, <span class="dv">3</span>, start<span class="op">=</span><span class="dv">2</span>, drop_last<span class="op">=</span><span class="va">True</span>), [array([<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]), array([<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>])])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1541" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="load_object" class="level3">
<h3 class="anchored" data-anchor-id="load_object">load_object</h3>
<blockquote class="blockquote">
<pre><code> load_object (file_path)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1533" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="save_object" class="level3">
<h3 class="anchored" data-anchor-id="save_object">save_object</h3>
<blockquote class="blockquote">
<pre><code> save_object (o, file_path, verbose=True)</code></pre>
</blockquote>
<div id="cell-262" class="cell">
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a>split <span class="op">=</span> np.arange(<span class="dv">100</span>)</span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a>save_object(split, file_path<span class="op">=</span><span class="st">'data/test'</span>)</span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a>split2 <span class="op">=</span> load_object(<span class="st">'data/test.pkl'</span>)</span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a>test_eq(split, split2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>data directory already exists.
ndarray saved as data/test.pkl</code></pre>
</div>
</div>
<div id="cell-263" class="cell">
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a>splits <span class="op">=</span> L([[[<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>], [<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>]],[[<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>], [<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">19</span>]]])</span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a>save_object(splits, file_path<span class="op">=</span>Path(<span class="st">'data/test'</span>))</span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a>splits2 <span class="op">=</span> load_object(<span class="st">'data/test'</span>)</span>
<span id="cb300-4"><a href="#cb300-4" aria-hidden="true" tabindex="-1"></a>test_eq(splits, splits2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>data directory already exists.
L saved as data/test.pkl</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1548" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_idxs_to_keep" class="level3">
<h3 class="anchored" data-anchor-id="get_idxs_to_keep">get_idxs_to_keep</h3>
<blockquote class="blockquote">
<pre><code> get_idxs_to_keep (o, cond, crit='all', invert=False, axis=(1, 2),
                   keepdims=False)</code></pre>
</blockquote>
<div id="cell-265" class="cell">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">100</span>, <span class="dv">2</span>, <span class="dv">10</span>)</span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>a[a <span class="op">&gt;</span> <span class="fl">.95</span>] <span class="op">=</span> np.nan</span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a>idxs_to_keep <span class="op">=</span> get_idxs_to_keep(a, np.isfinite)</span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> idxs_to_keep.size<span class="op">&gt;</span><span class="dv">0</span>:</span>
<span id="cb303-5"><a href="#cb303-5" aria-hidden="true" tabindex="-1"></a>    test_eq(np.isnan(a[idxs_to_keep]).<span class="bu">sum</span>(), <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1568" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="zerofy" class="level3">
<h3 class="anchored" data-anchor-id="zerofy">zerofy</h3>
<blockquote class="blockquote">
<pre><code> zerofy (a, stride, keep=False)</code></pre>
</blockquote>
<p><em>Create copies of an array setting individual/ group values to zero</em></p>
<div id="cell-267" class="cell">
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>stride <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.arange(<span class="dv">2</span><span class="op">*</span><span class="dv">5</span>).reshape(<span class="dv">2</span>,<span class="dv">5</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true" tabindex="-1"></a>zerofy(a, stride, keep<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[[ 0.,  0.,  3.,  4.,  5.],
        [ 6.,  7.,  8.,  9., 10.]],

       [[ 1.,  2.,  0.,  0.,  0.],
        [ 6.,  7.,  8.,  9., 10.]],

       [[ 1.,  2.,  3.,  4.,  5.],
        [ 0.,  0.,  8.,  9., 10.]],

       [[ 1.,  2.,  3.,  4.,  5.],
        [ 6.,  7.,  0.,  0.,  0.]]])</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1590" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="feat2list" class="level3">
<h3 class="anchored" data-anchor-id="feat2list">feat2list</h3>
<blockquote class="blockquote">
<pre><code> feat2list (o)</code></pre>
</blockquote>
<div id="cell-269" class="cell">
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="st">'a'</span></span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a>test_eq(feat2list(a), [<span class="st">'a'</span>])</span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> [<span class="st">'a'</span>, <span class="st">'b'</span>]</span>
<span id="cb308-4"><a href="#cb308-4" aria-hidden="true" tabindex="-1"></a>test_eq(feat2list(a), [<span class="st">'a'</span>, <span class="st">'b'</span>])</span>
<span id="cb308-5"><a href="#cb308-5" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="va">None</span></span>
<span id="cb308-6"><a href="#cb308-6" aria-hidden="true" tabindex="-1"></a>test_eq(feat2list(a), [])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1596" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="smallest_dtype" class="level3">
<h3 class="anchored" data-anchor-id="smallest_dtype">smallest_dtype</h3>
<blockquote class="blockquote">
<pre><code> smallest_dtype (num, use_unsigned=False)</code></pre>
</blockquote>
<p><em>Find the smallest dtype that can safely hold <code>num</code></em></p>
<div id="cell-271" class="cell">
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a>test_eq(smallest_dtype(<span class="dv">3654</span>), <span class="st">'int16'</span>)</span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a>test_eq(smallest_dtype(<span class="fl">2048.</span>), <span class="st">'float16'</span>)</span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a>test_eq(smallest_dtype(<span class="dv">365454</span>), <span class="st">'int32'</span>)</span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true" tabindex="-1"></a>test_eq(smallest_dtype(<span class="fl">365454.</span>), <span class="st">'float32'</span>)</span>
<span id="cb310-5"><a href="#cb310-5" aria-hidden="true" tabindex="-1"></a>test_eq(smallest_dtype(<span class="dv">3654545134897</span>), <span class="st">'int64'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1621" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_forecast" class="level3">
<h3 class="anchored" data-anchor-id="plot_forecast">plot_forecast</h3>
<blockquote class="blockquote">
<pre><code> plot_forecast (X_true, y_true, y_pred, sel_vars=None, idx=None,
                figsize=(8, 4), n_samples=1)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1679" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="str2callable" class="level3">
<h3 class="anchored" data-anchor-id="str2callable">str2callable</h3>
<blockquote class="blockquote">
<pre><code> str2callable (object_path:str=None)</code></pre>
</blockquote>
<p><em>Transform a string into a callable object without importing it in the script.</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>object_path</td>
<td>str</td>
<td>None</td>
<td>The string representing the object path.</td>
</tr>
</tbody>
</table>
<div id="cell-274" class="cell">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test showing you don't need to import the object in the script. The library needs to be installed though.</span></span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true" tabindex="-1"></a>    pyts</span>
<span id="cb313-4"><a href="#cb313-4" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb313-5"><a href="#cb313-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="dv">0</span>, e)</span>
<span id="cb313-6"><a href="#cb313-6" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb313-7"><a href="#cb313-7" aria-hidden="true" tabindex="-1"></a>    pyts.image</span>
<span id="cb313-8"><a href="#cb313-8" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb313-9"><a href="#cb313-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="dv">1</span>, e)</span>
<span id="cb313-10"><a href="#cb313-10" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb313-11"><a href="#cb313-11" aria-hidden="true" tabindex="-1"></a>    gasf <span class="op">=</span> <span class="bu">eval</span>(<span class="st">"pyts.image.GramianAngularField(method='summation')"</span>)</span>
<span id="cb313-12"><a href="#cb313-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"2 success: </span><span class="sc">{</span>gasf<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb313-13"><a href="#cb313-13" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb313-14"><a href="#cb313-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="dv">2</span>, e)</span>
<span id="cb313-15"><a href="#cb313-15" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb313-16"><a href="#cb313-16" aria-hidden="true" tabindex="-1"></a>    gasf <span class="op">=</span> str2callable(<span class="st">"pyts.image.GramianAngularField(method='summation')"</span>)</span>
<span id="cb313-17"><a href="#cb313-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"3 success: </span><span class="sc">{</span>gasf<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb313-18"><a href="#cb313-18" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb313-19"><a href="#cb313-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="dv">3</span>, e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0 name 'pyts' is not defined
1 name 'pyts' is not defined
2 name 'pyts' is not defined
3 success: GramianAngularField()</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/timeseriesAI\.github\.io\/tsai\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/timeseriesAI/tsai/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>