<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>TSLearner – tsai</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-2c2b2e643518224cf2d75a643cacf640.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="TSLearner – tsai">
<meta property="og:description" content="Practical Deep Learning for Time Series / Sequential Data library based on fastai &amp; Pytorch">
<meta property="og:image" content="https://timeseriesAI.github.io/tsai/022_tslearner_files/figure-html/cell-12-output-2.png">
<meta property="og:site_name" content="tsai">
<meta property="og:image:height" content="104">
<meta property="og:image:width" content="1431">
<meta name="twitter:title" content="TSLearner – tsai">
<meta name="twitter:description" content="Practical Deep Learning for Time Series / Sequential Data library based on fastai &amp; Pytorch">
<meta name="twitter:image" content="https://timeseriesAI.github.io/tsai/022_tslearner_files/figure-html/cell-12-output-2.png">
<meta name="twitter:image-height" content="104">
<meta name="twitter:image-width" content="1431">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">tsai</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/timeseriesAI/tsai"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./learner.html">Training</a></li><li class="breadcrumb-item"><a href="./tslearner.html">TSLearner</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">tsai</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial notebooks</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.core.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Core</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.external.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">External data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.preparation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data preparation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.validation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spliting data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.preprocessing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data preprocessing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.unwindowed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unwindowed datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.transforms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time Series Data Augmentation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.mixed_augmentation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Label-mixing transforms</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.image.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Imaging Time Series</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.features.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Featurizing Time Series</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.tabular.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time Series Tabular Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.metadatasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metadataset</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.layers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Layers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.utils.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model utilities</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">MLPs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.mlp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MLP</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.gmlp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">gMLP</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">RNNs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RNNs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rnnplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RNNPlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rnnattention.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RNNAttention</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tssequencerplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TSSequencerPlus</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">CNNs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.fcn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FCN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.fcnplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FCNPlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.resnet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ResNet</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.resnetplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ResNetPlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.xresnet1d.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">XResNet1d</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.xresnet1dplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">XResNet1dPlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rescnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ResCNN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tcn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TCN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.inceptiontime.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">InceptionTime</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.inceptiontimeplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">InceptionTimePlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.xceptiontime.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">XceptionTime</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.xceptiontimeplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">XceptionTimePlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.omniscalecnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OmniScaleCNN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.xcm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">XCM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.xcmplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">XCMPlus</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Transformers</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.positional_encoders.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Positional encoders</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.transformermodel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TransformerModel</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tst.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TST</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tstplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TSTPlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tsperceiver.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TSPerceiver</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tsitplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TSiT</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.patchtst.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PatchTST</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">ROCKETs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rocket.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ROCKET</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rocket_pytorch.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ROCKET Pytorch</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.minirocket.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MINIROCKET</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.minirocket_pytorch.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MINIROCKET Pytorch</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.minirocketplus_pytorch.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MINIROCKETPlus Pytorch</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.multirocketplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MultiRocketPlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.hydraplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HydraPlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.hydramultirocketplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HydraMultiRocketPlus</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Wavelet-based NNs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.mwdn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">mWDN</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Hybrid models</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rnn_fcn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RNN_FCN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rnn_fcnplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RNN_FCNPlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.transformerrnnplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TransformerRNNPlus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.convtranplus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ConvTranPlus</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Tabular models</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tabmodel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TabModel</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tabtransformer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TabTransformer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.gatedtabtransformer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GatedTabTransformer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tabfusiontransformer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TabFusionTransformer</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">Miscellaneous</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.multiinputnet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MultiInputNet</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.multimodal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multimodal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.misc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Miscellaneous</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true">
 <span class="menu-text">Training</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./learner.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learner</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tslearner.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">TSLearner</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./optimizer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optimizers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./losses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Losses</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./metrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metrics</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false">
 <span class="menu-text">Callbacks</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.core.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Callback</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.predictiondynamics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PredictionDynamics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.noisy_student.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Noisy student</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.mvp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MVP (aka TSBERT)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.experimental.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimental Callbacks</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./calibration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calibration</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="true">
 <span class="menu-text">HPO &amp; experiment tracking</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./optuna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optuna</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wandb.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Weights &amp; Biases Sweeps</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.explainability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explainability</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./utils.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Utilities</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#tsclassifier-api" id="toc-tsclassifier-api" class="nav-link active" data-scroll-target="#tsclassifier-api">TSClassifier API</a>
  <ul>
  <li><a href="#tsclassifier" id="toc-tsclassifier" class="nav-link" data-scroll-target="#tsclassifier">TSClassifier</a></li>
  </ul></li>
  <li><a href="#tsregressor-api" id="toc-tsregressor-api" class="nav-link" data-scroll-target="#tsregressor-api">TSRegressor API</a>
  <ul>
  <li><a href="#tsregressor" id="toc-tsregressor" class="nav-link" data-scroll-target="#tsregressor">TSRegressor</a></li>
  </ul></li>
  <li><a href="#tsforecaster-api" id="toc-tsforecaster-api" class="nav-link" data-scroll-target="#tsforecaster-api">TSForecaster API</a>
  <ul>
  <li><a href="#tsforecaster" id="toc-tsforecaster" class="nav-link" data-scroll-target="#tsforecaster">TSForecaster</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/timeseriesAI/tsai/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./learner.html">Training</a></li><li class="breadcrumb-item"><a href="./tslearner.html">TSLearner</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">TSLearner</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<p>New set of time series learners with a new sklearn-like API that simplifies the learner creation. The following classes are included:</p>
<ul>
<li>TSClassifier</li>
<li>TSRegressor</li>
<li>TSForecaster</li>
</ul>
<section id="tsclassifier-api" class="level2">
<h2 class="anchored" data-anchor-id="tsclassifier-api">TSClassifier API</h2>
<hr>
<p><strong>Commonly used arguments:</strong></p>
<ul>
<li><strong>X:</strong> array-like of shape (n_samples, n_steps) or (n_samples, n_features, n_steps) with the input time series samples. Internally, they will be converted to torch tensors.</li>
<li><strong>y:</strong> array-like of shape (n_samples), (n_samples, n_outputs) or (n_samples, n_features, n_outputs) with the target. Internally, they will be converted to torch tensors. Default=None. None is used for unlabeled datasets.</li>
<li><strong>splits:</strong> lists of indices used to split data between train and validation. Default=None. If no splits are passed, data will be split 100:0 between train and test without shuffling.</li>
<li><strong>tfms:</strong> item transforms that will be applied to each sample individually. Default:None.</li>
<li><strong>batch_tfms:</strong> transforms applied to each batch. Default=None.</li>
<li><strong>pipelines:</strong> store sklearn-type pipelines that can then be applied to pandas dataframes with transform or inverse_transform methods. Default=None.</li>
<li><strong>bs:</strong> batch size (if batch_size is provided then batch_size will override bs). An int or a list of ints can be passed. Default=<code>[64, 128]</code>. If a list of ints, the first one will be used for training, and the second for the valid (batch size can be larger as it doesn’t require backpropagation which consumes more memory).</li>
<li><strong>arch:</strong> indicates which architecture will be used. Alternatively, you can pass an instantiated model. Default: InceptionTimePlus.</li>
<li><strong>arch_config:</strong> keyword arguments passed to the selected architecture. Default={}.</li>
<li><strong>pretrained:</strong> indicates if pretrained model weights will be used. Default=False.</li>
<li><strong>weights_path:</strong> indicates the path to the pretrained weights in case they are used.</li>
<li><strong>loss_func:</strong> allows you to pass any loss function. Default=None (in which case CrossEntropyLossFlat() is applied).</li>
<li><strong>opt_func:</strong> allows you to pass an optimizer. Default=Adam.</li>
<li><strong>lr:</strong> learning rate. Default=0.001.</li>
<li><strong>metrics:</strong> list of metrics passed to the Learner. Default=accuracy.</li>
<li><strong>cbs:</strong> list of callbacks passed to the Learner. Default=None.</li>
<li><strong>wd:</strong> is the default weight decay used when training the model. Default=None.</li>
</ul>
<p><strong>Less frequently used arguments:</strong></p>
<ul>
<li><strong>sel_vars:</strong> used to select which of the features in multivariate datasets are used. Default=None means all features are used. If necessary a list-like of indices can be used (eg.<code>[0,3,5]</code>).</li>
<li><strong>sel_steps:</strong> used to select the steps used. Default=None means all steps are used. If necessary a list-like of indices can be used (eg. <code>slice(-50, None)</code> will select the last 50 steps from each time series).</li>
<li><strong>s_cat_idxs:</strong> list of indices for static categorical variables</li>
<li><strong>s_cat_embeddings:</strong> list of num_embeddings for each static categorical variable</li>
<li><strong>s_cat_embedding_dims:</strong> list of embedding dimensions for each static categorical variable</li>
<li><strong>s_cont_idxs:</strong> list of indices for static continuous variables</li>
<li><strong>o_cat_idxs:</strong> list of indices for observed categorical variables</li>
<li><strong>o_cat_embeddings:</strong> list of num_embeddings for each observed categorical variable</li>
<li><strong>o_cat_embedding_dims:</strong> list of embedding dimensions for each observed categorical variable</li>
<li><strong>o_cont_idxs:</strong> list of indices for observed continuous variables</li>
<li><strong>patch_len:</strong> Number of time steps in each patch.</li>
<li><strong>patch_stride:</strong> Stride of the patch.</li>
<li><strong>fusion_layers:</strong> list of layer dimensions for the fusion MLP</li>
<li><strong>fusion_act:</strong> activation function for the fusion MLP</li>
<li><strong>fusion_dropout:</strong> dropout probability for the fusion MLP</li>
<li><strong>fusion_use_bn:</strong> boolean indicating whether to use batch normalization in the fusion MLP</li>
<li><strong>weights:</strong> indicates a sample weight per instance. Used to pass pass a probability to the train dataloader sampler. Samples with more weight will be selected more often during training.</li>
<li><strong>partial_n:</strong> select randomly partial quantity of data at each epoch. Used to reduce the training size (for example for testing purposes). int or float can be used.</li>
<li><strong>vocab:</strong> vocabulary used to transform the target. Only required when transformed is not perform by a dataloader’s tfm (external transforms).</li>
<li><strong>train_metrics:</strong> flag used to display metrics in the training set. Defaults to False.</li>
<li><strong>valid_metrics:</strong> flag used to display metrics in the validtion set. Defaults to True.</li>
<li><strong>inplace:</strong> indicates whether tfms are applied during instantiation or on-the-fly. Default=True, which means that tfms will be applied during instantiation. This results in a faster training, but it can only be used when data fits in memory. Otherwise set it to False.</li>
<li><strong>shuffle_train:</strong> indicates whether to shuffle the training set every time the dataloader is fully read/iterated or not. This doesn’t have an impact on the validation set which is never shuffled. Default=True.</li>
<li><strong>drop_last:</strong> if True the last incomplete training batch is dropped (thus ensuring training batches of equal size). This doesn’t have an impact on the validation set where samples are never dropped. Default=True.</li>
<li><strong>num_workers:</strong> num_workers (int): how many subprocesses to use for data loading. 0 means that the data will be loaded in the main process. Default=0.</li>
<li><strong>do_setup:</strong> ndicates if the Pipeline.setup method should be called during initialization. Default=True.</li>
<li><strong>device:</strong> Defaults to default_device() which is CUDA by default. You can specify device as `torch.device(‘cpu’).</li>
<li><strong>seed:</strong> Set to an int to ensure reprodubibility. Default=None.</li>
<li><strong>verbose:</strong> controls the verbosity when fitting and predicting.</li>
<li><strong>exclude_head:</strong> indicates whether the head of the pretrained model needs to be removed or not. Default=True.</li>
<li><strong>cut:</strong> indicates the position where the pretrained model head needs to be cut. Defaults=-1.</li>
<li><strong>init:</strong> allows you to set to None (no initialization applied), set to True (in which case nn.init.kaiming_normal_ will be applied) or pass an initialization. Default=None.</li>
<li><strong>splitter:</strong> To do transfer learning, you need to pass a splitter to Learner. This should be a function taking the model and returning a collection of parameter groups, e.g.&nbsp;a list of list of parameters. Default=trainable_params. If the model has a backbone and a head, it will then be split in those 2 groups.</li>
<li><strong>path</strong> and <strong>model_dir:</strong> are used to save and/or load models. Often path will be inferred from dls, but you can override it or pass a Path object to model_dir.</li>
<li><strong>wd_bn_bias:</strong> controls if weight decay is applied to BatchNorm layers and bias. Default=False. train_bn=True</li>
<li><strong>moms:</strong> the default momentums used in Learner.fit_one_cycle. Default=(0.95, 0.85, 0.95).</li>
</ul>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/tslearner.py#L20" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="tsclassifier" class="level3">
<h3 class="anchored" data-anchor-id="tsclassifier">TSClassifier</h3>
<blockquote class="blockquote">
<pre><code> TSClassifier (X, y=None, splits=None, tfms=None, inplace=True,
               sel_vars=None, sel_steps=None, s_cat_idxs=None,
               s_cat_embeddings=None, s_cat_embedding_dims=None,
               s_cont_idxs=None, o_cat_idxs=None, o_cat_embeddings=None,
               o_cat_embedding_dims=None, o_cont_idxs=None,
               patch_len=None, patch_stride=None, fusion_layers=128,
               fusion_act='relu', fusion_dropout=0.0, fusion_use_bn=True,
               weights=None, partial_n=None, vocab=None,
               train_metrics=False, valid_metrics=True, bs=[64, 128],
               batch_size=None, batch_tfms=None, pipelines=None,
               shuffle_train=True, drop_last=True, num_workers=0,
               do_setup=True, device=None, seed=None, arch=None,
               arch_config={}, pretrained=False, weights_path=None,
               exclude_head=True, cut=-1, init=None, loss_func=None,
               opt_func=&lt;function Adam&gt;, lr=0.001, metrics=&lt;function
               accuracy&gt;, cbs=None, wd=None, wd_bn_bias=False,
               train_bn=True, moms=(0.95, 0.85, 0.95), path='.',
               model_dir='models', splitter=&lt;function trainable_params&gt;,
               verbose=False)</code></pre>
</blockquote>
<p><em>Group together a <code>model</code>, some <code>dls</code> and a <code>loss_func</code> to handle training</em></p>
<div id="cell-5" class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tsai.data.external <span class="im">import</span> <span class="op">*</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tsai.data.preprocessing <span class="im">import</span> <span class="op">*</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tsai.models.InceptionTimePlus <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-6" class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With validation split</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>X, y, splits <span class="op">=</span> get_classification_data(<span class="st">'OliveOil'</span>, split_data<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>tfms <span class="op">=</span> [<span class="va">None</span>, TSClassification()]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>batch_tfms <span class="op">=</span> [TSStandardize(by_sample<span class="op">=</span><span class="va">True</span>)]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> TSClassifier(X, y, splits<span class="op">=</span>splits, tfms<span class="op">=</span>tfms, batch_tfms<span class="op">=</span>batch_tfms, metrics<span class="op">=</span>accuracy, arch<span class="op">=</span>InceptionTimePlus, arch_config<span class="op">=</span><span class="bu">dict</span>(fc_dropout<span class="op">=</span><span class="fl">.5</span>),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                     train_metrics<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>learn.fit_one_cycle(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">train_accuracy</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">valid_accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.620233</td>
<td>0.200000</td>
<td>1.466389</td>
<td>0.300000</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cell-7" class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Without validation split</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>X, y, splits <span class="op">=</span> get_classification_data(<span class="st">'OliveOil'</span>, split_data<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>splits <span class="op">=</span> (splits[<span class="dv">0</span>], <span class="va">None</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>tfms <span class="op">=</span> [<span class="va">None</span>, TSClassification()]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>batch_tfms <span class="op">=</span> [TSStandardize(by_sample<span class="op">=</span><span class="va">True</span>)]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> TSClassifier(X, y, splits<span class="op">=</span>splits, tfms<span class="op">=</span>tfms, batch_tfms<span class="op">=</span>batch_tfms, metrics<span class="op">=</span>accuracy, arch<span class="op">=</span>InceptionTimePlus, arch_config<span class="op">=</span><span class="bu">dict</span>(fc_dropout<span class="op">=</span><span class="fl">.5</span>),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                     train_metrics<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>learn.fit_one_cycle(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.362660</td>
<td>0.333333</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cell-8" class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>num_classes <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.random.rand(<span class="dv">16</span>, <span class="dv">5</span>, <span class="dv">128</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.random.randint(<span class="dv">0</span>, num_classes, (<span class="dv">16</span>, <span class="dv">3</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>splits <span class="op">=</span> RandomSplitter()(range_of(X))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>arch <span class="op">=</span> <span class="st">'TSiTPlus'</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>vocab <span class="op">=</span> np.arange(num_classes)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> TSClassifier(X, y, splits<span class="op">=</span>splits, arch<span class="op">=</span>arch, metrics<span class="op">=</span>accuracy, vocab<span class="op">=</span>vocab, device<span class="op">=</span>default_device())</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>learn.fit_one_cycle(<span class="dv">1</span>, <span class="fl">1e-3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.792934</td>
<td>0.762534</td>
<td>0.444444</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cell-9" class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>num_classes <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> torch.rand(<span class="dv">8</span>, <span class="dv">2</span>, <span class="dv">50</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> torch.randint(<span class="dv">0</span>, num_classes, (<span class="bu">len</span>(X), <span class="dv">7</span>))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X.shape, y.shape)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>splits <span class="op">=</span> TimeSplitter(show_plot<span class="op">=</span><span class="va">False</span>)(y)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>vocab <span class="op">=</span> np.arange(num_classes)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>fail_test <span class="op">=</span> []</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> arch <span class="kw">in</span> all_arch_names:</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="st">"plus"</span> <span class="kw">in</span> arch.lower(): <span class="cf">continue</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        learn <span class="op">=</span> TSClassifier(X, y, splits<span class="op">=</span>splits, arch<span class="op">=</span>arch, metrics<span class="op">=</span>accuracy, vocab<span class="op">=</span>vocab, device<span class="op">=</span>default_device())</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> ContextManagers([learn.no_bar(), learn.no_logging()]):</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>            learn.fit_one_cycle(<span class="dv">1</span>, <span class="fl">1e-3</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> learn</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        gc.collect()</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>        fail_test.append(arch)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(arch, e)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>test_eq(fail_test, [])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>torch.Size([8, 2, 50]) torch.Size([8, 7])</code></pre>
</div>
</div>
</section>
</section>
<section id="tsregressor-api" class="level2">
<h2 class="anchored" data-anchor-id="tsregressor-api">TSRegressor API</h2>
<hr>
<p><strong>Commonly used arguments:</strong></p>
<ul>
<li><strong>X:</strong> array-like of shape (n_samples, n_steps) or (n_samples, n_features, n_steps) with the input time series samples. Internally, they will be converted to torch tensors.</li>
<li><strong>y:</strong> array-like of shape (n_samples), (n_samples, n_outputs) or (n_samples, n_features, n_outputs) with the target. Internally, they will be converted to torch tensors. Default=None. None is used for unlabeled datasets.</li>
<li><strong>splits:</strong> lists of indices used to split data between train and validation. Default=None. If no splits are passed, data will be split 100:0 between train and test without shuffling.</li>
<li><strong>tfms:</strong> item transforms that will be applied to each sample individually. Default=None.</li>
<li><strong>batch_tfms:</strong> transforms applied to each batch. Default=None.</li>
<li><strong>pipelines:</strong> store sklearn-type pipelines that can then be applied to pandas dataframes with transform or inverse_transform methods. Default=None.</li>
<li><strong>bs:</strong> batch size (if batch_size is provided then batch_size will override bs). An int or a list of ints can be passed. Default=<code>[64, 128]</code>. If a list of ints, the first one will be used for training, and the second for the valid (batch size can be larger as it doesn’t require backpropagation which consumes more memory).</li>
<li><strong>arch:</strong> indicates which architecture will be used. Alternatively, you can pass an instantiated model. Default: InceptionTimePlus.</li>
<li><strong>arch_config:</strong> keyword arguments passed to the selected architecture. Default={}.</li>
<li><strong>pretrained:</strong> indicates if pretrained model weights will be used. Default=False.</li>
<li><strong>weights_path:</strong> indicates the path to the pretrained weights in case they are used.</li>
<li><strong>loss_func:</strong> allows you to pass any loss function. Default=None (in which case CrossEntropyLossFlat() is applied).</li>
<li><strong>opt_func:</strong> allows you to pass an optimizer. Default=Adam.</li>
<li><strong>lr:</strong> learning rate. Default=0.001.</li>
<li><strong>metrics:</strong> list of metrics passed to the Learner. Default=None.</li>
<li><strong>cbs:</strong> list of callbacks passed to the Learner. Default=None.</li>
<li><strong>wd:</strong> is the default weight decay used when training the model. Default=None.</li>
</ul>
<p><strong>Less frequently used arguments:</strong></p>
<ul>
<li><strong>sel_vars:</strong> used to select which of the features in multivariate datasets are used. Default=None means all features are used. If necessary a list-like of indices can be used (eg.<code>[0,3,5]</code>).</li>
<li><strong>sel_steps:</strong> used to select the steps used. Default=None means all steps are used. If necessary a list-like of indices can be used (eg. <code>slice(-50, None)</code> will select the last 50 steps from each time series).</li>
<li><strong>s_cat_idxs:</strong> list of indices for static categorical variables</li>
<li><strong>s_cat_embeddings:</strong> list of num_embeddings for each static categorical variable</li>
<li><strong>s_cat_embedding_dims:</strong> list of embedding dimensions for each static categorical variable</li>
<li><strong>s_cont_idxs:</strong> list of indices for static continuous variables</li>
<li><strong>o_cat_idxs:</strong> list of indices for observed categorical variables</li>
<li><strong>o_cat_embeddings:</strong> list of num_embeddings for each observed categorical variable</li>
<li><strong>o_cat_embedding_dims:</strong> list of embedding dimensions for each observed categorical variable</li>
<li><strong>o_cont_idxs:</strong> list of indices for observed continuous variables</li>
<li><strong>patch_len:</strong> Number of time steps in each patch.</li>
<li><strong>patch_stride:</strong> Stride of the patch.</li>
<li><strong>fusion_layers:</strong> list of layer dimensions for the fusion MLP</li>
<li><strong>fusion_act:</strong> activation function for the fusion MLP</li>
<li><strong>fusion_dropout:</strong> dropout probability for the fusion MLP</li>
<li><strong>fusion_use_bn:</strong> boolean indicating whether to use batch normalization in the fusion MLP</li>
<li><strong>weights:</strong> indicates a sample weight per instance. Used to pass pass a probability to the train dataloader sampler. Samples with more weight will be selected more often during training.</li>
<li><strong>partial_n:</strong> select randomly partial quantity of data at each epoch. Used to reduce the training size (for example for testing purposes). int or float can be used.</li>
<li><strong>train_metrics:</strong> flag used to display metrics in the training set. Defaults to False.</li>
<li><strong>valid_metrics:</strong> flag used to display metrics in the validtion set. Defaults to True.</li>
<li><strong>inplace:</strong> indicates whether tfms are applied during instantiation or on-the-fly. Default=True, which means that tfms will be applied during instantiation. This results in a faster training, but it can only be used when data fits in memory. Otherwise set it to False.</li>
<li><strong>shuffle_train:</strong> indicates whether to shuffle the training set every time the dataloader is fully read/iterated or not. This doesn’t have an impact on the validation set which is never shuffled. Default=True.</li>
<li><strong>drop_last:</strong> if True the last incomplete training batch is dropped (thus ensuring training batches of equal size). This doesn’t have an impact on the validation set where samples are never dropped. Default=True.</li>
<li><strong>num_workers:</strong> num_workers (int): how many subprocesses to use for data loading. 0 means that the data will be loaded in the main process. Default=0.</li>
<li><strong>do_setup:</strong> ndicates if the Pipeline.setup method should be called during initialization. Default=True.</li>
<li><strong>device:</strong> Defaults to default_device() which is CUDA by default. You can specify device as `torch.device(‘cpu’).</li>
<li><strong>seed:</strong> Set to an int to ensure reprodubibility. Default=None.</li>
<li><strong>verbose:</strong> controls the verbosity when fitting and predicting.</li>
<li><strong>exclude_head:</strong> indicates whether the head of the pretrained model needs to be removed or not. Default=True.</li>
<li><strong>cut:</strong> indicates the position where the pretrained model head needs to be cut. Defaults=-1.</li>
<li><strong>init:</strong> allows you to set to None (no initialization applied), set to True (in which case nn.init.kaiming_normal_ will be applied) or pass an initialization. Default=None.</li>
<li><strong>splitter:</strong> To do transfer learning, you need to pass a splitter to Learner. This should be a function taking the model and returning a collection of parameter groups, e.g.&nbsp;a list of list of parameters. Default=trainable_params. If the model has a backbone and a head, it will then be split in those 2 groups.</li>
<li><strong>path</strong> and <strong>model_dir:</strong> are used to save and/or load models. Often path will be inferred from dls, but you can override it or pass a Path object to model_dir.</li>
<li><strong>wd_bn_bias:</strong> controls if weight decay is applied to BatchNorm layers and bias. Default=False. train_bn=True</li>
<li><strong>moms:</strong> the default momentums used in Learner.fit_one_cycle. Default=(0.95, 0.85, 0.95).</li>
</ul>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/tslearner.py#L102" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="tsregressor" class="level3">
<h3 class="anchored" data-anchor-id="tsregressor">TSRegressor</h3>
<blockquote class="blockquote">
<pre><code> TSRegressor (X, y=None, splits=None, tfms=None, inplace=True,
              sel_vars=None, sel_steps=None, s_cat_idxs=None,
              s_cat_embeddings=None, s_cat_embedding_dims=None,
              s_cont_idxs=None, o_cat_idxs=None, o_cat_embeddings=None,
              o_cat_embedding_dims=None, o_cont_idxs=None, patch_len=None,
              patch_stride=None, fusion_layers=128, fusion_act='relu',
              fusion_dropout=0.0, fusion_use_bn=True, weights=None,
              partial_n=None, train_metrics=False, valid_metrics=True,
              bs=[64, 128], batch_size=None, batch_tfms=None,
              pipelines=None, shuffle_train=True, drop_last=True,
              num_workers=0, do_setup=True, device=None, seed=None,
              arch=None, arch_config={}, pretrained=False,
              weights_path=None, exclude_head=True, cut=-1, init=None,
              loss_func=None, opt_func=&lt;function Adam&gt;, lr=0.001,
              metrics=None, cbs=None, wd=None, wd_bn_bias=False,
              train_bn=True, moms=(0.95, 0.85, 0.95), path='.',
              model_dir='models', splitter=&lt;function trainable_params&gt;,
              verbose=False)</code></pre>
</blockquote>
<p><em>Group together a <code>model</code>, some <code>dls</code> and a <code>loss_func</code> to handle training</em></p>
<div id="cell-12" class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>X, y, splits <span class="op">=</span> get_regression_data(<span class="st">'AppliancesEnergy'</span>, split_data<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> X <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>: <span class="co"># This is to prevent a test fail when the data server is not available</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> X.astype(<span class="st">'float32'</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> y.astype(<span class="st">'float32'</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    batch_tfms <span class="op">=</span> [TSStandardize()]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    learn <span class="op">=</span> TSRegressor(X, y, splits<span class="op">=</span>splits, batch_tfms<span class="op">=</span>batch_tfms, arch<span class="op">=</span><span class="va">None</span>, metrics<span class="op">=</span>mae, bs<span class="op">=</span><span class="dv">512</span>, train_metrics<span class="op">=</span><span class="va">True</span>, device<span class="op">=</span>default_device())</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    learn.fit_one_cycle(<span class="dv">1</span>, <span class="fl">1e-4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">train_mae</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">valid_mae</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>215.481400</td>
<td>14.030172</td>
<td>202.221893</td>
<td>13.798750</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="tsforecaster-api" class="level2">
<h2 class="anchored" data-anchor-id="tsforecaster-api">TSForecaster API</h2>
<hr>
<p><strong>Commonly used arguments:</strong></p>
<ul>
<li><strong>X:</strong> array-like of shape (n_samples, n_steps) or (n_samples, n_features, n_steps) with the input time series samples. Internally, they will be converted to torch tensors.</li>
<li><strong>y:</strong> array-like of shape (n_samples), (n_samples, n_outputs) or (n_samples, n_features, n_outputs) with the target. Internally, they will be converted to torch tensors. Default=None. None is used for unlabeled datasets.</li>
<li><strong>splits:</strong> lists of indices used to split data between train and validation. Default=None. If no splits are passed, data will be split 100:0 between train and test without shuffling.</li>
<li><strong>tfms:</strong> item transforms that will be applied to each sample individually. Default=None.</li>
<li><strong>batch_tfms:</strong> transforms applied to each batch. Default=None.</li>
<li><strong>pipelines:</strong> store sklearn-type pipelines that can then be applied to pandas dataframes with transform or inverse_transform methods. Default=None.</li>
<li><strong>bs:</strong> batch size (if batch_size is provided then batch_size will override bs). An int or a list of ints can be passed. Default=<code>[64, 128]</code>. If a list of ints, the first one will be used for training, and the second for the valid (batch size can be larger as it doesn’t require backpropagation which consumes more memory).</li>
<li><strong>arch:</strong> indicates which architecture will be used. Alternatively, you can pass an instantiated model. Default: InceptionTimePlus.</li>
<li><strong>arch_config:</strong> keyword arguments passed to the selected architecture. Default={}.</li>
<li><strong>pretrained:</strong> indicates if pretrained model weights will be used. Default=False.</li>
<li><strong>weights_path:</strong> indicates the path to the pretrained weights in case they are used.</li>
<li><strong>loss_func:</strong> allows you to pass any loss function. Default=None (in which case CrossEntropyLossFlat() is applied).</li>
<li><strong>opt_func:</strong> allows you to pass an optimizer. Default=Adam.</li>
<li><strong>lr:</strong> learning rate. Default=0.001.</li>
<li><strong>metrics:</strong> list of metrics passed to the Learner. Default=None.</li>
<li><strong>cbs:</strong> list of callbacks passed to the Learner. Default=None.</li>
<li><strong>wd:</strong> is the default weight decay used when training the model. Default=None.</li>
</ul>
<p><strong>Less frequently used arguments:</strong></p>
<ul>
<li><strong>sel_vars:</strong> used to select which of the features in multivariate datasets are used. Default=None means all features are used. If necessary a list-like of indices can be used (eg.<code>[0,3,5]</code>).</li>
<li><strong>sel_steps:</strong> used to select the steps used. Default=None means all steps are used. If necessary a list-like of indices can be used (eg. <code>slice(-50, None)</code> will select the last 50 steps from each time series).</li>
<li><strong>s_cat_idxs:</strong> list of indices for static categorical variables</li>
<li><strong>s_cat_embeddings:</strong> list of num_embeddings for each static categorical variable</li>
<li><strong>s_cat_embedding_dims:</strong> list of embedding dimensions for each static categorical variable</li>
<li><strong>s_cont_idxs:</strong> list of indices for static continuous variables</li>
<li><strong>o_cat_idxs:</strong> list of indices for observed categorical variables</li>
<li><strong>o_cat_embeddings:</strong> list of num_embeddings for each observed categorical variable</li>
<li><strong>o_cat_embedding_dims:</strong> list of embedding dimensions for each observed categorical variable</li>
<li><strong>o_cont_idxs:</strong> list of indices for observed continuous variables</li>
<li><strong>patch_len:</strong> Number of time steps in each patch.</li>
<li><strong>patch_stride:</strong> Stride of the patch.</li>
<li><strong>fusion_layers:</strong> list of layer dimensions for the fusion MLP</li>
<li><strong>fusion_act:</strong> activation function for the fusion MLP</li>
<li><strong>fusion_dropout:</strong> dropout probability for the fusion MLP</li>
<li><strong>fusion_use_bn:</strong> boolean indicating whether to use batch normalization in the fusion MLP</li>
<li><strong>weights:</strong> indicates a sample weight per instance. Used to pass pass a probability to the train dataloader sampler. Samples with more weight will be selected more often during training.</li>
<li><strong>partial_n:</strong> select randomly partial quantity of data at each epoch. Used to reduce the training size (for example for testing purposes). int or float can be used.</li>
<li><strong>train_metrics:</strong> flag used to display metrics in the training set. Defaults to False.</li>
<li><strong>valid_metrics:</strong> flag used to display metrics in the validtion set. Defaults to True.</li>
<li><strong>inplace:</strong> indicates whether tfms are applied during instantiation or on-the-fly. Default=True, which means that tfms will be applied during instantiation. This results in a faster training, but it can only be used when data fits in memory. Otherwise set it to False.</li>
<li><strong>shuffle_train:</strong> indicates whether to shuffle the training set every time the dataloader is fully read/iterated or not. This doesn’t have an impact on the validation set which is never shuffled. Default=True.</li>
<li><strong>drop_last:</strong> if True the last incomplete training batch is dropped (thus ensuring training batches of equal size). This doesn’t have an impact on the validation set where samples are never dropped. Default=True.</li>
<li><strong>num_workers:</strong> num_workers (int): how many subprocesses to use for data loading. 0 means that the data will be loaded in the main process. Default=None.</li>
<li><strong>do_setup:</strong> ndicates if the Pipeline.setup method should be called during initialization. Default=True.</li>
<li><strong>device:</strong> Defaults to default_device() which is CUDA by default. You can specify device as `torch.device(‘cpu’).</li>
<li><strong>seed:</strong> Set to an int to ensure reprodubibility. Default=None.</li>
<li><strong>verbose:</strong> controls the verbosity when fitting and predicting.</li>
<li><strong>exclude_head:</strong> indicates whether the head of the pretrained model needs to be removed or not. Default=True.</li>
<li><strong>cut:</strong> indicates the position where the pretrained model head needs to be cut. Defaults=-1.</li>
<li><strong>init:</strong> allows you to set to None (no initialization applied), set to True (in which case nn.init.kaiming_normal_ will be applied) or pass an initialization. Default=None.</li>
<li><strong>splitter:</strong> To do transfer learning, you need to pass a splitter to Learner. This should be a function taking the model and returning a collection of parameter groups, e.g.&nbsp;a list of list of parameters. Default=trainable_params. If the model has a backbone and a head, it will then be split in those 2 groups.</li>
<li><strong>path</strong> and <strong>model_dir:</strong> are used to save and/or load models. Often path will be inferred from dls, but you can override it or pass a Path object to model_dir.</li>
<li><strong>wd_bn_bias:</strong> controls if weight decay is applied to BatchNorm layers and bias. Default=False. train_bn=True</li>
<li><strong>moms:</strong> the default momentums used in Learner.fit_one_cycle. Default=(0.95, 0.85, 0.95).</li>
</ul>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/tslearner.py#L185" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="tsforecaster" class="level3">
<h3 class="anchored" data-anchor-id="tsforecaster">TSForecaster</h3>
<blockquote class="blockquote">
<pre><code> TSForecaster (X, y=None, splits=None, tfms=None, inplace=True,
               sel_vars=None, sel_steps=None, s_cat_idxs=None,
               s_cat_embeddings=None, s_cat_embedding_dims=None,
               s_cont_idxs=None, o_cat_idxs=None, o_cat_embeddings=None,
               o_cat_embedding_dims=None, o_cont_idxs=None,
               patch_len=None, patch_stride=None, fusion_layers=128,
               fusion_act='relu', fusion_dropout=0.0, fusion_use_bn=True,
               weights=None, partial_n=None, train_metrics=False,
               valid_metrics=True, bs=[64, 128], batch_size=None,
               batch_tfms=None, pipelines=None, shuffle_train=True,
               drop_last=True, num_workers=0, do_setup=True, device=None,
               seed=None, arch=None, arch_config={}, pretrained=False,
               weights_path=None, exclude_head=True, cut=-1, init=None,
               loss_func=None, opt_func=&lt;function Adam&gt;, lr=0.001,
               metrics=None, cbs=None, wd=None, wd_bn_bias=False,
               train_bn=True, moms=(0.95, 0.85, 0.95), path='.',
               model_dir='models', splitter=&lt;function trainable_params&gt;,
               verbose=False)</code></pre>
</blockquote>
<p><em>Group together a <code>model</code>, some <code>dls</code> and a <code>loss_func</code> to handle training</em></p>
<div id="cell-15" class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tsai.data.preparation <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-16" class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ts <span class="op">=</span> get_forecasting_time_series(<span class="st">'Sunspots'</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> ts <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>: <span class="co"># This is to prevent a test fail when the data server is not available</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    X, y <span class="op">=</span> SlidingWindowSplitter(<span class="dv">60</span>, horizon<span class="op">=</span><span class="dv">1</span>)(ts)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    X, y <span class="op">=</span> X.astype(<span class="st">'float32'</span>), y.astype(<span class="st">'float32'</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    splits <span class="op">=</span> TSSplitter(<span class="dv">235</span>)(y)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    batch_tfms <span class="op">=</span> [TSStandardize(by_var<span class="op">=</span><span class="va">True</span>)]</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    learn <span class="op">=</span> TSForecaster(X, y, splits<span class="op">=</span>splits, batch_tfms<span class="op">=</span>batch_tfms, arch<span class="op">=</span><span class="va">None</span>, arch_config<span class="op">=</span><span class="bu">dict</span>(fc_dropout<span class="op">=</span><span class="fl">.5</span>), metrics<span class="op">=</span>mae, bs<span class="op">=</span><span class="dv">512</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                         partial_n<span class="op">=</span><span class="fl">.1</span>, train_metrics<span class="op">=</span><span class="va">True</span>, device<span class="op">=</span>default_device())</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    learn.fit_one_cycle(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Dataset: Sunspots
downloading data...
...done. Path = data/forecasting/Sunspots.csv</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="022_tslearner_files/figure-html/cell-12-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">train_mae</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">valid_mae</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>4688.818359</td>
<td>52.336243</td>
<td>7955.546387</td>
<td>74.580894</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cell-17" class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>X<span class="op">=</span>torch.rand(<span class="dv">8</span>,<span class="dv">2</span>,<span class="dv">50</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>torch.rand(<span class="dv">8</span>,<span class="dv">1</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>splits <span class="op">=</span> TimeSplitter(show_plot<span class="op">=</span><span class="va">False</span>)(y)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>fail_test <span class="op">=</span> []</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> arch <span class="kw">in</span> all_arch_names:</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="st">"plus"</span> <span class="kw">in</span> arch.lower(): <span class="cf">continue</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>        fcst <span class="op">=</span> TSForecaster(X, y, splits<span class="op">=</span>splits, arch<span class="op">=</span>arch, metrics<span class="op">=</span>mse, device<span class="op">=</span>default_device())</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> ContextManagers([fcst.no_bar(), fcst.no_logging()]):</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>            fcst.fit_one_cycle(<span class="dv">1</span>, <span class="fl">1e-3</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>        fail_test.append(arch)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(arch, e)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>test_eq(fail_test, [])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/timeseriesAI\.github\.io\/tsai\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/timeseriesAI/tsai/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>