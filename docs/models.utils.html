---

title: Models utils


keywords: fastai
sidebar: home_sidebar

summary: "Utility functions used to build PyTorch timeseries models."
description: "Utility functions used to build PyTorch timeseries models."
nb_path: "nbs/100b_models.utils.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/100b_models.utils.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_layers" class="doc_header"><code>get_layers</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L16" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_layers</code>(<strong><code>model</code></strong>, <strong><code>cond</code></strong>=<em><code>noop</code></em>, <strong><code>full</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_layer" class="doc_header"><code>is_layer</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L21" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_layer</code>(<strong>*<code>args</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_linear" class="doc_header"><code>is_linear</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L26" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_linear</code>(<strong><code>l</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_bn" class="doc_header"><code>is_bn</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L29" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_bn</code>(<strong><code>l</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_conv_linear" class="doc_header"><code>is_conv_linear</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L33" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_conv_linear</code>(<strong><code>l</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_affine_layer" class="doc_header"><code>is_affine_layer</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L37" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_affine_layer</code>(<strong><code>l</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_conv" class="doc_header"><code>is_conv</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L40" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_conv</code>(<strong><code>l</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="has_bias" class="doc_header"><code>has_bias</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L44" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>has_bias</code>(<strong><code>l</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="has_weight" class="doc_header"><code>has_weight</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L47" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>has_weight</code>(<strong><code>l</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="has_weight_or_bias" class="doc_header"><code>has_weight_or_bias</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L50" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>has_weight_or_bias</code>(<strong><code>l</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="check_bias" class="doc_header"><code>check_bias</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L54" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>check_bias</code>(<strong><code>m</code></strong>, <strong><code>cond</code></strong>=<em><code>noop</code></em>, <strong><code>verbose</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="check_weight" class="doc_header"><code>check_weight</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L64" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>check_weight</code>(<strong><code>m</code></strong>, <strong><code>cond</code></strong>=<em><code>noop</code></em>, <strong><code>verbose</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_nf" class="doc_header"><code>get_nf</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L75" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_nf</code>(<strong><code>m</code></strong>)</p>
</blockquote>
<p>Get nf from model's first linear layer in head</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ts_splitter" class="doc_header"><code>ts_splitter</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L80" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ts_splitter</code>(<strong><code>m</code></strong>)</p>
</blockquote>
<p>Split of a model between body and head</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="transfer_weights" class="doc_header"><code>transfer_weights</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L85" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>transfer_weights</code>(<strong><code>model</code></strong>, <strong><code>weights_path</code></strong>:<code>Path</code>, <strong><code>device</code></strong>:<code>device</code>=<em><code>None</code></em>, <strong><code>exclude_head</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Utility function that allows to easily transfer weights between models.
Taken from the great self-supervised repository created by Kerem Turgutlu.
<a href="https://github.com/KeremTurgutlu/self_supervised/blob/d87ebd9b4961c7da0efd6073c42782bbc61aaa2e/self_supervised/utils.py">https://github.com/KeremTurgutlu/self_supervised/blob/d87ebd9b4961c7da0efd6073c42782bbc61aaa2e/self_supervised/utils.py</a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="build_ts_model" class="doc_header"><code>build_ts_model</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L113" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>build_ts_model</code>(<strong><code>arch</code></strong>, <strong><code>c_in</code></strong>=<em><code>None</code></em>, <strong><code>c_out</code></strong>=<em><code>None</code></em>, <strong><code>seq_len</code></strong>=<em><code>None</code></em>, <strong><code>d</code></strong>=<em><code>None</code></em>, <strong><code>dls</code></strong>=<em><code>None</code></em>, <strong><code>device</code></strong>=<em><code>None</code></em>, <strong><code>verbose</code></strong>=<em><code>False</code></em>, <strong><code>pretrained</code></strong>=<em><code>False</code></em>, <strong><code>weights_path</code></strong>=<em><code>None</code></em>, <strong><code>exclude_head</code></strong>=<em><code>True</code></em>, <strong><code>cut</code></strong>=<em><code>-1</code></em>, <strong><code>init</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="build_tabular_model" class="doc_header"><code>build_tabular_model</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L173" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>build_tabular_model</code>(<strong><code>arch</code></strong>, <strong><code>dls</code></strong>, <strong><code>layers</code></strong>=<em><code>None</code></em>, <strong><code>emb_szs</code></strong>=<em><code>None</code></em>, <strong><code>n_out</code></strong>=<em><code>None</code></em>, <strong><code>y_range</code></strong>=<em><code>None</code></em>, <strong><code>device</code></strong>=<em><code>None</code></em>, <strong><code>ps</code></strong>=<em><code>None</code></em>, <strong><code>embed_p</code></strong>=<em><code>0.0</code></em>, <strong><code>use_bn</code></strong>=<em><code>True</code></em>, <strong><code>bn_final</code></strong>=<em><code>False</code></em>, <strong><code>bn_cont</code></strong>=<em><code>True</code></em>, <strong><code>act_cls</code></strong>=<em><code>ReLU(inplace=True)</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="build_tsimage_model" class="doc_header"><code>build_tsimage_model</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L192" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>build_tsimage_model</code>(<strong><code>arch</code></strong>, <strong><code>c_in</code></strong>=<em><code>None</code></em>, <strong><code>c_out</code></strong>=<em><code>None</code></em>, <strong><code>dls</code></strong>=<em><code>None</code></em>, <strong><code>pretrained</code></strong>=<em><code>False</code></em>, <strong><code>device</code></strong>=<em><code>None</code></em>, <strong><code>verbose</code></strong>=<em><code>False</code></em>, <strong><code>init</code></strong>=<em><code>None</code></em>, <strong><code>p</code></strong>=<em><code>0.0</code></em>, <strong><code>n_out</code></strong>=<em><code>1000</code></em>, <strong><code>stem_szs</code></strong>=<em><code>(32, 32, 64)</code></em>, <strong><code>widen</code></strong>=<em><code>1.0</code></em>, <strong><code>sa</code></strong>=<em><code>False</code></em>, <strong><code>act_cls</code></strong>=<em><code>ReLU</code></em>, <strong><code>ndim</code></strong>=<em><code>2</code></em>, <strong><code>ks</code></strong>=<em><code>3</code></em>, <strong><code>stride</code></strong>=<em><code>2</code></em>, <strong><code>groups</code></strong>=<em><code>1</code></em>, <strong><code>reduction</code></strong>=<em><code>None</code></em>, <strong><code>nh1</code></strong>=<em><code>None</code></em>, <strong><code>nh2</code></strong>=<em><code>None</code></em>, <strong><code>dw</code></strong>=<em><code>False</code></em>, <strong><code>g2</code></strong>=<em><code>1</code></em>, <strong><code>sym</code></strong>=<em><code>False</code></em>, <strong><code>norm_type</code></strong>=<em><code>&lt;NormType.Batch: 1&gt;</code></em>, <strong><code>pool</code></strong>=<em><code>AvgPool</code></em>, <strong><code>pool_first</code></strong>=<em><code>True</code></em>, <strong><code>padding</code></strong>=<em><code>None</code></em>, <strong><code>bias</code></strong>=<em><code>None</code></em>, <strong><code>bn_1st</code></strong>=<em><code>True</code></em>, <strong><code>transpose</code></strong>=<em><code>False</code></em>, <strong><code>xtra</code></strong>=<em><code>None</code></em>, <strong><code>bias_std</code></strong>=<em><code>0.01</code></em>, <strong><code>dilation</code></strong>:<code>Union</code>[<code>int</code>, <code>Tuple</code>[<code>int</code>, <code>int</code>]]=<em><code>1</code></em>, <strong><code>padding_mode</code></strong>:<code>str</code>=<em><code>'zeros'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="count_parameters" class="doc_header"><code>count_parameters</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L206" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>count_parameters</code>(<strong><code>model</code></strong>, <strong><code>trainable</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">tsai.data.external</span> <span class="kn">import</span> <span class="n">get_UCR_data</span>
<span class="kn">from</span> <span class="nn">tsai.data.features</span> <span class="kn">import</span> <span class="n">get_ts_features</span>
<span class="n">dsid</span> <span class="o">=</span> <span class="s1">&#39;NATOPS&#39;</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">splits</span> <span class="o">=</span> <span class="n">get_UCR_data</span><span class="p">(</span><span class="n">dsid</span><span class="p">,</span> <span class="n">split_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ts_features_df</span> <span class="o">=</span> <span class="n">get_ts_features</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Feature Extraction: 100%|██████████| 40/40 [00:03&lt;00:00, 11.70it/s]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">tsai.data.tabular</span> <span class="kn">import</span> <span class="n">get_tabular_dls</span>
<span class="kn">from</span> <span class="nn">tsai.models.TabModel</span> <span class="kn">import</span> <span class="n">TabModel</span>
<span class="n">cat_names</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">cont_names</span> <span class="o">=</span> <span class="n">ts_features_df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="n">y_names</span> <span class="o">=</span> <span class="s1">&#39;target&#39;</span>
<span class="n">tab_dls</span> <span class="o">=</span> <span class="n">get_tabular_dls</span><span class="p">(</span><span class="n">ts_features_df</span><span class="p">,</span> <span class="n">cat_names</span><span class="o">=</span><span class="n">cat_names</span><span class="p">,</span> <span class="n">cont_names</span><span class="o">=</span><span class="n">cont_names</span><span class="p">,</span> <span class="n">y_names</span><span class="o">=</span><span class="n">y_names</span><span class="p">,</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">)</span>
<span class="n">tab_model</span> <span class="o">=</span> <span class="n">build_tabular_model</span><span class="p">(</span><span class="n">TabModel</span><span class="p">,</span> <span class="n">dls</span><span class="o">=</span><span class="n">tab_dls</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">first</span><span class="p">(</span><span class="n">tab_dls</span><span class="o">.</span><span class="n">train</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tab_model</span><span class="p">(</span><span class="o">*</span><span class="n">b</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">64</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;MLSTM_FCN&#39;</span>
<span class="k">if</span> <span class="nb">sum</span><span class="p">([</span><span class="mi">1</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;RNN_FCN&#39;</span><span class="p">,</span> <span class="s1">&#39;LSTM_FCN&#39;</span><span class="p">,</span> <span class="s1">&#39;GRU_FCN&#39;</span><span class="p">,</span> <span class="s1">&#39;OmniScaleCNN&#39;</span><span class="p">,</span> <span class="s1">&#39;Transformer&#39;</span><span class="p">,</span> <span class="s1">&#39;mWDN&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]):</span> <span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_clones" class="doc_header"><code>get_clones</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L211" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_clones</code>(<strong><code>module</code></strong>, <strong><code>N</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv1d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">get_clones</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>ModuleList(
  (0): Conv1d(3, 4, kernel_size=(3,), stride=(1,))
  (1): Conv1d(3, 4, kernel_size=(3,), stride=(1,))
  (2): Conv1d(3, 4, kernel_size=(3,), stride=(1,))
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="split_model" class="doc_header"><code>split_model</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L215" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>split_model</code>(<strong><code>m</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="seq_len_calculator" class="doc_header"><code>seq_len_calculator</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L218" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>seq_len_calculator</code>(<strong><code>seq_len</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">345</span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">seq_len_calculator</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>69</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="change_model_head" class="doc_header"><code>change_model_head</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L223" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>change_model_head</code>(<strong><code>model</code></strong>, <strong><code>custom_head</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Replaces a model's head by a custom head as long as the model has a head, head_nf, c_out and seq_len attributes</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="naive_forecaster" class="doc_header"><code>naive_forecaster</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L229" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>naive_forecaster</code>(<strong><code>o</code></strong>, <strong><code>split</code></strong>, <strong><code>horizon</code></strong>=<em><code>1</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="true_forecaster" class="doc_header"><code>true_forecaster</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/utils.py#L237" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>true_forecaster</code>(<strong><code>o</code></strong>, <strong><code>split</code></strong>, <strong><code>horizon</code></strong>=<em><code>1</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">split</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">a</span><span class="p">,</span> <span class="n">naive_forecaster</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">split</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">true_forecaster</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">split</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([0.66500289, 0.67146901, 1.08185071, 1.87717164, 1.98166125,
        2.87133837, 3.47798237, 3.56756461, 3.95701873, 4.58810723,
        4.85781729, 5.72736474, 5.92090524, 5.98373841, 6.54266268,
        7.17498726, 7.37614904, 8.10680864, 8.70282496, 9.59440958]),
 array([4.58810723, 4.85781729, 5.72736474, 5.92090524, 5.98373841,
        6.54266268, 7.17498726, 7.37614904, 8.10680864, 8.70282496]),
 array([4.85781729, 5.72736474, 5.92090524, 5.98373841, 6.54266268,
        7.17498726, 7.37614904, 8.10680864, 8.70282496, 9.59440958]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

