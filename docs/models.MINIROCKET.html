---

title: MINIROCKET


keywords: fastai
sidebar: home_sidebar

summary: "A Very Fast (Almost) Deterministic Transform for Time Series Classification."
description: "A Very Fast (Almost) Deterministic Transform for Time Series Classification."
nb_path: "nbs/111b_models.MINIROCKET.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/111b_models.MINIROCKET.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MiniRocketFeatures" class="doc_header"><code>class</code> <code>MiniRocketFeatures</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/MINIROCKET.py#L23" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MiniRocketFeatures</code>(<strong><code>standardize</code></strong>=<em><code>False</code></em>, <strong><code>by_sample</code></strong>=<em><code>False</code></em>, <strong><code>by_var</code></strong>=<em><code>False</code></em>, <strong><code>by_step</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MiniRocket" class="doc_header"><code>class</code> <code>MiniRocket</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/MINIROCKET.py#L111" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MiniRocket</code>(<strong><code>c_in</code></strong>, <strong><code>c_out</code></strong>, <strong><code>seq_len</code></strong>=<em><code>1</code></em>, <strong><code>fc_dropout</code></strong>=<em><code>0.0</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/tsai/models.TabFusionTransformer.html#Sequential"><code>Sequential</code></a></p>
</blockquote>
<p>A sequential container.
Modules will be added to it in the order they are passed in the constructor.
Alternatively, an ordered dict of modules can also be passed in.</p>
<p>To make it easier to understand, here is a small example::</p>

<pre><code># Example of using Sequential
model = nn.Sequential(
          nn.Conv2d(1,20,5),
          nn.ReLU(),
          nn.Conv2d(20,64,5),
          nn.ReLU()
        )

# Example of using Sequential with OrderedDict
model = nn.Sequential(OrderedDict([
          ('conv1', nn.Conv2d(1,20,5)),
          ('relu1', nn.ReLU()),
          ('conv2', nn.Conv2d(20,64,5)),
          ('relu2', nn.ReLU())
        ]))</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dsid</span> <span class="o">=</span> <span class="s1">&#39;ECGFiveDays&#39;</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">splits</span> <span class="o">=</span> <span class="n">get_UCR_data</span><span class="p">(</span><span class="n">dsid</span><span class="p">,</span> <span class="n">split_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">mrf</span> <span class="o">=</span> <span class="n">MiniRocketFeatures</span><span class="p">()</span>
<span class="n">mrf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">X_tfm_train</span> <span class="o">=</span> <span class="n">mrf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="s1">&#39;mrf_train&#39;</span><span class="p">,</span> <span class="n">on_disk</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">mrf</span><span class="o">.</span><span class="n">parameters</span>
<span class="n">mrf</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mrf_</span><span class="si">{</span><span class="n">dsid</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">del</span> <span class="n">mrf</span>
<span class="n">mrf</span> <span class="o">=</span> <span class="n">MiniRocketFeatures</span><span class="p">()</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mrf_</span><span class="si">{</span><span class="n">dsid</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">mrf</span><span class="o">.</span><span class="n">parameters</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
<span class="n">X_tfm_valid</span> <span class="o">=</span> <span class="n">mrf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">splits</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="s1">&#39;mrf_valid&#39;</span><span class="p">,</span> <span class="n">on_disk</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With MiniRocket we use need to:</p>
<ol>
<li>Transform X --&gt; X_tfm</li>
<li>Train a MiniRocket using previously calculated features (X_tfm)</li>
</ol>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">tsai.data.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">tsai.learner</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">dsid</span> <span class="o">=</span> <span class="s1">&#39;ECGFiveDays&#39;</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">splits</span> <span class="o">=</span> <span class="n">get_UCR_data</span><span class="p">(</span><span class="n">dsid</span><span class="p">,</span> <span class="n">split_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">tfms</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">TSClassification</span><span class="p">()]</span>
<span class="n">batch_tfms</span> <span class="o">=</span> <span class="n">TSStandardize</span><span class="p">(</span><span class="n">by_var</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mrf</span> <span class="o">=</span> <span class="n">MiniRocketFeatures</span><span class="p">()</span>
<span class="n">X_tfm</span> <span class="o">=</span> <span class="n">mrf</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">dls</span> <span class="o">=</span> <span class="n">get_ts_dls</span><span class="p">(</span><span class="n">X_tfm</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">,</span> <span class="n">tfms</span><span class="o">=</span><span class="n">tfms</span><span class="p">,</span> <span class="n">batch_tfms</span><span class="o">=</span><span class="n">batch_tfms</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">ts_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">MiniRocket</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="n">ReduceLROnPlateau</span><span class="p">(</span><span class="n">factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">min_lr</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.693147</td>
      <td>0.526332</td>
      <td>0.754936</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.582386</td>
      <td>0.435147</td>
      <td>0.796748</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.508791</td>
      <td>0.368742</td>
      <td>0.828107</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.453322</td>
      <td>0.312181</td>
      <td>0.861789</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.407588</td>
      <td>0.262873</td>
      <td>0.893148</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.368118</td>
      <td>0.220747</td>
      <td>0.914053</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.333500</td>
      <td>0.185743</td>
      <td>0.944251</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.303107</td>
      <td>0.157302</td>
      <td>0.959350</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.276519</td>
      <td>0.134482</td>
      <td>0.973287</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.253316</td>
      <td>0.116239</td>
      <td>0.979094</td>
      <td>00:00</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MiniRocketClassifier" class="doc_header"><code>class</code> <code>MiniRocketClassifier</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/MINIROCKET.py#L136" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MiniRocketClassifier</code>() :: <code>Pipeline</code></p>
</blockquote>
<p>Pipeline of transforms with a final estimator.</p>
<p>Sequentially apply a list of transforms and a final estimator.
Intermediate steps of the pipeline must be 'transforms', that is, they
must implement fit and transform methods.
The final estimator only needs to implement fit.
The transformers in the pipeline can be cached using <code>memory</code> argument.</p>
<p>The purpose of the pipeline is to assemble several steps that can be
cross-validated together while setting different parameters.
For this, it enables setting parameters of the various steps using their
names and the parameter name separated by a '__', as in the example below.
A step's estimator may be replaced entirely by setting the parameter
with its name to another estimator, or a transformer removed by setting
it to 'passthrough' or <code>None</code>.</p>
<p>Read more in the :ref:<code>User Guide &lt;pipeline&gt;</code>.</p>
<p>.. versionadded:: 0.5</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>steps : list
    List of (name, transform) tuples (implementing fit/transform) that are
    chained, in the order in which they are chained, with the last object
    an estimator.</p>
<p>memory : str or object with the joblib.Memory interface, default=None
    Used to cache the fitted transformers of the pipeline. By default,
    no caching is performed. If a string is given, it is the path to
    the caching directory. Enabling caching triggers a clone of
    the transformers before fitting. Therefore, the transformer
    instance given to the pipeline cannot be inspected
    directly. Use the attribute <code>named_steps</code> or <code>steps</code> to
    inspect estimators within the pipeline. Caching the
    transformers is advantageous when fitting is time consuming.</p>
<p>verbose : bool, default=False
    If True, the time elapsed while fitting each step will be printed as it
    is completed.</p>
<h2 id="Attributes">Attributes<a class="anchor-link" href="#Attributes"> </a></h2><p>named_steps : :class:<code>~sklearn.utils.Bunch</code>
    Dictionary-like object, with the following attributes.
    Read-only attribute to access any step parameter by user given name.
    Keys are step names and values are steps parameters.</p>
<h2 id="See-Also">See Also<a class="anchor-link" href="#See-Also"> </a></h2><p>make_pipeline : Convenience function for simplified pipeline construction.</p>
<h2 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h2><blockquote><blockquote><blockquote><p>from sklearn.svm import SVC
from sklearn.preprocessing import StandardScaler
from sklearn.datasets import make_classification
from sklearn.model_selection import train_test_split
from sklearn.pipeline import Pipeline
X, y = make_classification(random_state=0)
X_train, X_test, y_train, y_test = train_test_split(X, y,
...                                                     random_state=0)
pipe = Pipeline([('scaler', StandardScaler()), ('svc', SVC())])</p>
<h1 id="The-pipeline-can-be-used-as-any-other-estimator">The pipeline can be used as any other estimator<a class="anchor-link" href="#The-pipeline-can-be-used-as-any-other-estimator"> </a></h1><h1 id="and-avoids-leaking-the-test-set-into-the-train-set">and avoids leaking the test set into the train set<a class="anchor-link" href="#and-avoids-leaking-the-test-set-into-the-train-set"> </a></h1><p>pipe.fit(X_train, y_train)
Pipeline(steps=[('scaler', StandardScaler()), ('svc', SVC())])
pipe.score(X_test, y_test)
0.88</p>
</blockquote>
</blockquote>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_minirocket" class="doc_header"><code>load_minirocket</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/MINIROCKET.py#L200" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_minirocket</code>(<strong><code>fname</code></strong>, <strong><code>path</code></strong>=<em><code>'./models'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MiniRocketRegressor" class="doc_header"><code>class</code> <code>MiniRocketRegressor</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/MINIROCKET.py#L174" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MiniRocketRegressor</code>() :: <code>Pipeline</code></p>
</blockquote>
<p>Pipeline of transforms with a final estimator.</p>
<p>Sequentially apply a list of transforms and a final estimator.
Intermediate steps of the pipeline must be 'transforms', that is, they
must implement fit and transform methods.
The final estimator only needs to implement fit.
The transformers in the pipeline can be cached using <code>memory</code> argument.</p>
<p>The purpose of the pipeline is to assemble several steps that can be
cross-validated together while setting different parameters.
For this, it enables setting parameters of the various steps using their
names and the parameter name separated by a '__', as in the example below.
A step's estimator may be replaced entirely by setting the parameter
with its name to another estimator, or a transformer removed by setting
it to 'passthrough' or <code>None</code>.</p>
<p>Read more in the :ref:<code>User Guide &lt;pipeline&gt;</code>.</p>
<p>.. versionadded:: 0.5</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>steps : list
    List of (name, transform) tuples (implementing fit/transform) that are
    chained, in the order in which they are chained, with the last object
    an estimator.</p>
<p>memory : str or object with the joblib.Memory interface, default=None
    Used to cache the fitted transformers of the pipeline. By default,
    no caching is performed. If a string is given, it is the path to
    the caching directory. Enabling caching triggers a clone of
    the transformers before fitting. Therefore, the transformer
    instance given to the pipeline cannot be inspected
    directly. Use the attribute <code>named_steps</code> or <code>steps</code> to
    inspect estimators within the pipeline. Caching the
    transformers is advantageous when fitting is time consuming.</p>
<p>verbose : bool, default=False
    If True, the time elapsed while fitting each step will be printed as it
    is completed.</p>
<h2 id="Attributes">Attributes<a class="anchor-link" href="#Attributes"> </a></h2><p>named_steps : :class:<code>~sklearn.utils.Bunch</code>
    Dictionary-like object, with the following attributes.
    Read-only attribute to access any step parameter by user given name.
    Keys are step names and values are steps parameters.</p>
<h2 id="See-Also">See Also<a class="anchor-link" href="#See-Also"> </a></h2><p>make_pipeline : Convenience function for simplified pipeline construction.</p>
<h2 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h2><blockquote><blockquote><blockquote><p>from sklearn.svm import SVC
from sklearn.preprocessing import StandardScaler
from sklearn.datasets import make_classification
from sklearn.model_selection import train_test_split
from sklearn.pipeline import Pipeline
X, y = make_classification(random_state=0)
X_train, X_test, y_train, y_test = train_test_split(X, y,
...                                                     random_state=0)
pipe = Pipeline([('scaler', StandardScaler()), ('svc', SVC())])</p>
<h1 id="The-pipeline-can-be-used-as-any-other-estimator">The pipeline can be used as any other estimator<a class="anchor-link" href="#The-pipeline-can-be-used-as-any-other-estimator"> </a></h1><h1 id="and-avoids-leaking-the-test-set-into-the-train-set">and avoids leaking the test set into the train set<a class="anchor-link" href="#and-avoids-leaking-the-test-set-into-the-train-set"> </a></h1><p>pipe.fit(X_train, y_train)
Pipeline(steps=[('scaler', StandardScaler()), ('svc', SVC())])
pipe.score(X_test, y_test)
0.88</p>
</blockquote>
</blockquote>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_minirocket" class="doc_header"><code>load_minirocket</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/MINIROCKET.py#L200" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_minirocket</code>(<strong><code>fname</code></strong>, <strong><code>path</code></strong>=<em><code>'./models'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MiniRocketVotingClassifier" class="doc_header"><code>class</code> <code>MiniRocketVotingClassifier</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/MINIROCKET.py#L209" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MiniRocketVotingClassifier</code>() :: <code>VotingClassifier</code></p>
</blockquote>
<p>Soft Voting/Majority Rule classifier for unfitted estimators.</p>
<p>Read more in the :ref:<code>User Guide &lt;voting_classifier&gt;</code>.</p>
<p>.. versionadded:: 0.17</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>estimators : list of (str, estimator) tuples
    Invoking the <code>fit</code> method on the <code>VotingClassifier</code> will fit clones
    of those original estimators that will be stored in the class attribute
    <code>self.estimators_</code>. An estimator can be set to <code>'drop'</code>
    using <code>set_params</code>.</p>

<pre><code>.. versionchanged:: 0.21
    ``'drop'`` is accepted. Using None was deprecated in 0.22 and
    support was removed in 0.24.

</code></pre>
<p>voting : {'hard', 'soft'}, default='hard'
    If 'hard', uses predicted class labels for majority rule voting.
    Else if 'soft', predicts the class label based on the argmax of
    the sums of the predicted probabilities, which is recommended for
    an ensemble of well-calibrated classifiers.</p>
<p>weights : array-like of shape (n_classifiers,), default=None
    Sequence of weights (<code>float</code> or <code>int</code>) to weight the occurrences of
    predicted class labels (<code>hard</code> voting) or class probabilities
    before averaging (<code>soft</code> voting). Uses uniform weights if <code>None</code>.</p>
<p>n_jobs : int, default=None
    The number of jobs to run in parallel for <code>fit</code>.
    <code>None</code> means 1 unless in a :obj:<code>joblib.parallel_backend</code> context.
    <code>-1</code> means using all processors. See :term:<code>Glossary &lt;n_jobs&gt;</code>
    for more details.</p>

<pre><code>.. versionadded:: 0.18

</code></pre>
<p>flatten_transform : bool, default=True
    Affects shape of transform output only when voting='soft'
    If voting='soft' and flatten_transform=True, transform method returns
    matrix with shape (n_samples, n_classifiers * n_classes). If
    flatten_transform=False, it returns
    (n_classifiers, n_samples, n_classes).</p>
<p>verbose : bool, default=False
    If True, the time elapsed while fitting will be printed as it
    is completed.</p>

<pre><code>.. versionadded:: 0.23

</code></pre>
<h2 id="Attributes">Attributes<a class="anchor-link" href="#Attributes"> </a></h2><p>estimators_ : list of classifiers
    The collection of fitted sub-estimators as defined in <code>estimators</code>
    that are not 'drop'.</p>
<p>named<em>estimators</em> : :class:<code>~sklearn.utils.Bunch</code>
    Attribute to access any fitted sub-estimators by name.</p>

<pre><code>.. versionadded:: 0.20

</code></pre>
<p>classes_ : array-like of shape (n_predictions,)
    The classes labels.</p>
<h2 id="See-Also">See Also<a class="anchor-link" href="#See-Also"> </a></h2><p>VotingRegressor : Prediction voting regressor.</p>
<h2 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h2><blockquote><blockquote><blockquote><p>import numpy as np
from sklearn.linear_model import LogisticRegression
from sklearn.naive_bayes import GaussianNB
from sklearn.ensemble import RandomForestClassifier, VotingClassifier
clf1 = LogisticRegression(multi_class='multinomial', random_state=1)
clf2 = RandomForestClassifier(n_estimators=50, random_state=1)
clf3 = GaussianNB()
X = np.array([[-1, -1], [-2, -1], [-3, -2], [1, 1], [2, 1], [3, 2]])
y = np.array([1, 1, 1, 2, 2, 2])
eclf1 = VotingClassifier(estimators=[
...         ('lr', clf1), ('rf', clf2), ('gnb', clf3)], voting='hard')
eclf1 = eclf1.fit(X, y)
print(eclf1.predict(X))
[1 1 1 2 2 2]
np.array_equal(eclf1.named<em>estimators</em>.lr.predict(X),
...                eclf1.named<em>estimators</em>['lr'].predict(X))
True
eclf2 = VotingClassifier(estimators=[
...         ('lr', clf1), ('rf', clf2), ('gnb', clf3)],
...         voting='soft')
eclf2 = eclf2.fit(X, y)
print(eclf2.predict(X))
[1 1 1 2 2 2]
eclf3 = VotingClassifier(estimators=[
...        ('lr', clf1), ('rf', clf2), ('gnb', clf3)],
...        voting='soft', weights=[2,1,1],
...        flatten_transform=True)
eclf3 = eclf3.fit(X, y)
print(eclf3.predict(X))
[1 1 1 2 2 2]
print(eclf3.transform(X).shape)
(6, 6)</p>
</blockquote>
</blockquote>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_minirocket_preds" class="doc_header"><code>get_minirocket_preds</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/MINIROCKET.py#L231" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_minirocket_preds</code>(<strong><code>X</code></strong>, <strong><code>fname</code></strong>, <strong><code>path</code></strong>=<em><code>'./models'</code></em>, <strong><code>model</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MiniRocketVotingRegressor" class="doc_header"><code>class</code> <code>MiniRocketVotingRegressor</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/models/MINIROCKET.py#L241" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MiniRocketVotingRegressor</code>() :: <code>VotingRegressor</code></p>
</blockquote>
<p>Prediction voting regressor for unfitted estimators.</p>
<p>A voting regressor is an ensemble meta-estimator that fits several base
regressors, each on the whole dataset. Then it averages the individual
predictions to form a final prediction.</p>
<p>Read more in the :ref:<code>User Guide &lt;voting_regressor&gt;</code>.</p>
<p>.. versionadded:: 0.21</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>estimators : list of (str, estimator) tuples
    Invoking the <code>fit</code> method on the <code>VotingRegressor</code> will fit clones
    of those original estimators that will be stored in the class attribute
    <code>self.estimators_</code>. An estimator can be set to <code>'drop'</code> using
    <code>set_params</code>.</p>

<pre><code>.. versionchanged:: 0.21
    ``'drop'`` is accepted. Using None was deprecated in 0.22 and
    support was removed in 0.24.

</code></pre>
<p>weights : array-like of shape (n_regressors,), default=None
    Sequence of weights (<code>float</code> or <code>int</code>) to weight the occurrences of
    predicted values before averaging. Uses uniform weights if <code>None</code>.</p>
<p>n_jobs : int, default=None
    The number of jobs to run in parallel for <code>fit</code>.
    <code>None</code> means 1 unless in a :obj:<code>joblib.parallel_backend</code> context.
    <code>-1</code> means using all processors. See :term:<code>Glossary &lt;n_jobs&gt;</code>
    for more details.</p>
<p>verbose : bool, default=False
    If True, the time elapsed while fitting will be printed as it
    is completed.</p>

<pre><code>.. versionadded:: 0.23

</code></pre>
<h2 id="Attributes">Attributes<a class="anchor-link" href="#Attributes"> </a></h2><p>estimators_ : list of regressors
    The collection of fitted sub-estimators as defined in <code>estimators</code>
    that are not 'drop'.</p>
<p>named<em>estimators</em> : Bunch
    Attribute to access any fitted sub-estimators by name.</p>

<pre><code>.. versionadded:: 0.20

</code></pre>
<h2 id="See-Also">See Also<a class="anchor-link" href="#See-Also"> </a></h2><p>VotingClassifier : Soft Voting/Majority Rule classifier.</p>
<h2 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h2><blockquote><blockquote><blockquote><p>import numpy as np
from sklearn.linear_model import LinearRegression
from sklearn.ensemble import RandomForestRegressor
from sklearn.ensemble import VotingRegressor
r1 = LinearRegression()
r2 = RandomForestRegressor(n_estimators=10, random_state=1)
X = np.array([[1, 1], [2, 4], [3, 9], [4, 16], [5, 25], [6, 36]])
y = np.array([2, 6, 12, 20, 30, 42])
er = VotingRegressor([('lr', r1), ('rf', r2)])
print(er.fit(X, y).predict(X))
[ 3.3  5.7 11.8 19.7 28.  40.3]</p>
</blockquote>
</blockquote>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dsid</span> <span class="o">=</span> <span class="s1">&#39;OliveOil&#39;</span>
<span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;MiniRocketClassifier&#39;</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">get_UCR_data</span><span class="p">(</span><span class="n">dsid</span><span class="p">)</span>
<span class="bp">cls</span> <span class="o">=</span> <span class="n">MiniRocketClassifier</span><span class="p">()</span>
<span class="bp">cls</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="bp">cls</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="n">pred</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="k">del</span> <span class="bp">cls</span>
<span class="bp">cls</span> <span class="o">=</span> <span class="n">load_minirocket</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">),</span> <span class="n">pred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dsid</span> <span class="o">=</span> <span class="s1">&#39;NATOPS&#39;</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">get_UCR_data</span><span class="p">(</span><span class="n">dsid</span><span class="p">)</span>
<span class="bp">cls</span> <span class="o">=</span> <span class="n">MiniRocketClassifier</span><span class="p">()</span>
<span class="bp">cls</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="bp">cls</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.9</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dsid</span> <span class="o">=</span> <span class="s1">&#39;NATOPS&#39;</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">get_UCR_data</span><span class="p">(</span><span class="n">dsid</span><span class="p">)</span>
<span class="bp">cls</span> <span class="o">=</span> <span class="n">MiniRocketVotingClassifier</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="bp">cls</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="bp">cls</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.9111111111111111</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="n">dsid</span> <span class="o">=</span> <span class="s1">&#39;Covid3Month&#39;</span>
<span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;MiniRocketRegressor&#39;</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">get_Monash_data</span><span class="p">(</span><span class="n">dsid</span><span class="p">)</span>
<span class="n">rmse_scorer</span> <span class="o">=</span> <span class="n">make_scorer</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">greater_is_better</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">reg</span> <span class="o">=</span> <span class="n">MiniRocketRegressor</span><span class="p">(</span><span class="n">scoring</span><span class="o">=</span><span class="n">rmse_scorer</span><span class="p">)</span>
<span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">reg</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="k">del</span> <span class="n">reg</span>
<span class="n">reg</span> <span class="o">=</span> <span class="n">load_minirocket</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">rmse</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.041647950237517425</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="n">dsid</span> <span class="o">=</span> <span class="s1">&#39;AppliancesEnergy&#39;</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">get_Monash_data</span><span class="p">(</span><span class="n">dsid</span><span class="p">)</span>
<span class="n">rmse_scorer</span> <span class="o">=</span> <span class="n">make_scorer</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">greater_is_better</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">reg</span> <span class="o">=</span> <span class="n">MiniRocketRegressor</span><span class="p">(</span><span class="n">scoring</span><span class="o">=</span><span class="n">rmse_scorer</span><span class="p">)</span>
<span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">reg</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="k">del</span> <span class="n">reg</span>
<span class="n">reg</span> <span class="o">=</span> <span class="n">load_minirocket</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">rmse</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>2.2571082932302287</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reg</span> <span class="o">=</span> <span class="n">MiniRocketVotingRegressor</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">rmse_scorer</span><span class="p">)</span>
<span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">rmse</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>2.2923262761032364</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

