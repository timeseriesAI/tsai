---

title: Metadatasets: a dataset of datasets


keywords: fastai
sidebar: home_sidebar

summary: "This functionality will allow you to create a dataset from data stores in multiple, smaller datasets."
description: "This functionality will allow you to create a dataset from data stores in multiple, smaller datasets."
nb_path: "nbs/002_data.metadatasets.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/002_data.metadatasets.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>I'd like to thank Xander Dunn and Thomas Capelle for the work they've done to make this possible. </li>
<li>This functionality allows you to use multiple numpy arrays instead of a single one, which may be very useful in many practical settings. I've tested it with 10k+ datasets and it works well. </li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TSMetaDataset" class="doc_header"><code>class</code> <code>TSMetaDataset</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/metadatasets.py#L12" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TSMetaDataset</code>(<strong><code>dataset_list</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>A dataset capable of indexing mutiple datasets at the same time!</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TSMetaDatasets" class="doc_header"><code>class</code> <code>TSMetaDatasets</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/metadatasets.py#L53" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TSMetaDatasets</code>(<strong><code>metadataset</code></strong>, <strong><code>splits</code></strong>) :: <code>FilteredBase</code></p>
</blockquote>
<p>Base class for lists with subsets</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's create 3 datasets. In this case they will have different sizes.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dsets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">size</span><span class="p">,))</span>
    <span class="n">tfms</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">TSClassification</span><span class="p">()]</span>
    <span class="n">dset</span> <span class="o">=</span> <span class="n">TSDatasets</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">tfms</span><span class="o">=</span><span class="n">tfms</span><span class="p">)</span>
    <span class="n">dsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dset</span><span class="p">)</span>
<span class="n">dsets</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(#130) [(TSTensor(vars:5, len:50), TensorCategory(0)),(TSTensor(vars:5, len:50), TensorCategory(91)),(TSTensor(vars:5, len:50), TensorCategory(28)),(TSTensor(vars:5, len:50), TensorCategory(103)),(TSTensor(vars:5, len:50), TensorCategory(92)),(TSTensor(vars:5, len:50), TensorCategory(111)),(TSTensor(vars:5, len:50), TensorCategory(8)),(TSTensor(vars:5, len:50), TensorCategory(67)),(TSTensor(vars:5, len:50), TensorCategory(42)),(TSTensor(vars:5, len:50), TensorCategory(9))...],
 (#62) [(TSTensor(vars:5, len:50), TensorCategory(46)),(TSTensor(vars:5, len:50), TensorCategory(25)),(TSTensor(vars:5, len:50), TensorCategory(8)),(TSTensor(vars:5, len:50), TensorCategory(47)),(TSTensor(vars:5, len:50), TensorCategory(9)),(TSTensor(vars:5, len:50), TensorCategory(57)),(TSTensor(vars:5, len:50), TensorCategory(60)),(TSTensor(vars:5, len:50), TensorCategory(26)),(TSTensor(vars:5, len:50), TensorCategory(27)),(TSTensor(vars:5, len:50), TensorCategory(35))...],
 (#129) [(TSTensor(vars:5, len:50), TensorCategory(115)),(TSTensor(vars:5, len:50), TensorCategory(20)),(TSTensor(vars:5, len:50), TensorCategory(67)),(TSTensor(vars:5, len:50), TensorCategory(68)),(TSTensor(vars:5, len:50), TensorCategory(51)),(TSTensor(vars:5, len:50), TensorCategory(21)),(TSTensor(vars:5, len:50), TensorCategory(52)),(TSTensor(vars:5, len:50), TensorCategory(32)),(TSTensor(vars:5, len:50), TensorCategory(116)),(TSTensor(vars:5, len:50), TensorCategory(0))...]]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">metadataset</span> <span class="o">=</span> <span class="n">TSMetaDataset</span><span class="p">(</span><span class="n">dsets</span><span class="p">)</span>
<span class="n">metadataset</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;__main__.TSMetaDataset at 0x7fa7613f3c10&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll apply splits now to create train and valid metadatasets:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splits</span> <span class="o">=</span> <span class="n">TimeSplitter</span><span class="p">()(</span><span class="n">metadataset</span><span class="p">)</span>
<span class="n">splits</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((#257) [0,1,2,3,4,5,6,7,8,9...],
 (#64) [257,258,259,260,261,262,263,264,265,266...])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">metadatasets</span> <span class="o">=</span> <span class="n">TSMetaDatasets</span><span class="p">(</span><span class="n">metadataset</span><span class="p">,</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">)</span>
<span class="n">metadatasets</span><span class="o">.</span><span class="n">train</span><span class="p">,</span> <span class="n">metadatasets</span><span class="o">.</span><span class="n">valid</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&lt;__main__.TSMetaDataset at 0x7fa7612d9d50&gt;,
 &lt;__main__.TSMetaDataset at 0x7fa7612d9c50&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">TSDataLoaders</span><span class="o">.</span><span class="n">from_dsets</span><span class="p">(</span><span class="n">metadatasets</span><span class="o">.</span><span class="n">train</span><span class="p">,</span> <span class="n">metadatasets</span><span class="o">.</span><span class="n">valid</span><span class="p">)</span>
<span class="n">xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">first</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="p">)</span>
<span class="n">xb</span><span class="p">,</span> <span class="n">yb</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(TSTensor(samples:64, vars:5, len:50),
 TensorCategory([ 89, 128,  69,  34,  47, 117,  33,  67,  82,  95,  45,  97,  43,  52,
          30,  17, 126,  22,  57, 114,  14,  54,  41,  65,  94,   0, 112,  55,
          45,  40,  50,   6,  46,  26,  27,  10,   9,  52,  11,  43,  57,  32,
          24,  21,  39,  84,  12,  56,  87,  13,  34,  24,  32, 106,  52,  82,
          11,  88,  22,   1,  20,  85,  55,  43]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There also en easy way to map any particular sample in a batch to the original dataset and id:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">TSDataLoaders</span><span class="o">.</span><span class="n">from_dsets</span><span class="p">(</span><span class="n">metadatasets</span><span class="o">.</span><span class="n">train</span><span class="p">,</span> <span class="n">metadatasets</span><span class="o">.</span><span class="n">valid</span><span class="p">)</span>
<span class="n">xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">first</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="p">)</span>
<span class="n">mappings</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">mapping_idxs</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">xbi</span><span class="p">,</span> <span class="n">ybi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">)):</span>
    <span class="n">ds</span><span class="p">,</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">mappings</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">test_close</span><span class="p">(</span><span class="n">dsets</span><span class="p">[</span><span class="n">ds</span><span class="p">][</span><span class="n">idx</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">xbi</span><span class="p">)</span>
    <span class="n">test_close</span><span class="p">(</span><span class="n">dsets</span><span class="p">[</span><span class="n">ds</span><span class="p">][</span><span class="n">idx</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">ybi</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For example the 3rd sample in this batch would be:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">mapping_idxs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([  0, 123], dtype=int32)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

