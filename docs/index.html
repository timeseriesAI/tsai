---

title: tsai


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://github.com/timeseriesai/tsai/workflows/CI/badge.svg" alt="CI"> <a href="https://pypi.org/project/tsai/#description"><img src="https://img.shields.io/pypi/v/tsai?color=blue&amp;label=pypi%20version" alt="PyPI"></a> <img src="https://img.shields.io/badge/PRs-welcome-brightgreen.svg" alt="PRs"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Description">Description<a class="anchor-link" href="#Description"> </a></h2><blockquote><p>State-of-the-art Deep Learning library for Time Series and Sequences.</p>
</blockquote>
<p><code>tsai</code> is an open-source deep learning package built on top of Pytorch &amp; fastai focused on state-of-the-art techniques for time series tasks like classification, regression, forecasting, imputation...</p>
<p><code>tsai</code> is currently under active development by timeseriesAI.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="New-in-tsai:">New in tsai:<a class="anchor-link" href="#New-in-tsai:"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="September,-2021">September, 2021<a class="anchor-link" href="#September,-2021"> </a></h4><ul>
<li><p>ðŸš€ðŸš€ New tutorial notebook on how to <strong>train your model with larger-than-memory datasets in less time achieving 100% GPU usage!!</strong> ðŸš€ðŸš€   <a href="https://colab.research.google.com/github/timeseriesAI/tsai/blob/master/tutorial_nbs/11_How_to_train_big_arrays_fast_in_tsai.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
</li>
<li><p><strong><code>tsai</code> supports now more input formats</strong>: np.array, np.memmap, zarr, xarray, dask, list, L, ...</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Previously">Previously<a class="anchor-link" href="#Previously"> </a></h4><ul>
<li><p><strong>MINIROCKET</strong> a SOTA Time Series Classification model (now available in Pytorch):
You can now check MiniRocket's performance in our new tutorial notebook <a href="https://colab.research.google.com/github/timeseriesAI/tsai/blob/master/tutorial_nbs/10_Time_Series_Classification_and_Regression_with_MiniRocket.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<blockquote><p>"Using this method, it is possible to train and test a classifier on all of 109 datasets from the UCR archive to state-of-the-art accuracy in less than 10 minutes." A. Dempster et al. (Dec 2020)</p>
</blockquote>
</li>
<li><p><strong>Multi-class and multi-label time series classification notebook:</strong> you can also check our new tutorial notebook: <a href="https://colab.research.google.com/github/timeseriesAI/tsai/blob/master/tutorial_nbs/01a_MultiClass_MultiLabel_TSClassification.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
</li>
<li><p><strong>Self-supervised learning:</strong> Learn how to leverage your unlabeled datasets <a href="https://colab.research.google.com/github/timeseriesAI/tsai/blob/master/tutorial_nbs/08_Self_Supervised_TSBERT.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
</li>
<li><p><strong>New visualization:</strong>
We've also added a new PredictionDynamics callback that will display the predictions during training. This is the type of output you would get in a classification task for example:</p>
<p align="center">
  <img src="https://github.com/timeseriesAI/tsai/blob/main/nbs/multimedia/LSST_PD.gif?raw=true">
</p></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Installation">Installation<a class="anchor-link" href="#Installation"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can install the <strong>latest stable</strong> version from pip using:</p>

<pre><code>pip install tsai</code></pre>
<p>Or you can install the cutting edge version of this library from github by doing:</p>

<pre><code>pip install -Uqq git+https://github.com/timeseriesAI/tsai.git</code></pre>
<p>Once the install is complete, you should restart your runtime and then run:</p>

<pre><code>from tsai.all import *</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Documentation">Documentation<a class="anchor-link" href="#Documentation"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here's the link to the <a href="https://timeseriesai.github.io/tsai/">documentation</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Available-models:">Available models:<a class="anchor-link" href="#Available-models:"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here's a list with some of the state-of-the-art models available in <code>tsai</code>:</p>
<ul>
<li><a href="https://ieeexplore.ieee.org/abstract/document/6795963/">LSTM</a> (Hochreiter, 1997)</li>
<li><a href="https://arxiv.org/abs/1412.3555">GRU</a> (Cho, 2014)</li>
<li><a href="https://arxiv.org/abs/1611.06455">MLP</a> - Multilayer Perceptron (Wang, 2016)</li>
<li><a href="https://arxiv.org/abs/1611.06455">FCN</a> - Fully Convolutional Network (Wang, 2016)</li>
<li><a href="https://arxiv.org/abs/1611.06455">ResNet</a> - Residual Network (Wang, 2016)</li>
<li><a href="https://arxiv.org/abs/1709.05206">LSTM-FCN</a> (Karim, 2017)</li>
<li><a href="https://arxiv.org/abs/1812.07683">GRU-FCN</a> (Elsayed, 2018)</li>
<li><a href="https://www.sciencedirect.com/science/article/abs/pii/S0893608019301200">MLSTM-FCN</a> - Multivariate LSTM-FCN (Karim, 2019)</li>
<li><a href="https://arxiv.org/abs/1909.04939">InceptionTime</a> (Fawaz, 2019)</li>
<li><a href="https://arxiv.org/abs/1910.13051">Rocket</a> (Dempster, 2019)</li>
<li><a href="https://arxiv.org/abs/2002.10061">OmniScale</a> - Omni-Scale 1D-CNN (Tang, 2020)</li>
<li><p><a href="https://arxiv.org/abs/2102.00457">MiniRocket</a> (Dempster, 2021)</p>
</li>
<li><p><a href="https://www.sciencedirect.com/science/article/abs/pii/S0925231220305944">ResCNN</a> - 1D-ResCNN (Sun , 2020)</p>
</li>
<li><a href="https://arxiv.org/abs/1803.01271">TCN</a> - Temporal Convolutional Network (Bai, 2018)</li>
<li><a href="https://dl.acm.org/doi/abs/10.1145/3447548.3467401">TST</a> - Time Series Transformer (Zerveas, 2021)</li>
<li><a href="https://docs.fast.ai/tabular.model.html#TabularModel">TabModel</a> - modified from fastai's TabularModel</li>
<li><a href="https://arxiv.org/pdf/2012.06678">TabTransformer</a> (Huang, 2020)</li>
<li><a href="https://arxiv.org/abs/2005.03645">XCM</a> - Explainable Convolutional Neural Network) (Fauvel, 2020)</li>
<li><a href="https://arxiv.org/abs/1911.03803">XceptionTime</a> (Rahimian, 2019)</li>
<li><a href="https://dl.acm.org/doi/abs/10.1145/3219819.3220060">mWDN</a> - Multilevel wavelet decomposition network (Wang, 2018)</li>
</ul>
<p>among others!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-start-using-tsai?">How to start using tsai?<a class="anchor-link" href="#How-to-start-using-tsai?"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To get to know the tsai package, we'd suggest you start with this notebook in Google Colab: <strong><a href="https://colab.research.google.com/github/timeseriesAI/tsai/blob/master/tutorial_nbs/01_Intro_to_Time_Series_Classification.ipynb">01_Intro_to_Time_Series_Classification</a></strong>
It provides an overview of a time series classification task.</p>
<p>We have also develop many other <a href="https://github.com/timeseriesAI/tsai/tree/main/tutorial_nbs">tutorial notebooks</a>.</p>
<p>To use tsai in your own notebooks, the only thing you need to do after you have installed the package is to run this:</p>
<p><code>from tsai.all import *</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>These are just a few examples of how you can use <code>tsai</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Binary,-univariate-classification">Binary, univariate classification<a class="anchor-link" href="#Binary,-univariate-classification"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>from tsai.all import *
X, y, splits = get_classification_data('ECG200', split_data=False)
tfms = [None, TSClassification()]
batch_tfms = TSStandardize()
dls = get_ts_dls(X, y, splits=splits, tfms=tfms, batch_tfms=batch_tfms)
learn = ts_learner(dls, InceptionTimePlus, metrics=accuracy, cbs=ShowGraph())
learn.fit_one_cycle(100, 3e-4)</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Multi-class,-multivariate-classification">Multi-class, multivariate classification<a class="anchor-link" href="#Multi-class,-multivariate-classification"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>from tsai.all import *
X, y, splits = get_classification_data('LSST', split_data=False)
tfms = [None, TSClassification()]
batch_tfms = TSStandardize(by_sample=True)
dls = get_ts_dls(X, y, splits=splits, tfms=tfms, batch_tfms=batch_tfms)
learn = ts_learner(dls, InceptionTimePlus, metrics=accuracy, cbs=ShowGraph())
learn.fit_one_cycle(10, 1e-2)</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Multivariate-Regression">Multivariate Regression<a class="anchor-link" href="#Multivariate-Regression"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>from tsai.all import *
from sklearn.metrics import mean_squared_error
X_train, y_train, X_test, y_test = get_regression_data('AppliancesEnergy')
rmse_scorer = make_scorer(mean_squared_error, greater_is_better=False)
reg = MiniRocketRegressor(scoring=rmse_scorer)
reg.fit(X_train, y_train)
y_pred = reg.predict(X_test)
mean_squared_error(y_test, y_pred, squared=False)</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Univariate-Forecasting">Univariate Forecasting<a class="anchor-link" href="#Univariate-Forecasting"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>from tsai.all import *
ts = get_forecasting_time_series("Sunspots").values
X, y = SlidingWindow(60, horizon=1)(ts)
splits = TimeSplitter(235)(y) 
batch_tfms = TSStandardize()
learn = TSForecaster(X, y, splits=splits, batch_tfms=batch_tfms, bs=512, arch=TST, metrics=mae, cbs=ShowGraph())
learn.fit_one_cycle(50, 1e-3)</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-contribute-to-tsai?">How to contribute to tsai?<a class="anchor-link" href="#How-to-contribute-to-tsai?"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We welcome contributions of all kinds. Development of enhancements, bug fixes, documentation, tutorial notebooks, ...</p>
<p>We have created a guide to help you start contributing to tsai. You can read it <a href="https://github.com/timeseriesAI/tsai/blob/main/CONTRIBUTING.md">here</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Citing-tsai">Citing tsai<a class="anchor-link" href="#Citing-tsai"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you use tsai in your research please use the following BibTeX entry:</p>
<div class="highlight"><pre><span></span>@Misc{tsai,
    author =       {Ignacio Oguiza},
    title =        {tsai - A state-of-the-art deep learning library for time series and sequential data},
    howpublished = {Github},
    year =         {2020},
    url =          {https://github.com/timeseriesAI/tsai}
}
</pre></div>

</div>
</div>
</div>
</div>
 

