---

title: Data preparation


keywords: fastai
sidebar: home_sidebar

summary: "Functions required to prepare X (and y) from a pandas dataframe."
description: "Functions required to prepare X (and y) from a pandas dataframe."
nb_path: "nbs/000c_data.preparation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/000c_data.preparation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="df2xy" class="doc_header"><code>df2xy</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/preparation.py#L11" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>df2xy</code>(<strong><code>df</code></strong>, <strong><code>feat_col</code></strong>=<em><code>None</code></em>, <strong><code>target_col</code></strong>=<em><code>None</code></em>, <strong><code>data_cols</code></strong>=<em><code>None</code></em>, <strong><code>to3d</code></strong>=<em><code>True</code></em>, <strong><code>splits</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>This function allows you to transform a pandas dataframe into X and y numpy arrays that can be used to craete a TSDataset.
feat_col: used for multivariate datasets. It indicates which is the column that indicates the feature by row.
target_col: indicates the column/s where the target is.
data_col: indicates where the data is located. If None, it means all columns (excpet the target)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="split_xy" class="doc_header"><code>split_xy</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/preparation.py#L36" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>split_xy</code>(<strong><code>X</code></strong>, <strong><code>y</code></strong>=<em><code>None</code></em>, <strong><code>splits</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="SlidingWindow" class="doc_header"><code>SlidingWindow</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/preparation.py#L56" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>SlidingWindow</code>(<strong><code>window_len</code></strong>:<code>int</code>, <strong><code>stride</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>]=<em><code>1</code></em>, <strong><code>start</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>get_x</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>get_y</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>y_func</code></strong>:<code>Optional</code>[<code>callable</code>]=<em><code>None</code></em>, <strong><code>horizon</code></strong>:<code>Union</code>[<code>int</code>, <code>list</code>]=<em><code>1</code></em>, <strong><code>seq_first</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>sort_by</code></strong>:<code>Optional</code>[<code>list</code>]=<em><code>None</code></em>, <strong><code>ascending</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>check_leakage</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Applies a sliding window to a 1d or 2d input (np.ndarray, torch.Tensor or pd.DataFrame)</p>
<p>Args:
    window_len      = length of lookback window
    stride          = n datapoints the window is moved ahead along the sequence. Default: 1. If None, stride=window_len (no overlap)
    start           = determines the step where the first window is applied: 0 (default), a given step (int), or random within the 1st stride (None).
    horizon         = number of future datapoints to predict:</p>

<pre><code>                    * 0 for last step in each sub-window.
                    * n &gt; 0 for a range of n future steps (1 to n).
                    * n &lt; 0 for a range of n past steps (-n + 1 to 0).
                    * list : for those exact timesteps.
get_x           = indices of columns that contain the independent variable (xs). If None, all data will be used as x.
get_y           = indices of columns that contain the target (ys). If None, all data will be used as y. [] means no y data is created.
y_func          = function to calculate the ys based on the get_y col/s and each y sub-window. y_func must be a function applied to axis=1!
seq_first       = True if input shape (seq_len, n_vars), False if input shape (n_vars, seq_len)
sort_by         = column/s used for sorting the array in ascending order
ascending       = used in sorting
check_leakage   = checks if there's leakage in the output between X and y


</code></pre>
<p>Input:
    You can use np.ndarray, pd.DataFrame or torch.Tensor as input
    shape: (seq_len, ) or (seq_len, n_vars) if seq_first=True else (n_vars, seq_len)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#5) [(array([[0, 1, 2, 3, 4]]),),(array([[1, 2, 3, 4, 5]]),),(array([[2, 3, 4, 5, 6]]),),(array([[3, 4, 5, 6, 7]]),),(array([[4, 5, 6, 7, 8]]),)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
[(array([[0, 1, 2, 3, 4]]), 5), (array([[1, 2, 3, 4, 5]]), 6), (array([[2, 3, 4, 5, 6]]), 7), (array([[3, 4, 5, 6, 7]]), 8), (array([[4, 5, 6, 7, 8]]), 9)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), 5), (array([[3, 4, 5, 6, 7]]), 8)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">start</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
[(array([[3, 4, 5, 6, 7]]), 8), (array([[ 8,  9, 10, 11, 12]]), 13), (array([[13, 14, 15, 16, 17]]), 18)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[5, 6, 7, 8, 9]]), 10), (array([[10, 11, 12, 13, 14]]), 15)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[1, 2, 3, 4, 5]]), 6), (array([[2, 3, 4, 5, 6]]), 7), (array([[3, 4, 5, 6, 7]]), 8), (array([[4, 5, 6, 7, 8]]), 9), (array([[5, 6, 7, 8, 9]]), 10), (array([[ 6,  7,  8,  9, 10]]), 11), (array([[ 7,  8,  9, 10, 11]]), 12), (array([[ 8,  9, 10, 11, 12]]), 13), (array([[ 9, 10, 11, 12, 13]]), 14), (array([[10, 11, 12, 13, 14]]), 15), (array([[11, 12, 13, 14, 15]]), 16), (array([[12, 13, 14, 15, 16]]), 17), (array([[13, 14, 15, 16, 17]]), 18), (array([[14, 15, 16, 17, 18]]), 19)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
      <td>16</td>
      <td>17</td>
      <td>18</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[5, 6, 7, 8, 9]]), 10), (array([[10, 11, 12, 13, 14]]), 15)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[  0,   1,   2,   3,   4],
       [  0,  10,  20,  30,  40],
       [  0, 100, 200, 300, 400]]), 5), (array([[  1,   2,   3,   4,   5],
       [ 10,  20,  30,  40,  50],
       [100, 200, 300, 400, 500]]), 6), (array([[  2,   3,   4,   5,   6],
       [ 20,  30,  40,  50,  60],
       [200, 300, 400, 500, 600]]), 7), (array([[  3,   4,   5,   6,   7],
       [ 30,  40,  50,  60,  70],
       [300, 400, 500, 600, 700]]), 8), (array([[  4,   5,   6,   7,   8],
       [ 40,  50,  60,  70,  80],
       [400, 500, 600, 700, 800]]), 9)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[ 0,  1,  2,  3,  4],
       [ 0, 10, 20, 30, 40]]), 500), (array([[ 1,  2,  3,  4,  5],
       [10, 20, 30, 40, 50]]), 600), (array([[ 2,  3,  4,  5,  6],
       [20, 30, 40, 50, 60]]), 700), (array([[ 3,  4,  5,  6,  7],
       [30, 40, 50, 60, 70]]), 800), (array([[ 4,  5,  6,  7,  8],
       [40, 50, 60, 70, 80]]), 900)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(1000, 3)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(200, 2, 5) (200,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 3)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.325867</td>
      <td>-0.241592</td>
      <td>-0.336040</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.458959</td>
      <td>-0.023682</td>
      <td>-0.345254</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.551359</td>
      <td>-0.310443</td>
      <td>-0.008278</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.224780</td>
      <td>-0.288891</td>
      <td>0.082255</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.553293</td>
      <td>-0.494674</td>
      <td>0.559463</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>-4.341635</td>
      <td>-3.986960</td>
      <td>2.715404</td>
    </tr>
    <tr>
      <th>96</th>
      <td>-4.311182</td>
      <td>-3.835794</td>
      <td>2.710808</td>
    </tr>
    <tr>
      <th>97</th>
      <td>-3.945106</td>
      <td>-3.990006</td>
      <td>2.830001</td>
    </tr>
    <tr>
      <th>98</th>
      <td>-4.024598</td>
      <td>-4.432418</td>
      <td>3.272157</td>
    </tr>
    <tr>
      <th>99</th>
      <td>-3.557724</td>
      <td>-3.962729</td>
      <td>3.522957</td>
    </tr>
  </tbody>
</table>
<p>100 rows  3 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 2, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.338920</td>
      <td>0.374818</td>
      <td>-0.347811</td>
      <td>-0.180589</td>
      <td>-0.212375</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.785688</td>
      <td>0.315562</td>
      <td>-0.184148</td>
      <td>-0.254088</td>
      <td>-0.700131</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.542888</td>
      <td>0.572317</td>
      <td>0.048377</td>
      <td>-0.056302</td>
      <td>-0.986715</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.853822</td>
      <td>0.656248</td>
      <td>0.072192</td>
      <td>0.025737</td>
      <td>-1.060637</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.217241</td>
      <td>0.191873</td>
      <td>0.462884</td>
      <td>-0.153288</td>
      <td>-0.784310</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>-3.567543</td>
      <td>-3.875623</td>
      <td>-1.160792</td>
      <td>0.086162</td>
      <td>0.209708</td>
    </tr>
    <tr>
      <th>96</th>
      <td>-3.844895</td>
      <td>-3.398627</td>
      <td>-1.566155</td>
      <td>-0.011390</td>
      <td>0.080432</td>
    </tr>
    <tr>
      <th>97</th>
      <td>-4.109241</td>
      <td>-3.800927</td>
      <td>-1.408160</td>
      <td>0.391974</td>
      <td>0.260927</td>
    </tr>
    <tr>
      <th>98</th>
      <td>-4.570116</td>
      <td>-3.714575</td>
      <td>-1.865865</td>
      <td>0.000578</td>
      <td>-0.010621</td>
    </tr>
    <tr>
      <th>99</th>
      <td>-4.537011</td>
      <td>-3.545000</td>
      <td>-1.959837</td>
      <td>0.025508</td>
      <td>-0.447785</td>
    </tr>
  </tbody>
</table>
<p>100 rows  5 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 4, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var_0</th>
      <td>0.208159</td>
      <td>0.121639</td>
      <td>-0.111770</td>
      <td>-0.348626</td>
      <td>-0.721566</td>
      <td>-0.920240</td>
      <td>-0.628238</td>
      <td>-0.860718</td>
      <td>-0.998984</td>
      <td>-1.184036</td>
      <td>...</td>
      <td>-1.309434</td>
      <td>-1.315028</td>
      <td>-1.181752</td>
      <td>-0.852826</td>
      <td>-0.482351</td>
      <td>-0.561457</td>
      <td>-1.056451</td>
      <td>-1.217763</td>
      <td>-0.955553</td>
      <td>-1.042602</td>
    </tr>
    <tr>
      <th>var_1</th>
      <td>-0.056895</td>
      <td>-0.005236</td>
      <td>-0.073409</td>
      <td>0.302899</td>
      <td>-0.022563</td>
      <td>-0.030798</td>
      <td>0.380316</td>
      <td>0.034357</td>
      <td>0.527544</td>
      <td>1.000217</td>
      <td>...</td>
      <td>2.591913</td>
      <td>2.455563</td>
      <td>2.402356</td>
      <td>2.322268</td>
      <td>2.692155</td>
      <td>2.208566</td>
      <td>1.824009</td>
      <td>1.361122</td>
      <td>1.745993</td>
      <td>1.335954</td>
    </tr>
    <tr>
      <th>var_2</th>
      <td>-0.377276</td>
      <td>-0.124257</td>
      <td>-0.023535</td>
      <td>-0.507306</td>
      <td>-0.906496</td>
      <td>-0.697180</td>
      <td>-0.752462</td>
      <td>-0.266087</td>
      <td>-0.665554</td>
      <td>-0.289239</td>
      <td>...</td>
      <td>0.883918</td>
      <td>1.221540</td>
      <td>0.784092</td>
      <td>1.136465</td>
      <td>1.600795</td>
      <td>1.412935</td>
      <td>0.922077</td>
      <td>0.979359</td>
      <td>0.985196</td>
      <td>1.181308</td>
    </tr>
    <tr>
      <th>var_3</th>
      <td>-0.122437</td>
      <td>-0.199902</td>
      <td>-0.463992</td>
      <td>-0.491451</td>
      <td>-0.975486</td>
      <td>-0.625616</td>
      <td>-1.017216</td>
      <td>-0.695675</td>
      <td>-0.558810</td>
      <td>-0.792139</td>
      <td>...</td>
      <td>1.090325</td>
      <td>0.706049</td>
      <td>0.296831</td>
      <td>-0.010458</td>
      <td>-0.113163</td>
      <td>-0.275170</td>
      <td>0.087550</td>
      <td>-0.288932</td>
      <td>-0.117050</td>
      <td>-0.256382</td>
    </tr>
    <tr>
      <th>target</th>
      <td>-0.486337</td>
      <td>-0.636510</td>
      <td>-1.032639</td>
      <td>-0.613554</td>
      <td>-0.689197</td>
      <td>-0.924929</td>
      <td>-0.812763</td>
      <td>-0.677262</td>
      <td>-0.488086</td>
      <td>-0.343819</td>
      <td>...</td>
      <td>0.268680</td>
      <td>0.566691</td>
      <td>0.888394</td>
      <td>1.164064</td>
      <td>1.033669</td>
      <td>0.706534</td>
      <td>1.004192</td>
      <td>0.969819</td>
      <td>1.465600</td>
      <td>0.995822</td>
    </tr>
  </tbody>
</table>
<p>5 rows  100 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 4, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var_0</th>
      <td>-0.342277</td>
      <td>-0.215252</td>
      <td>-0.335300</td>
      <td>-0.428961</td>
      <td>-0.878715</td>
      <td>-1.040178</td>
      <td>-1.220249</td>
      <td>-1.606998</td>
      <td>-1.693734</td>
      <td>-1.333678</td>
      <td>...</td>
      <td>-4.154211</td>
      <td>-4.258333</td>
      <td>-4.587838</td>
      <td>-4.253488</td>
      <td>-4.279988</td>
      <td>-4.062902</td>
      <td>-4.366056</td>
      <td>-4.830003</td>
      <td>-5.293462</td>
      <td>-5.277452</td>
    </tr>
    <tr>
      <th>var_1</th>
      <td>-0.257477</td>
      <td>-0.378775</td>
      <td>-0.354091</td>
      <td>-0.656923</td>
      <td>-0.722162</td>
      <td>-0.914954</td>
      <td>-0.812703</td>
      <td>-1.008407</td>
      <td>-1.077944</td>
      <td>-0.604380</td>
      <td>...</td>
      <td>-1.893046</td>
      <td>-1.554264</td>
      <td>-1.171076</td>
      <td>-1.445768</td>
      <td>-1.376466</td>
      <td>-1.714144</td>
      <td>-1.607729</td>
      <td>-1.413078</td>
      <td>-1.508314</td>
      <td>-1.840452</td>
    </tr>
    <tr>
      <th>var_2</th>
      <td>-0.085276</td>
      <td>0.171488</td>
      <td>-0.126830</td>
      <td>-0.353355</td>
      <td>0.003366</td>
      <td>-0.423026</td>
      <td>-0.149475</td>
      <td>-0.620689</td>
      <td>-0.565835</td>
      <td>-0.548638</td>
      <td>...</td>
      <td>-0.632271</td>
      <td>-0.644472</td>
      <td>-0.367830</td>
      <td>-0.190198</td>
      <td>-0.209749</td>
      <td>-0.525387</td>
      <td>-1.014539</td>
      <td>-0.561502</td>
      <td>-1.027064</td>
      <td>-1.356208</td>
    </tr>
    <tr>
      <th>var_3</th>
      <td>-0.000659</td>
      <td>0.209832</td>
      <td>0.089676</td>
      <td>-0.196499</td>
      <td>-0.694834</td>
      <td>-0.981985</td>
      <td>-1.435736</td>
      <td>-1.339862</td>
      <td>-0.895544</td>
      <td>-0.860503</td>
      <td>...</td>
      <td>-3.146264</td>
      <td>-2.921157</td>
      <td>-2.756359</td>
      <td>-2.997815</td>
      <td>-3.270306</td>
      <td>-3.325625</td>
      <td>-3.725113</td>
      <td>-3.467922</td>
      <td>-3.276509</td>
      <td>-3.162510</td>
    </tr>
    <tr>
      <th>target</th>
      <td>0.158254</td>
      <td>0.414816</td>
      <td>0.626924</td>
      <td>0.643761</td>
      <td>0.240074</td>
      <td>0.733933</td>
      <td>0.447878</td>
      <td>0.661436</td>
      <td>1.124200</td>
      <td>1.589677</td>
      <td>...</td>
      <td>-0.871659</td>
      <td>-0.422195</td>
      <td>-0.288678</td>
      <td>-0.714503</td>
      <td>-1.020377</td>
      <td>-1.119863</td>
      <td>-1.181825</td>
      <td>-1.110538</td>
      <td>-1.259983</td>
      <td>-1.337979</td>
    </tr>
  </tbody>
</table>
<p>5 rows  100 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(20, 4, 5) (20,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">TrainValidTestSplitter</span><span class="p">(</span><span class="n">valid_size</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">y</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">splits</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.256641</td>
      <td>0.340227</td>
      <td>-0.070226</td>
      <td>-0.016320</td>
      <td>0.460408</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.500643</td>
      <td>-0.135028</td>
      <td>0.371040</td>
      <td>-0.298353</td>
      <td>0.449500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.611587</td>
      <td>0.047017</td>
      <td>0.585039</td>
      <td>-0.778481</td>
      <td>0.760795</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.069282</td>
      <td>0.328528</td>
      <td>0.238354</td>
      <td>-0.324294</td>
      <td>0.474543</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.197616</td>
      <td>0.518850</td>
      <td>0.725770</td>
      <td>-0.719295</td>
      <td>0.841722</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>-3.586983</td>
      <td>1.054010</td>
      <td>-0.130225</td>
      <td>-4.119685</td>
      <td>2.236999</td>
    </tr>
    <tr>
      <th>96</th>
      <td>-3.410662</td>
      <td>1.305357</td>
      <td>-0.509600</td>
      <td>-4.471474</td>
      <td>2.024296</td>
    </tr>
    <tr>
      <th>97</th>
      <td>-3.352418</td>
      <td>1.140065</td>
      <td>-0.039942</td>
      <td>-4.294297</td>
      <td>1.658502</td>
    </tr>
    <tr>
      <th>98</th>
      <td>-2.856297</td>
      <td>0.878434</td>
      <td>0.380963</td>
      <td>-4.384769</td>
      <td>1.448121</td>
    </tr>
    <tr>
      <th>99</th>
      <td>-2.456972</td>
      <td>1.285689</td>
      <td>0.443241</td>
      <td>-4.670946</td>
      <td>1.279513</td>
    </tr>
  </tbody>
</table>
<p>100 rows  5 columns</p>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((96, 4, 5),
 (96,),
 ((#77) [0,1,2,3,4,5,6,7,8,9...], (#19) [77,78,79,80,81,82,83,84,85,86...]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="SlidingWindowPanel" class="doc_header"><code>SlidingWindowPanel</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/preparation.py#L133" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>SlidingWindowPanel</code>(<strong><code>window_len</code></strong>:<code>int</code>, <strong><code>unique_id_cols</code></strong>:<code>list</code>, <strong><code>stride</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>]=<em><code>1</code></em>, <strong><code>start</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>get_x</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>get_y</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>y_func</code></strong>:<code>Optional</code>[<code>callable</code>]=<em><code>None</code></em>, <strong><code>horizon</code></strong>:<code>Union</code>[<code>int</code>, <code>list</code>]=<em><code>1</code></em>, <strong><code>seq_first</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>sort_by</code></strong>:<code>Optional</code>[<code>list</code>]=<em><code>None</code></em>, <strong><code>ascending</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>check_leakage</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>return_key</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>verbose</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Applies a sliding window to a pd.DataFrame.</p>
<p>Args:
    window_len      = length of lookback window
    unique_id_cols  = pd.DataFrame columns that will be used to identify a time series for each entity.
    stride          = n datapoints the window is moved ahead along the sequence. Default: 1. If None, stride=window_len (no overlap)
    start           = determines the step where the first window is applied: 0 (default), a given step (int), or random within the 1st stride (None).
    horizon         = number of future datapoints to predict:</p>

<pre><code>                    * 0 for last step in each sub-window.
                    * n &gt; 0 for a range of n future steps (1 to n).
                    * n &lt; 0 for a range of n past steps (-n + 1 to 0).
                    * list : for those exact timesteps.
get_x           = indices of columns that contain the independent variable (xs). If None, all data will be used as x.
get_y           = indices of columns that contain the target (ys). If None, all data will be used as y. [] means no y data is created.
y_func          = function to calculate the ys based on the get_y col/s and each y sub-window. y_func must be a function applied to axis=1!
seq_first       = True if input shape (seq_len, n_vars), False if input shape (n_vars, seq_len)
sort_by         = column/s used for sorting the array in ascending order
ascending       = used in sorting
check_leakage   = checks if there's leakage in the output between X and y
return_key      = when True, the key corresponsing to unique_id_cols for each sample is returned


</code></pre>
<p>Input:
    You can use np.ndarray, pd.DataFrame or torch.Tensor as input
    shape: (seq_len, ) or (seq_len, n_vars) if seq_first=True else (n_vars, seq_len)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">samples</span> <span class="o">=</span> <span class="mi">100_000</span>
<span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">samples</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">10</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)]))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;var_0&#39;</span><span class="p">,</span> <span class="s1">&#39;var_1&#39;</span><span class="p">,</span> <span class="s1">&#39;var_2&#39;</span><span class="p">,</span> <span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df2</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">df3</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
<span class="n">df2</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
<span class="n">df3</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df3</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>var_4</th>
      <th>var_5</th>
      <th>var_6</th>
      <th>var_7</th>
      <th>var_8</th>
      <th>var_9</th>
      <th>time</th>
      <th>device</th>
      <th>target</th>
      <th>region</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>58520</td>
      <td>585182</td>
      <td>5851802</td>
      <td>58518000</td>
      <td>585180000</td>
      <td>5851800000</td>
      <td>58518000000</td>
      <td>585180000000</td>
      <td>5851800000000</td>
      <td>58518000000000</td>
      <td>58518</td>
      <td>2</td>
      <td>3</td>
      <td>B</td>
      <td>158522</td>
    </tr>
    <tr>
      <th>1</th>
      <td>52826</td>
      <td>528242</td>
      <td>5282402</td>
      <td>52824000</td>
      <td>528240000</td>
      <td>5282400000</td>
      <td>52824000000</td>
      <td>528240000000</td>
      <td>5282400000000</td>
      <td>52824000000000</td>
      <td>52824</td>
      <td>2</td>
      <td>2</td>
      <td>B</td>
      <td>152828</td>
    </tr>
    <tr>
      <th>2</th>
      <td>88389</td>
      <td>883872</td>
      <td>8838702</td>
      <td>88387000</td>
      <td>883870000</td>
      <td>8838700000</td>
      <td>88387000000</td>
      <td>883870000000</td>
      <td>8838700000000</td>
      <td>88387000000000</td>
      <td>88387</td>
      <td>2</td>
      <td>3</td>
      <td>B</td>
      <td>188391</td>
    </tr>
    <tr>
      <th>3</th>
      <td>64606</td>
      <td>646060</td>
      <td>6460600</td>
      <td>64606000</td>
      <td>646060000</td>
      <td>6460600000</td>
      <td>64606000000</td>
      <td>646060000000</td>
      <td>6460600000000</td>
      <td>64606000000000</td>
      <td>64606</td>
      <td>0</td>
      <td>0</td>
      <td>A</td>
      <td>64606</td>
    </tr>
    <tr>
      <th>4</th>
      <td>93005</td>
      <td>930032</td>
      <td>9300302</td>
      <td>93003000</td>
      <td>930030000</td>
      <td>9300300000</td>
      <td>93003000000</td>
      <td>930030000000</td>
      <td>9300300000000</td>
      <td>93003000000000</td>
      <td>93003</td>
      <td>2</td>
      <td>2</td>
      <td>B</td>
      <td>193007</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(200004, 15)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_key</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='3' class='' max='3' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [3/3 00:00<00:00]
    </div>
    
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;] = [1] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                               <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">key</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='3' class='' max='3' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [3/3 00:00<00:00]
    </div>
    
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;] = [1] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='3' class='' max='3' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [3/3 00:00<00:00]
    </div>
    
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;, &#39;region&#39;] = [1 &#39;A&#39;] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">y_max</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">y_func</span><span class="o">=</span><span class="n">y_max</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='3' class='' max='3' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [3/3 00:00<00:00]
    </div>
    
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;, &#39;region&#39;] = [1 &#39;A&#39;] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199982, 10, 5), (199982,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

