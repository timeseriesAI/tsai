---

title: Data preparation


keywords: fastai
sidebar: home_sidebar

summary: "Functions required to prepare X (and y) from a pandas dataframe."
description: "Functions required to prepare X (and y) from a pandas dataframe."
nb_path: "nbs/000c_data.preparation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/000c_data.preparation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="df2Xy" class="doc_header"><code>df2Xy</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/preparation.py#L13" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>df2Xy</code>(<strong><code>df</code></strong>, <strong><code>sample_col</code></strong>=<em><code>None</code></em>, <strong><code>feat_col</code></strong>=<em><code>None</code></em>, <strong><code>data_cols</code></strong>=<em><code>None</code></em>, <strong><code>target_col</code></strong>=<em><code>None</code></em>, <strong><code>to3d</code></strong>=<em><code>True</code></em>, <strong><code>splits</code></strong>=<em><code>None</code></em>, <strong><code>sort_by</code></strong>=<em><code>None</code></em>, <strong><code>ascending</code></strong>=<em><code>True</code></em>, <strong><code>y_func</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>This function allows you to transform a pandas dataframe into X and y numpy arrays that can be used to craete a TSDataset.
sample_col: column that uniquely identifies each sample.
feat_col: used for multivariate datasets. It indicates which is the column that indicates the feature by row.
data_col: indicates ths column/s where the data is located. If None, it means all columns (except the sample_col, feat_col, and target_col)
target_col: indicates the column/s where the target is.
to3d: turns X to 3d (including univariate time series)
sort_by: used to indicate how to sort the dataframe.
y_func: function used to calculate y for each sample (and target_col)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="split_Xy" class="doc_header"><code>split_Xy</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/preparation.py#L91" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>split_Xy</code>(<strong><code>X</code></strong>, <strong><code>y</code></strong>=<em><code>None</code></em>, <strong><code>splits</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_samples</span> <span class="o">=</span> <span class="mi">1_000</span>
<span class="n">n_rows</span> <span class="o">=</span> <span class="mi">10_000</span>

<span class="n">sample_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">n_rows</span><span class="o">//</span><span class="n">n_samples</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">feat_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_rows</span> <span class="o">//</span> <span class="n">n_samples</span><span class="p">),</span> <span class="n">n_samples</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cont</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">ind_cat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])[</span><span class="n">ind_cat</span><span class="p">]</span>
<span class="n">ind_cat2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">target2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])[</span><span class="n">ind_cat2</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">sample_ids</span><span class="p">,</span> <span class="n">feat_ids</span><span class="p">,</span> <span class="n">cont</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">target</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="s1">&#39;feat_id&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target2&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">new_dtypes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sample_id&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="s1">&#39;feat_id&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">new_dtypes</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>feat_id</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>target</th>
      <th>target2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>913</td>
      <td>0</td>
      <td>0.516306</td>
      <td>1.455767</td>
      <td>-0.909085</td>
      <td>0.343296</td>
      <td>0.199469</td>
      <td>1.438084</td>
      <td>a</td>
      <td>a</td>
    </tr>
    <tr>
      <th>1</th>
      <td>415</td>
      <td>5</td>
      <td>0.624918</td>
      <td>2.710536</td>
      <td>0.183670</td>
      <td>0.902973</td>
      <td>-0.562871</td>
      <td>2.082113</td>
      <td>c</td>
      <td>c</td>
    </tr>
    <tr>
      <th>2</th>
      <td>223</td>
      <td>8</td>
      <td>-0.547221</td>
      <td>1.420799</td>
      <td>-0.231653</td>
      <td>0.254948</td>
      <td>0.332902</td>
      <td>0.080678</td>
      <td>a</td>
      <td>a</td>
    </tr>
    <tr>
      <th>3</th>
      <td>133</td>
      <td>4</td>
      <td>2.061115</td>
      <td>-0.012561</td>
      <td>-0.443651</td>
      <td>-0.186470</td>
      <td>-0.267900</td>
      <td>-1.643608</td>
      <td>a</td>
      <td>a</td>
    </tr>
    <tr>
      <th>4</th>
      <td>380</td>
      <td>6</td>
      <td>0.622229</td>
      <td>2.023718</td>
      <td>1.024886</td>
      <td>-2.196236</td>
      <td>-1.724978</td>
      <td>-1.008602</td>
      <td>b</td>
      <td>b</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>756</td>
      <td>0</td>
      <td>0.786480</td>
      <td>0.288336</td>
      <td>-1.594304</td>
      <td>-0.151530</td>
      <td>2.449426</td>
      <td>-1.594877</td>
      <td>a</td>
      <td>a</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>739</td>
      <td>1</td>
      <td>0.156989</td>
      <td>-0.603900</td>
      <td>0.323931</td>
      <td>0.531661</td>
      <td>0.037619</td>
      <td>-1.310683</td>
      <td>b</td>
      <td>b</td>
    </tr>
    <tr>
      <th>9997</th>
      <td>564</td>
      <td>1</td>
      <td>0.980409</td>
      <td>-0.686886</td>
      <td>-0.312499</td>
      <td>0.283499</td>
      <td>-1.017951</td>
      <td>-2.648084</td>
      <td>a</td>
      <td>a</td>
    </tr>
    <tr>
      <th>9998</th>
      <td>274</td>
      <td>7</td>
      <td>-0.801587</td>
      <td>0.304059</td>
      <td>-1.398204</td>
      <td>1.769648</td>
      <td>0.735717</td>
      <td>-1.184793</td>
      <td>a</td>
      <td>a</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>493</td>
      <td>4</td>
      <td>1.964518</td>
      <td>0.830361</td>
      <td>0.383209</td>
      <td>-2.398209</td>
      <td>-2.268259</td>
      <td>-0.902662</td>
      <td>c</td>
      <td>c</td>
    </tr>
  </tbody>
</table>
<p>10000 rows Ã— 10 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;feat_id&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">],</span> <span class="n">target_col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
<span class="n">rand_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sample_id</span><span class="p">))</span>
<span class="n">sorted_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="s1">&#39;feat_id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">rand_idx</span><span class="p">],</span> <span class="n">sorted_df</span><span class="p">[</span><span class="n">sorted_df</span><span class="o">.</span><span class="n">sample_id</span> <span class="o">==</span> <span class="n">rand_idx</span><span class="p">][[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">sorted_df</span><span class="p">[</span><span class="n">sorted_df</span><span class="o">.</span><span class="n">sample_id</span> <span class="o">==</span> <span class="n">rand_idx</span><span class="p">][[</span><span class="s1">&#39;target&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span><span class="p">),</span> <span class="n">y</span><span class="p">[</span><span class="n">rand_idx</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;feat_id&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="s1">&#39;target2&#39;</span><span class="p">],</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">rand_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sample_id</span><span class="p">))</span>
<span class="n">sorted_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="s1">&#39;feat_id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">rand_idx</span><span class="p">],</span> <span class="n">sorted_df</span><span class="p">[</span><span class="n">sorted_df</span><span class="o">.</span><span class="n">sample_id</span> <span class="o">==</span> <span class="n">rand_idx</span><span class="p">][[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">sorted_df</span><span class="p">[</span><span class="n">sorted_df</span><span class="o">.</span><span class="n">sample_id</span> <span class="o">==</span> <span class="n">rand_idx</span><span class="p">][[</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="s1">&#39;target2&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span><span class="p">),</span> <span class="n">y</span><span class="p">[</span><span class="n">rand_idx</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;value_0;value_1;target</span>
<span class="s2">    rob;2;3;hot</span>
<span class="s2">    alice;6;7;lukewarm</span>
<span class="s2">    eve;11;12;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2Xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value_0&#39;</span><span class="p">,</span> <span class="s1">&#39;value_1&#39;</span><span class="p">],</span> <span class="n">sort_by</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>value_0</th>
      <th>value_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>alice</td>
      <td>6</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>2</th>
      <td>eve</td>
      <td>11</td>
      <td>12</td>
      <td>cold</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([[[ 6,  7]],
 
        [[11, 12]],
 
        [[ 2,  3]]]),
 array([&#39;lukewarm&#39;, &#39;cold&#39;, &#39;hot&#39;], dtype=object))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;timestep;values;target</span>
<span class="s2">    rob;1;2;hot</span>
<span class="s2">    alice;1;6;lukewarm</span>
<span class="s2">    eve;1;11;cold</span>
<span class="s2">    </span>
<span class="s2">    rob;2;3;hot</span>
<span class="s2">    alice;2;7;lukewarm</span>
<span class="s2">    eve;2;12;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">],</span> <span class="n">sort_by</span><span class="o">=</span><span class="s1">&#39;timestep&#39;</span><span class="p">,</span> <span class="n">to3d</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>timestep</th>
      <th>values</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>1</td>
      <td>2</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>alice</td>
      <td>1</td>
      <td>6</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>2</th>
      <td>eve</td>
      <td>1</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>2</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>5</th>
      <td>eve</td>
      <td>2</td>
      <td>12</td>
      <td>cold</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[[ 6 11]]

 [[ 2  7]]

 [[12  3]]] [&#39;lukewarm&#39; &#39;cold&#39; &#39;hot&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;trait;value_0;value_1;target</span>
<span class="s2">    rob;green;2;3;hot</span>
<span class="s2">    rob;yellow;3;4;hot</span>
<span class="s2">    rob;blue;4;5;hot</span>
<span class="s2">    rob;red;5;6;hot</span>
<span class="s2">    alice;green;6;7;lukewarm</span>
<span class="s2">    alice;yellow;7;8;lukewarm</span>
<span class="s2">    alice;blue;8;9;lukewarm</span>
<span class="s2">    alice;red;9;10;lukewarm</span>
<span class="s2">    eve;yellow;11;12;cold</span>
<span class="s2">    eve;green;10;11;cold</span>
<span class="s2">    eve;blue;12;12;cold</span>
<span class="s2">    eve;red;13;14;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;trait&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value_0&#39;</span><span class="p">,</span> <span class="s1">&#39;value_1&#39;</span><span class="p">],</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>trait</th>
      <th>value_0</th>
      <th>value_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9</th>
      <td>eve</td>
      <td>green</td>
      <td>10</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>green</td>
      <td>6</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rob</td>
      <td>yellow</td>
      <td>3</td>
      <td>4</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>8</th>
      <td>eve</td>
      <td>yellow</td>
      <td>11</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rob</td>
      <td>blue</td>
      <td>4</td>
      <td>5</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>red</td>
      <td>5</td>
      <td>6</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>11</th>
      <td>eve</td>
      <td>red</td>
      <td>13</td>
      <td>14</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>7</th>
      <td>alice</td>
      <td>red</td>
      <td>9</td>
      <td>10</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>6</th>
      <td>alice</td>
      <td>blue</td>
      <td>8</td>
      <td>9</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>10</th>
      <td>eve</td>
      <td>blue</td>
      <td>12</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alice</td>
      <td>yellow</td>
      <td>7</td>
      <td>8</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>green</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[[ 8  9]
  [ 6  7]
  [ 9 10]
  [ 7  8]]

 [[12 12]
  [10 11]
  [13 14]
  [11 12]]

 [[ 4  5]
  [ 2  3]
  [ 5  6]
  [ 3  4]]] [&#39;lukewarm&#39; &#39;cold&#39; &#39;hot&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;trait;value_0;value_1;target1;target2</span>
<span class="s2">    rob;green;2;3;hot;good</span>
<span class="s2">    rob;yellow;3;4;hot;good</span>
<span class="s2">    rob;blue;4;5;hot;good</span>
<span class="s2">    rob;red;5;6;hot;good</span>
<span class="s2">    alice;green;6;7;lukewarm;good</span>
<span class="s2">    alice;yellow;7;8;lukewarm;good</span>
<span class="s2">    alice;blue;8;9;lukewarm;good</span>
<span class="s2">    alice;red;9;10;lukewarm;good</span>
<span class="s2">    eve;yellow;11;12;cold;bad</span>
<span class="s2">    eve;green;10;11;cold;bad</span>
<span class="s2">    eve;blue;12;12;cold;bad</span>
<span class="s2">    eve;red;13;14;cold;bad</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;trait&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target1&#39;</span><span class="p">,</span> <span class="s1">&#39;target2&#39;</span><span class="p">],</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value_0&#39;</span><span class="p">,</span> <span class="s1">&#39;value_1&#39;</span><span class="p">],</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>trait</th>
      <th>value_0</th>
      <th>value_1</th>
      <th>target1</th>
      <th>target2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>green</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
      <td>good</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rob</td>
      <td>yellow</td>
      <td>3</td>
      <td>4</td>
      <td>hot</td>
      <td>good</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rob</td>
      <td>blue</td>
      <td>4</td>
      <td>5</td>
      <td>hot</td>
      <td>good</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>red</td>
      <td>5</td>
      <td>6</td>
      <td>hot</td>
      <td>good</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>green</td>
      <td>6</td>
      <td>7</td>
      <td>lukewarm</td>
      <td>good</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alice</td>
      <td>yellow</td>
      <td>7</td>
      <td>8</td>
      <td>lukewarm</td>
      <td>good</td>
    </tr>
    <tr>
      <th>6</th>
      <td>alice</td>
      <td>blue</td>
      <td>8</td>
      <td>9</td>
      <td>lukewarm</td>
      <td>good</td>
    </tr>
    <tr>
      <th>7</th>
      <td>alice</td>
      <td>red</td>
      <td>9</td>
      <td>10</td>
      <td>lukewarm</td>
      <td>good</td>
    </tr>
    <tr>
      <th>8</th>
      <td>eve</td>
      <td>yellow</td>
      <td>11</td>
      <td>12</td>
      <td>cold</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>9</th>
      <td>eve</td>
      <td>green</td>
      <td>10</td>
      <td>11</td>
      <td>cold</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>10</th>
      <td>eve</td>
      <td>blue</td>
      <td>12</td>
      <td>12</td>
      <td>cold</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>11</th>
      <td>eve</td>
      <td>red</td>
      <td>13</td>
      <td>14</td>
      <td>cold</td>
      <td>bad</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[[ 8  9]
  [ 6  7]
  [ 9 10]
  [ 7  8]]

 [[12 12]
  [10 11]
  [13 14]
  [11 12]]

 [[ 4  5]
  [ 2  3]
  [ 5  6]
  [ 3  4]]] [[&#39;lukewarm&#39; &#39;good&#39;]
 [&#39;cold&#39; &#39;bad&#39;]
 [&#39;hot&#39; &#39;good&#39;]]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;trait;value_0;value_1;target</span>
<span class="s2">    rob;green;2;3;hot</span>
<span class="s2">    rob;yellow;3;4;hot</span>
<span class="s2">    rob;blue;4;5;hot</span>
<span class="s2">    rob;red;5;6;hot</span>
<span class="s2">    alice;green;6;7;lukewarm</span>
<span class="s2">    alice;yellow;7;8;lukewarm</span>
<span class="s2">    alice;blue;8;9;lukewarm</span>
<span class="s2">    alice;red;9;10;lukewarm</span>
<span class="s2">    eve;yellow;11;12;cold</span>
<span class="s2">    eve;green;10;11;cold</span>
<span class="s2">    eve;blue;12;12;cold</span>
<span class="s2">    eve;red;13;14;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;trait&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value_0&#39;</span><span class="p">,</span> <span class="s1">&#39;value_1&#39;</span><span class="p">],</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>trait</th>
      <th>value_0</th>
      <th>value_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>green</td>
      <td>6</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>11</th>
      <td>eve</td>
      <td>red</td>
      <td>13</td>
      <td>14</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>7</th>
      <td>alice</td>
      <td>red</td>
      <td>9</td>
      <td>10</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>10</th>
      <td>eve</td>
      <td>blue</td>
      <td>12</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>8</th>
      <td>eve</td>
      <td>yellow</td>
      <td>11</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>red</td>
      <td>5</td>
      <td>6</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>9</th>
      <td>eve</td>
      <td>green</td>
      <td>10</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rob</td>
      <td>blue</td>
      <td>4</td>
      <td>5</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rob</td>
      <td>yellow</td>
      <td>3</td>
      <td>4</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>green</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alice</td>
      <td>yellow</td>
      <td>7</td>
      <td>8</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>6</th>
      <td>alice</td>
      <td>blue</td>
      <td>8</td>
      <td>9</td>
      <td>lukewarm</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[[ 8  9]
  [ 6  7]
  [ 9 10]
  [ 7  8]]

 [[12 12]
  [10 11]
  [13 14]
  [11 12]]

 [[ 4  5]
  [ 2  3]
  [ 5  6]
  [ 3  4]]] None
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;trait;timestep;values;target</span>
<span class="s2">    rob;green;1;2;hot</span>
<span class="s2">    rob;yellow;1;3;hot</span>
<span class="s2">    rob;blue;1;4;hot</span>
<span class="s2">    rob;red;1;5;hot</span>
<span class="s2">    alice;green;1;6;lukewarm</span>
<span class="s2">    alice;yellow;1;7;lukewarm</span>
<span class="s2">    alice;blue;1;8;lukewarm</span>
<span class="s2">    alice;red;1;9;lukewarm</span>
<span class="s2">    eve;yellow;1;11;cold</span>
<span class="s2">    eve;green;1;10;cold</span>
<span class="s2">    eve;blue;1;12;cold</span>
<span class="s2">    eve;red;1;13;cold</span>
<span class="s2">    </span>
<span class="s2">    rob;green;2;3;hot</span>
<span class="s2">    rob;yellow;2;4;hot</span>
<span class="s2">    rob;blue;2;5;hot</span>
<span class="s2">    rob;red;2;6;hot</span>
<span class="s2">    alice;green;2;7;lukewarm</span>
<span class="s2">    alice;yellow;2;8;lukewarm</span>
<span class="s2">    alice;blue;2;9;lukewarm</span>
<span class="s2">    alice;red;2;10;lukewarm</span>
<span class="s2">    eve;yellow;2;12;cold</span>
<span class="s2">    eve;green;2;11;cold</span>
<span class="s2">    eve;blue;2;13;cold</span>
<span class="s2">    eve;red;2;14;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">y_func</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;trait&#39;</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="s1">&#39;timestep&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">],</span> <span class="n">y_func</span><span class="o">=</span><span class="n">y_func</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>trait</th>
      <th>timestep</th>
      <th>values</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>green</td>
      <td>1</td>
      <td>2</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rob</td>
      <td>yellow</td>
      <td>1</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rob</td>
      <td>blue</td>
      <td>1</td>
      <td>4</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>red</td>
      <td>1</td>
      <td>5</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>green</td>
      <td>1</td>
      <td>6</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alice</td>
      <td>yellow</td>
      <td>1</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>6</th>
      <td>alice</td>
      <td>blue</td>
      <td>1</td>
      <td>8</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>7</th>
      <td>alice</td>
      <td>red</td>
      <td>1</td>
      <td>9</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>8</th>
      <td>eve</td>
      <td>yellow</td>
      <td>1</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>9</th>
      <td>eve</td>
      <td>green</td>
      <td>1</td>
      <td>10</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>10</th>
      <td>eve</td>
      <td>blue</td>
      <td>1</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>11</th>
      <td>eve</td>
      <td>red</td>
      <td>1</td>
      <td>13</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>12</th>
      <td>rob</td>
      <td>green</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>13</th>
      <td>rob</td>
      <td>yellow</td>
      <td>2</td>
      <td>4</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>14</th>
      <td>rob</td>
      <td>blue</td>
      <td>2</td>
      <td>5</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>15</th>
      <td>rob</td>
      <td>red</td>
      <td>2</td>
      <td>6</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>16</th>
      <td>alice</td>
      <td>green</td>
      <td>2</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>17</th>
      <td>alice</td>
      <td>yellow</td>
      <td>2</td>
      <td>8</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>18</th>
      <td>alice</td>
      <td>blue</td>
      <td>2</td>
      <td>9</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>19</th>
      <td>alice</td>
      <td>red</td>
      <td>2</td>
      <td>10</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>20</th>
      <td>eve</td>
      <td>yellow</td>
      <td>2</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>21</th>
      <td>eve</td>
      <td>green</td>
      <td>2</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>22</th>
      <td>eve</td>
      <td>blue</td>
      <td>2</td>
      <td>13</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>23</th>
      <td>eve</td>
      <td>red</td>
      <td>2</td>
      <td>14</td>
      <td>cold</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[[ 8  6]
  [ 9  7]
  [12 10]
  [13 11]]

 [[ 4  2]
  [ 5  3]
  [ 9  7]
  [10  8]]

 [[13 11]
  [14 12]
  [ 5  3]
  [ 6  4]]] [&#39;lukewarm&#39; &#39;cold&#39; &#39;hot&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="df2np3d" class="doc_header"><code>df2np3d</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/preparation.py#L110" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>df2np3d</code>(<strong><code>df</code></strong>, <strong><code>groupby</code></strong>, <strong><code>data_cols</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Transforms a df (with the same number of rows per group in groupby) to a 3d ndarray</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">user</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">user</span><span class="p">,</span> <span class="n">val</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">df2np3d</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_missing_value_cols" class="doc_header"><code>add_missing_value_cols</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/preparation.py#L116" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_missing_value_cols</code>(<strong><code>df</code></strong>, <strong><code>cols</code></strong>=<em><code>None</code></em>, <strong><code>dtype</code></strong>=<em><code>float</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">data</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">8</span>
<span class="n">data</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">add_missing_value_cols</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;missing_A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;missing_B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>missing_A</th>
      <th>missing_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.614729</td>
      <td>-0.627753</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.223881</td>
      <td>-0.972377</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.075731</td>
      <td>-0.940629</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.354901</td>
      <td>-2.430913</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.606703</td>
      <td>-2.148233</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>-0.753488</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>-0.036325</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-0.954861</td>
      <td>0.534639</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-0.716570</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>-0.505337</td>
      <td>-1.006285</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_missing_datetime" class="doc_header"><code>add_missing_datetime</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/preparation.py#L124" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_missing_datetime</code>(<strong><code>df</code></strong>, <strong><code>datetime_col</code></strong>, <strong><code>groupby</code></strong>=<em><code>None</code></em>, <strong><code>fill_value</code></strong>=<em><code>nan</code></em>, <strong><code>range_by_group</code></strong>=<em><code>True</code></em>, <strong><code>freq</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Fills missing datetime in a dataframe
Args:
    df:                      pandas DataFrame
    datetime_col:            column tha contains the datetime data
    groupby:                 column used to identify unique_ids
    fill_value:              values that will be insert where missing dates exist. Default:np.nan
    range_by_group:          if True, dates will be filled between min and max dates for each group. Otherwise, between the min and max dates in the df.
    freq:                    frequence used to fillin the missing datetime</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">today</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2021-05-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2021-05-07&#39;</span><span class="p">)</span>
<span class="n">dates2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">dates</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">dates</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]])</span>
<span class="n">dates3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">dates2</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">dates2</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">dates3</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">dates2</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">dates2</span>
<span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dates2</span><span class="p">))</span>
<span class="n">data</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">dates2</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">dates2</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
<span class="n">date_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span><span class="p">])</span>
<span class="n">date_df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">date_df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">])</span>
<span class="n">date_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>a</th>
      <th>key</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-05-01</td>
      <td>0.416850</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-05-02</td>
      <td>0.738152</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-05-03</td>
      <td>0.178315</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-05-06</td>
      <td>0.793299</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-05-07</td>
      <td>0.915250</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">add_missing_datetime</span><span class="p">(</span><span class="n">date_df</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>a</th>
      <th>key</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-05-01</td>
      <td>0.416850</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-05-02</td>
      <td>0.738152</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-05-03</td>
      <td>0.178315</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-05-04</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-05-05</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2021-05-06</td>
      <td>0.793299</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2021-05-07</td>
      <td>0.915250</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">add_missing_datetime</span><span class="p">(</span><span class="n">date_df</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">groupby</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>a</th>
      <th>key</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-05-03</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-05-04</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-05-05</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-05-06</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-05-07</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2021-05-01</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2021-05-02</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">add_missing_datetime</span><span class="p">(</span><span class="n">date_df</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">groupby</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="n">range_by_group</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>key</th>
      <th>a</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-05-01</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-05-02</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-05-03</td>
      <td>0.0</td>
      <td>0.178315</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-05-04</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-05-05</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2021-05-06</td>
      <td>0.0</td>
      <td>0.793299</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2021-05-07</td>
      <td>0.0</td>
      <td>0.915250</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2021-05-01</td>
      <td>1.0</td>
      <td>0.416850</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2021-05-02</td>
      <td>1.0</td>
      <td>0.738152</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2021-05-03</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2021-05-04</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2021-05-05</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2021-05-06</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2021-05-07</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="time_gaps" class="doc_header"><code>time_gaps</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/preparation.py#L164" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>time_gaps</code>(<strong><code>data</code></strong>, <strong><code>dir</code></strong>=<em><code>'forward'</code></em>)</p>
</blockquote>
<p>Calculates time gaps to the next (forward) or last (backward) mask time steps.
This is based on the parse_delta used in:
Cao, W., Wang, D., Li, J., Zhou, H., Li, L., &amp; Li, Y. (2018).
Brits: Bidirectional recurrent imputation for time series. arXiv preprint arXiv:1805.10572.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_delta_cols" class="doc_header"><code>add_delta_cols</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/preparation.py#L186" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_delta_cols</code>(<strong><code>df</code></strong>, <strong><code>cols</code></strong>=<em><code>None</code></em>, <strong><code>groupby</code></strong>=<em><code>None</code></em>, <strong><code>forward</code></strong>=<em><code>True</code></em>, <strong><code>backward</code></strong>=<em><code>True</code></em>, <strong><code>nearest</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">date_df</span> <span class="o">=</span> <span class="n">add_missing_datetime</span><span class="p">(</span><span class="n">date_df</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">groupby</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">)</span>
<span class="n">add_delta_cols</span><span class="p">(</span><span class="n">date_df</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>a</th>
      <th>key</th>
      <th>a_delta_f</th>
      <th>a_delta_b</th>
      <th>a_delta_n</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-05-03</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-05-04</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>6.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-05-05</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-05-06</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-05-07</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2021-05-01</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>2.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2021-05-02</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="SlidingWindow" class="doc_header"><code>SlidingWindow</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/preparation.py#L211" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>SlidingWindow</code>(<strong><code>window_len</code></strong>:<code>int</code>, <strong><code>stride</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>]=<em><code>1</code></em>, <strong><code>start</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>get_x</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>get_y</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>y_func</code></strong>:<code>Optional</code>[<code>callable</code>]=<em><code>None</code></em>, <strong><code>horizon</code></strong>:<code>Union</code>[<code>int</code>, <code>list</code>]=<em><code>1</code></em>, <strong><code>seq_first</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>sort_by</code></strong>:<code>Optional</code>[<code>list</code>]=<em><code>None</code></em>, <strong><code>ascending</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>check_leakage</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Applies a sliding window to a 1d or 2d input (np.ndarray, torch.Tensor or pd.DataFrame)</p>
<p>Args:
    window_len      = length of lookback window
    stride          = n datapoints the window is moved ahead along the sequence. Default: 1. If None, stride=window_len (no overlap)
    start           = determines the step where the first window is applied: 0 (default), a given step (int), or random within the 1st stride (None).
    horizon         = number of future datapoints to predict:</p>

<pre><code>                    * 0 for last step in each sub-window.
                    * n &gt; 0 for a range of n future steps (1 to n).
                    * n &lt; 0 for a range of n past steps (-n + 1 to 0).
                    * list : for those exact timesteps.
get_x           = indices of columns that contain the independent variable (xs). If None, all data will be used as x.
get_y           = indices of columns that contain the target (ys). If None, all data will be used as y. [] means no y data is created (unlabeled data).
y_func          = function to calculate the ys based on the get_y col/s and each y sub-window. y_func must be a function applied to axis=1!
seq_first       = True if input shape (seq_len, n_vars), False if input shape (n_vars, seq_len)
sort_by         = column/s used for sorting the array in ascending order
ascending       = used in sorting
check_leakage   = checks if there's leakage in the output between X and y


</code></pre>
<p>Input:
    You can use np.ndarray, pd.DataFrame or torch.Tensor as input
    shape: (seq_len, ) or (seq_len, n_vars) if seq_first=True else (n_vars, seq_len)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#5) [(array([[0, 1, 2, 3, 4]]),),(array([[1, 2, 3, 4, 5]]),),(array([[2, 3, 4, 5, 6]]),),(array([[3, 4, 5, 6, 7]]),),(array([[4, 5, 6, 7, 8]]),)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
[(array([[0, 1, 2, 3, 4]]), 5), (array([[1, 2, 3, 4, 5]]), 6), (array([[2, 3, 4, 5, 6]]), 7), (array([[3, 4, 5, 6, 7]]), 8), (array([[4, 5, 6, 7, 8]]), 9)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), 5), (array([[3, 4, 5, 6, 7]]), 8)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">start</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
[(array([[3, 4, 5, 6, 7]]), 8), (array([[ 8,  9, 10, 11, 12]]), 13), (array([[13, 14, 15, 16, 17]]), 18)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[5, 6, 7, 8, 9]]), 10), (array([[10, 11, 12, 13, 14]]), 15)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[1, 2, 3, 4, 5]]), 6), (array([[2, 3, 4, 5, 6]]), 7), (array([[3, 4, 5, 6, 7]]), 8), (array([[4, 5, 6, 7, 8]]), 9), (array([[5, 6, 7, 8, 9]]), 10), (array([[ 6,  7,  8,  9, 10]]), 11), (array([[ 7,  8,  9, 10, 11]]), 12), (array([[ 8,  9, 10, 11, 12]]), 13), (array([[ 9, 10, 11, 12, 13]]), 14), (array([[10, 11, 12, 13, 14]]), 15), (array([[11, 12, 13, 14, 15]]), 16), (array([[12, 13, 14, 15, 16]]), 17), (array([[13, 14, 15, 16, 17]]), 18), (array([[14, 15, 16, 17, 18]]), 19)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
      <td>16</td>
      <td>17</td>
      <td>18</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[5, 6, 7, 8, 9]]), 10), (array([[10, 11, 12, 13, 14]]), 15)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[  0,   1,   2,   3,   4],
       [  0,  10,  20,  30,  40],
       [  0, 100, 200, 300, 400]]), array([  5,  50, 500])), (array([[  1,   2,   3,   4,   5],
       [ 10,  20,  30,  40,  50],
       [100, 200, 300, 400, 500]]), array([  6,  60, 600])), (array([[  2,   3,   4,   5,   6],
       [ 20,  30,  40,  50,  60],
       [200, 300, 400, 500, 600]]), array([  7,  70, 700])), (array([[  3,   4,   5,   6,   7],
       [ 30,  40,  50,  60,  70],
       [300, 400, 500, 600, 700]]), array([  8,  80, 800])), (array([[  4,   5,   6,   7,   8],
       [ 40,  50,  60,  70,  80],
       [400, 500, 600, 700, 800]]), array([  9,  90, 900]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[  0,   1,   2,   3,   4],
       [  0,  10,  20,  30,  40],
       [  0, 100, 200, 300, 400]]), 5), (array([[  1,   2,   3,   4,   5],
       [ 10,  20,  30,  40,  50],
       [100, 200, 300, 400, 500]]), 6), (array([[  2,   3,   4,   5,   6],
       [ 20,  30,  40,  50,  60],
       [200, 300, 400, 500, 600]]), 7), (array([[  3,   4,   5,   6,   7],
       [ 30,  40,  50,  60,  70],
       [300, 400, 500, 600, 700]]), 8), (array([[  4,   5,   6,   7,   8],
       [ 40,  50,  60,  70,  80],
       [400, 500, 600, 700, 800]]), 9)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[ 0,  1,  2,  3,  4],
       [ 0, 10, 20, 30, 40]]), 500), (array([[ 1,  2,  3,  4,  5],
       [10, 20, 30, 40, 50]]), 600), (array([[ 2,  3,  4,  5,  6],
       [20, 30, 40, 50, 60]]), 700), (array([[ 3,  4,  5,  6,  7],
       [30, 40, 50, 60, 70]]), 800), (array([[ 4,  5,  6,  7,  8],
       [40, 50, 60, 70, 80]]), 900)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(1000, 3)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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rOGJJ54Y0nmSHD16lNdeew2Px0MsFhv4gF7ceuut/OQnPxnWtY9VxJinBmLMk5/hjler1WK32zl69GjO7Xnx+UejUR544AGuvPJK1q5dS1dXFy+99BI7dw6vGHEwGOTAgQPD7o/Vas0ZkTSZEWOeGogxT35GMt7+Ii5Hxfhv3bo1yzV0+PBh7rzzztE4vUAgEAhGGSHvIBAIBFMQYfwFAoFgCjIljP9UlJgQY54aiDFPfvI1Xs3cuXPHr5qAQCAQCMaFKTHzFwgEAkEmwvgLBALBFEQYf4FAIJiCCOMvEAgEUxBh/AUCgWAKIoy/QCAQTEHypuc/Eaiurubqq6+mpKSEI0eO8Ic//IHW1tbx7taIWbx4MZ/61KcoKSmhs7OTF154gXfffbff8U6Ge+FwOLjtttt4+OGHqampmfTjdTqdXHvttVRXV+Pz+di4cSObN2+etOM+5ZRTuOiii3C5XLS1tfHMM8+wc+fOSTve66+/nv379/PGG28A/Y8lH/dg0s78TSYT69at45VXXuGWW25h37593HDDDePdrRFjtVq58cYbefXVV/nmN7/JU089xec//3kqKir6HO9kuRef+9znsFgsQP9jmizjveGGG6ivr+c73/kODz/8MFdcccWk/T2XlJRw9dVX8/DDD3PzzTfzwgsvcOONN07K3/OSJUv49Kc/zapVq9S24Y5zJPdg0hr/FStW0N7eztatWwkGg7z44ouUl5czbdq08e7aiJg3bx4dHR28+eabRCIRdu7cSWNjIytXruxzvJPhXpx66qlEIhG6urqA/n+/k2G806dPp7CwkOeee45QKMThw4f52c9+xowZMybluOPxOLIsI0mSWgMkFApNyr/rqqoqdDodPT09attw/55Hcg8mrdunsrKSuro69XMsFqOlpYXS0lKamprGsWcj48CBAzz88MPqZ6vVSnFxMSeffDIfffSR2p4+3mP9XhQUFHDhhRdy5513cuuttwL9/36P9fECzJo1i/b2dq677joWL16M3+/n+eefp6KiYlKOu729nVdeeYX//M//VNseeeQRZsyYMenG++KLLwJQXl6utg3373kk92DSGn+z2YzX681oCwaDmEymcerR6OD1etVxVVdXc+2111JfX097ezt+vz9j3+R4j/V7cd111/Hss89mjKG/MR3r4wWl+tKCBQt4/PHHefzxx6murubLX/4ytbW1HD58OGPfyTDu6upqzjrrLH7+859TV1fHKaecwjXXXMO77747qX/PSYb79zySezBp3T5+vx+DwZDRZjQaswzksYjJZOL666/npptu4q233uK+++7rd7zH8r1Ys2YNPp+P999/P6N9so43nYaGBrZs2UI0GqWmpoa9e/cyd+7cSTnu448/nvfff5+DBw8SiUTYvHkznZ2dLFy4cFKOtzfD/XseyT2YtDP/pqYmTjnlFPWzVqulpKSE+vr6cezVyNHr9XzrW9+ip6eH22+/HbfbDfQ/XpvNdszeiwULFrBs2TLuv/9+QBn/TTfdRCAQyHitnSzjTdLe3o4kZc7NJEnir3/9KyeeeKLaNlnGHQ6H0ekyzVEsFuO1116blOPtzXC/vyO5B5N25r9t2zYqKipYvnw5BoOBT3ziE9TW1qrG8ljlpJNOQqfT8cADD2SMpb/xHsv34qGHHuKrX/2q+q+jo4Nf/vKX/OAHP5iU402ye/du7HY7a9asQafTsXjxYmbPns2uXbsm5bh37NjBCSecQHV1NTqdjlWrVmGz2XjnnXcm5Xh7M9zv70juwaSWdF6wYAFXX301hYWFHDx4kMcee+yY/MNI56qrruKMM85QIyKS/P73v8ftdvc53slyL+644w7+8Ic/UFNT0++YJsN4KyoquOqqq5gxYwatra387W9/Y9++fZN23CeeeCIXX3wxBQUFNDY28sQTT1BfXz9px/uNb3yDt99+W43zH+44h3sPJrXxFwgEAkFuJq3bRyAQCAR9I4y/QCAQTEGE8RcIBIIpiDD+AoFAMAURxl8gEAimIML4CwQCwRREGH+BQCCYggjjLxAIBFOQ/w8cj3ZPiZ2jZgAAAABJRU5ErkJggg==
"
>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(200, 2, 5) (200,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 3)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.431230</td>
      <td>0.477595</td>
      <td>0.459328</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.475764</td>
      <td>0.131162</td>
      <td>0.737657</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.354573</td>
      <td>-0.154485</td>
      <td>0.898112</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.054309</td>
      <td>0.185713</td>
      <td>1.110838</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.114173</td>
      <td>-0.308874</td>
      <td>1.290260</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>-1.433672</td>
      <td>-2.414882</td>
      <td>-0.305033</td>
    </tr>
    <tr>
      <th>96</th>
      <td>-1.423498</td>
      <td>-2.369802</td>
      <td>-0.759593</td>
    </tr>
    <tr>
      <th>97</th>
      <td>-1.386295</td>
      <td>-1.909611</td>
      <td>-0.391660</td>
    </tr>
    <tr>
      <th>98</th>
      <td>-1.436132</td>
      <td>-2.275568</td>
      <td>-0.171837</td>
    </tr>
    <tr>
      <th>99</th>
      <td>-1.846921</td>
      <td>-2.688856</td>
      <td>0.168162</td>
    </tr>
  </tbody>
</table>
<p>100 rows Ã— 3 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 2, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.277627</td>
      <td>-0.259756</td>
      <td>0.223401</td>
      <td>0.271753</td>
      <td>-0.091595</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.060366</td>
      <td>-0.417492</td>
      <td>0.219485</td>
      <td>0.042390</td>
      <td>-0.076915</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.520374</td>
      <td>-0.824907</td>
      <td>0.388113</td>
      <td>-0.349202</td>
      <td>-0.055654</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.388602</td>
      <td>-0.408350</td>
      <td>0.869714</td>
      <td>-0.407647</td>
      <td>-0.034628</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.445069</td>
      <td>-0.616753</td>
      <td>0.502487</td>
      <td>-0.067260</td>
      <td>-0.477724</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>-3.259514</td>
      <td>-1.966266</td>
      <td>2.575463</td>
      <td>-0.230634</td>
      <td>0.582603</td>
    </tr>
    <tr>
      <th>96</th>
      <td>-3.383375</td>
      <td>-2.387882</td>
      <td>2.999895</td>
      <td>-0.186500</td>
      <td>0.229923</td>
    </tr>
    <tr>
      <th>97</th>
      <td>-3.300104</td>
      <td>-2.768265</td>
      <td>3.400721</td>
      <td>0.169095</td>
      <td>0.069022</td>
    </tr>
    <tr>
      <th>98</th>
      <td>-3.192817</td>
      <td>-2.421795</td>
      <td>3.532286</td>
      <td>0.404467</td>
      <td>0.074909</td>
    </tr>
    <tr>
      <th>99</th>
      <td>-3.174963</td>
      <td>-2.901359</td>
      <td>3.733623</td>
      <td>0.284134</td>
      <td>-0.250413</td>
    </tr>
  </tbody>
</table>
<p>100 rows Ã— 5 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 4, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var_0</th>
      <td>0.332362</td>
      <td>0.699065</td>
      <td>0.710538</td>
      <td>1.138012</td>
      <td>0.915894</td>
      <td>0.668573</td>
      <td>0.223766</td>
      <td>0.573627</td>
      <td>0.823657</td>
      <td>0.905119</td>
      <td>...</td>
      <td>-2.640289</td>
      <td>-2.748938</td>
      <td>-2.343687</td>
      <td>-2.454711</td>
      <td>-2.058080</td>
      <td>-1.590798</td>
      <td>-1.268923</td>
      <td>-0.846448</td>
      <td>-0.898183</td>
      <td>-0.926325</td>
    </tr>
    <tr>
      <th>var_1</th>
      <td>-0.026581</td>
      <td>-0.275972</td>
      <td>0.113229</td>
      <td>0.554997</td>
      <td>0.974721</td>
      <td>0.502627</td>
      <td>0.344004</td>
      <td>0.002213</td>
      <td>-0.295112</td>
      <td>-0.556948</td>
      <td>...</td>
      <td>-1.107852</td>
      <td>-1.471366</td>
      <td>-1.510252</td>
      <td>-1.999638</td>
      <td>-1.752041</td>
      <td>-1.961972</td>
      <td>-2.402123</td>
      <td>-2.281577</td>
      <td>-2.305843</td>
      <td>-2.058012</td>
    </tr>
    <tr>
      <th>var_2</th>
      <td>-0.331852</td>
      <td>-0.667456</td>
      <td>-0.359610</td>
      <td>-0.031737</td>
      <td>0.371183</td>
      <td>0.784686</td>
      <td>0.446702</td>
      <td>0.488491</td>
      <td>0.733589</td>
      <td>0.437775</td>
      <td>...</td>
      <td>-0.586066</td>
      <td>-0.690001</td>
      <td>-0.568365</td>
      <td>-0.687266</td>
      <td>-0.486799</td>
      <td>-0.899549</td>
      <td>-1.121187</td>
      <td>-0.988124</td>
      <td>-0.947645</td>
      <td>-1.406732</td>
    </tr>
    <tr>
      <th>var_3</th>
      <td>0.031012</td>
      <td>0.401852</td>
      <td>0.480733</td>
      <td>0.470237</td>
      <td>0.900710</td>
      <td>0.694643</td>
      <td>0.898483</td>
      <td>1.126758</td>
      <td>0.917998</td>
      <td>1.390828</td>
      <td>...</td>
      <td>-0.959896</td>
      <td>-0.701231</td>
      <td>-0.213011</td>
      <td>-0.619164</td>
      <td>-0.447745</td>
      <td>-0.000031</td>
      <td>-0.013756</td>
      <td>0.389712</td>
      <td>0.869315</td>
      <td>0.874761</td>
    </tr>
    <tr>
      <th>target</th>
      <td>-0.354637</td>
      <td>-0.414439</td>
      <td>-0.075433</td>
      <td>0.027283</td>
      <td>-0.001868</td>
      <td>0.088725</td>
      <td>0.008946</td>
      <td>0.203827</td>
      <td>0.478971</td>
      <td>0.609537</td>
      <td>...</td>
      <td>2.534773</td>
      <td>2.514984</td>
      <td>2.701353</td>
      <td>2.961456</td>
      <td>2.567580</td>
      <td>2.264981</td>
      <td>2.294447</td>
      <td>2.706729</td>
      <td>2.696773</td>
      <td>2.476168</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 100 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 4, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var_0</th>
      <td>-0.457616</td>
      <td>-0.544390</td>
      <td>-0.352934</td>
      <td>-0.222590</td>
      <td>0.241268</td>
      <td>0.056922</td>
      <td>0.308266</td>
      <td>0.333158</td>
      <td>0.269032</td>
      <td>0.244962</td>
      <td>...</td>
      <td>-0.445991</td>
      <td>-0.182928</td>
      <td>-0.420216</td>
      <td>-0.205921</td>
      <td>-0.377687</td>
      <td>-0.141663</td>
      <td>0.071018</td>
      <td>0.456181</td>
      <td>0.752956</td>
      <td>1.056633</td>
    </tr>
    <tr>
      <th>var_1</th>
      <td>0.239752</td>
      <td>-0.009824</td>
      <td>0.116582</td>
      <td>-0.354314</td>
      <td>0.006607</td>
      <td>-0.219009</td>
      <td>-0.140530</td>
      <td>0.111803</td>
      <td>0.289139</td>
      <td>0.370788</td>
      <td>...</td>
      <td>-0.743959</td>
      <td>-0.260083</td>
      <td>-0.099541</td>
      <td>-0.212556</td>
      <td>-0.506749</td>
      <td>-0.506829</td>
      <td>-0.200632</td>
      <td>-0.633212</td>
      <td>-0.233882</td>
      <td>-0.434408</td>
    </tr>
    <tr>
      <th>var_2</th>
      <td>-0.470451</td>
      <td>-0.640481</td>
      <td>-0.667894</td>
      <td>-0.764481</td>
      <td>-0.350376</td>
      <td>-0.125020</td>
      <td>-0.438858</td>
      <td>-0.289906</td>
      <td>-0.220174</td>
      <td>0.206118</td>
      <td>...</td>
      <td>-2.035039</td>
      <td>-1.580225</td>
      <td>-1.602008</td>
      <td>-2.096485</td>
      <td>-1.749823</td>
      <td>-1.428221</td>
      <td>-1.231323</td>
      <td>-0.842015</td>
      <td>-1.035156</td>
      <td>-1.332498</td>
    </tr>
    <tr>
      <th>var_3</th>
      <td>0.190090</td>
      <td>0.040263</td>
      <td>0.188431</td>
      <td>-0.123704</td>
      <td>-0.593026</td>
      <td>-0.523533</td>
      <td>-0.300541</td>
      <td>-0.597201</td>
      <td>-0.422791</td>
      <td>-0.873605</td>
      <td>...</td>
      <td>0.710032</td>
      <td>0.299885</td>
      <td>0.378295</td>
      <td>0.217006</td>
      <td>-0.126821</td>
      <td>-0.063251</td>
      <td>-0.383307</td>
      <td>-0.092504</td>
      <td>-0.495022</td>
      <td>-0.931424</td>
    </tr>
    <tr>
      <th>target</th>
      <td>-0.140794</td>
      <td>-0.283998</td>
      <td>0.076546</td>
      <td>-0.332021</td>
      <td>-0.117906</td>
      <td>0.034880</td>
      <td>-0.442004</td>
      <td>-0.751818</td>
      <td>-0.362297</td>
      <td>-0.034618</td>
      <td>...</td>
      <td>-2.648656</td>
      <td>-2.671027</td>
      <td>-2.320827</td>
      <td>-2.412657</td>
      <td>-2.372594</td>
      <td>-2.159858</td>
      <td>-2.090725</td>
      <td>-1.892646</td>
      <td>-1.905535</td>
      <td>-2.039749</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 100 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(20, 4, 5) (20,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">TrainValidTestSplitter</span><span class="p">(</span><span class="n">valid_size</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">y</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">splits</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.125704</td>
      <td>-0.163152</td>
      <td>0.073899</td>
      <td>-0.488559</td>
      <td>-0.421805</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.113782</td>
      <td>-0.625877</td>
      <td>0.396930</td>
      <td>-0.645519</td>
      <td>-0.157495</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.171709</td>
      <td>-0.927011</td>
      <td>0.348951</td>
      <td>-0.512059</td>
      <td>-0.226929</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.497485</td>
      <td>-1.366723</td>
      <td>0.044576</td>
      <td>-0.882065</td>
      <td>-0.061826</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.522589</td>
      <td>-1.838567</td>
      <td>0.298239</td>
      <td>-1.238373</td>
      <td>-0.145567</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>-3.268875</td>
      <td>-3.379593</td>
      <td>2.533107</td>
      <td>-2.035754</td>
      <td>-2.437569</td>
    </tr>
    <tr>
      <th>96</th>
      <td>-2.920954</td>
      <td>-3.540436</td>
      <td>2.990629</td>
      <td>-1.994627</td>
      <td>-2.446094</td>
    </tr>
    <tr>
      <th>97</th>
      <td>-3.412568</td>
      <td>-3.128439</td>
      <td>3.407278</td>
      <td>-1.861868</td>
      <td>-2.473840</td>
    </tr>
    <tr>
      <th>98</th>
      <td>-3.898326</td>
      <td>-2.704068</td>
      <td>3.661842</td>
      <td>-2.007301</td>
      <td>-2.415793</td>
    </tr>
    <tr>
      <th>99</th>
      <td>-4.232574</td>
      <td>-2.392024</td>
      <td>3.936971</td>
      <td>-1.777452</td>
      <td>-2.380377</td>
    </tr>
  </tbody>
</table>
<p>100 rows Ã— 5 columns</p>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((96, 4, 5),
 (96,),
 ((#77) [0,1,2,3,4,5,6,7,8,9...], (#19) [77,78,79,80,81,82,83,84,85,86...]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="SlidingWindowPanel" class="doc_header"><code>SlidingWindowPanel</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/preparation.py#L292" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>SlidingWindowPanel</code>(<strong><code>window_len</code></strong>:<code>int</code>, <strong><code>unique_id_cols</code></strong>:<code>list</code>, <strong><code>stride</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>]=<em><code>1</code></em>, <strong><code>start</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>get_x</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>get_y</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>y_func</code></strong>:<code>Optional</code>[<code>callable</code>]=<em><code>None</code></em>, <strong><code>horizon</code></strong>:<code>Union</code>[<code>int</code>, <code>list</code>]=<em><code>1</code></em>, <strong><code>seq_first</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>sort_by</code></strong>:<code>Optional</code>[<code>list</code>]=<em><code>None</code></em>, <strong><code>ascending</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>check_leakage</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>return_key</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>verbose</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Applies a sliding window to a pd.DataFrame.</p>
<p>Args:
    window_len      = length of lookback window
    unique_id_cols  = pd.DataFrame columns that will be used to identify a time series for each entity.
    stride          = n datapoints the window is moved ahead along the sequence. Default: 1. If None, stride=window_len (no overlap)
    start           = determines the step where the first window is applied: 0 (default), a given step (int), or random within the 1st stride (None).
    horizon         = number of future datapoints to predict:</p>

<pre><code>                    * 0 for last step in each sub-window.
                    * n &gt; 0 for a range of n future steps (1 to n).
                    * n &lt; 0 for a range of n past steps (-n + 1 to 0).
                    * list : for those exact timesteps.
get_x           = indices of columns that contain the independent variable (xs). If None, all data will be used as x.
get_y           = indices of columns that contain the target (ys). If None, all data will be used as y. [] means no y data is created (unlabeled data).
y_func          = function to calculate the ys based on the get_y col/s and each y sub-window. y_func must be a function applied to axis=1!
seq_first       = True if input shape (seq_len, n_vars), False if input shape (n_vars, seq_len)
sort_by         = column/s used for sorting the array in ascending order
ascending       = used in sorting
check_leakage   = checks if there's leakage in the output between X and y
return_key      = when True, the key corresponsing to unique_id_cols for each sample is returned


</code></pre>
<p>Input:
    You can use np.ndarray, pd.DataFrame or torch.Tensor as input
    shape: (seq_len, ) or (seq_len, n_vars) if seq_first=True else (n_vars, seq_len)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">samples</span> <span class="o">=</span> <span class="mi">100_000</span>
<span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">samples</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">10</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)]))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;var_0&#39;</span><span class="p">,</span> <span class="s1">&#39;var_1&#39;</span><span class="p">,</span> <span class="s1">&#39;var_2&#39;</span><span class="p">,</span> <span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df2</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">df3</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
<span class="n">df2</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
<span class="n">df3</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df3</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>var_4</th>
      <th>var_5</th>
      <th>var_6</th>
      <th>var_7</th>
      <th>var_8</th>
      <th>var_9</th>
      <th>time</th>
      <th>device</th>
      <th>target</th>
      <th>region</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>25065</td>
      <td>250632</td>
      <td>2506302</td>
      <td>25063000</td>
      <td>250630000</td>
      <td>2506300000</td>
      <td>25063000000</td>
      <td>250630000000</td>
      <td>2506300000000</td>
      <td>25063000000000</td>
      <td>25063</td>
      <td>2</td>
      <td>3</td>
      <td>B</td>
      <td>125067</td>
    </tr>
    <tr>
      <th>1</th>
      <td>36419</td>
      <td>364172</td>
      <td>3641702</td>
      <td>36417000</td>
      <td>364170000</td>
      <td>3641700000</td>
      <td>36417000000</td>
      <td>364170000000</td>
      <td>3641700000000</td>
      <td>36417000000000</td>
      <td>36417</td>
      <td>2</td>
      <td>3</td>
      <td>B</td>
      <td>136421</td>
    </tr>
    <tr>
      <th>2</th>
      <td>42426</td>
      <td>424260</td>
      <td>4242600</td>
      <td>42426000</td>
      <td>424260000</td>
      <td>4242600000</td>
      <td>42426000000</td>
      <td>424260000000</td>
      <td>4242600000000</td>
      <td>42426000000000</td>
      <td>42426</td>
      <td>0</td>
      <td>0</td>
      <td>A</td>
      <td>42426</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16045</td>
      <td>160432</td>
      <td>1604302</td>
      <td>16043000</td>
      <td>160430000</td>
      <td>1604300000</td>
      <td>16043000000</td>
      <td>160430000000</td>
      <td>1604300000000</td>
      <td>16043000000000</td>
      <td>16043</td>
      <td>2</td>
      <td>2</td>
      <td>B</td>
      <td>116047</td>
    </tr>
    <tr>
      <th>4</th>
      <td>90642</td>
      <td>906402</td>
      <td>9064002</td>
      <td>90640000</td>
      <td>906400000</td>
      <td>9064000000</td>
      <td>90640000000</td>
      <td>906400000000</td>
      <td>9064000000000</td>
      <td>90640000000000</td>
      <td>90640</td>
      <td>2</td>
      <td>2</td>
      <td>B</td>
      <td>190644</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(200004, 15)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_key</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;] = [1] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                               <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">key</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;] = [1] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;, &#39;region&#39;] = [1 &#39;A&#39;] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">y_max</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">y_func</span><span class="o">=</span><span class="n">y_max</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;, &#39;region&#39;] = [1 &#39;A&#39;] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199982, 10, 5), (199982,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

