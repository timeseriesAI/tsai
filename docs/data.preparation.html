---

title: Data preparation


keywords: fastai
sidebar: home_sidebar

summary: "Functions required to prepare X (and y) from a pandas dataframe."
description: "Functions required to prepare X (and y) from a pandas dataframe."
nb_path: "nbs/000c_data.preparation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/000c_data.preparation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="df2xy" class="doc_header"><code>df2xy</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/preparation.py#L11" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>df2xy</code>(<strong><code>df</code></strong>, <strong><code>feat_col</code></strong>=<em><code>None</code></em>, <strong><code>target_col</code></strong>=<em><code>None</code></em>, <strong><code>data_cols</code></strong>=<em><code>None</code></em>, <strong><code>to3d</code></strong>=<em><code>True</code></em>, <strong><code>splits</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>This function allows you to transform a pandas dataframe into X and y numpy arrays that can be used to craete a TSDataset.
feat_col: used for multivariate datasets. It indicates which is the column that indicates the feature by row.
target_col: indicates the column/s where the target is.
data_col: indicates where the data is located. If None, it means all columns (excpet the target)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="split_xy" class="doc_header"><code>split_xy</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/preparation.py#L36" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>split_xy</code>(<strong><code>X</code></strong>, <strong><code>y</code></strong>=<em><code>None</code></em>, <strong><code>splits</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="SlidingWindow" class="doc_header"><code>SlidingWindow</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/preparation.py#L56" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>SlidingWindow</code>(<strong><code>window_len</code></strong>:<code>int</code>, <strong><code>stride</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>]=<em><code>1</code></em>, <strong><code>start</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>get_x</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>get_y</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>y_func</code></strong>:<code>Optional</code>[<code>callable</code>]=<em><code>None</code></em>, <strong><code>horizon</code></strong>:<code>Union</code>[<code>int</code>, <code>list</code>]=<em><code>1</code></em>, <strong><code>seq_first</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>sort_by</code></strong>:<code>Optional</code>[<code>list</code>]=<em><code>None</code></em>, <strong><code>ascending</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>check_leakage</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Applies a sliding window to a 1d or 2d input (np.ndarray, torch.Tensor or pd.DataFrame)</p>
<p>Args:
    window_len      = length of lookback window
    stride          = n datapoints the window is moved ahead along the sequence. Default: 1. If None, stride=window_len (no overlap)
    start           = determines the step where the first window is applied: 0 (default), a given step (int), or random within the 1st stride (None).
    horizon         = number of future datapoints to predict:</p>

<pre><code>                    * 0 for last step in each sub-window.
                    * n &gt; 0 for a range of n future steps (1 to n).
                    * n &lt; 0 for a range of n past steps (-n + 1 to 0).
                    * list : for those exact timesteps.
get_x           = indices of columns that contain the independent variable (xs). If None, all data will be used as x.
get_y           = indices of columns that contain the target (ys). If None, all data will be used as y. [] means no y data is created.
y_func          = function to calculate the ys based on the get_y col/s and each y sub-window. y_func must be a function applied to axis=1!
seq_first       = True if input shape (seq_len, n_vars), False if input shape (n_vars, seq_len)
sort_by         = column/s used for sorting the array in ascending order
ascending       = used in sorting
check_leakage   = checks if there's leakage in the output between X and y


</code></pre>
<p>Input:
    You can use np.ndarray, pd.DataFrame or torch.Tensor as input
    shape: (seq_len, ) or (seq_len, n_vars) if seq_first=True else (n_vars, seq_len)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#5) [(array([[0, 1, 2, 3, 4]]),),(array([[1, 2, 3, 4, 5]]),),(array([[2, 3, 4, 5, 6]]),),(array([[3, 4, 5, 6, 7]]),),(array([[4, 5, 6, 7, 8]]),)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
[(array([[0, 1, 2, 3, 4]]), 5), (array([[1, 2, 3, 4, 5]]), 6), (array([[2, 3, 4, 5, 6]]), 7), (array([[3, 4, 5, 6, 7]]), 8), (array([[4, 5, 6, 7, 8]]), 9)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), 5), (array([[3, 4, 5, 6, 7]]), 8)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">start</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
[(array([[3, 4, 5, 6, 7]]), 8), (array([[ 8,  9, 10, 11, 12]]), 13), (array([[13, 14, 15, 16, 17]]), 18)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[5, 6, 7, 8, 9]]), 10), (array([[10, 11, 12, 13, 14]]), 15)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[1, 2, 3, 4, 5]]), 6), (array([[2, 3, 4, 5, 6]]), 7), (array([[3, 4, 5, 6, 7]]), 8), (array([[4, 5, 6, 7, 8]]), 9), (array([[5, 6, 7, 8, 9]]), 10), (array([[ 6,  7,  8,  9, 10]]), 11), (array([[ 7,  8,  9, 10, 11]]), 12), (array([[ 8,  9, 10, 11, 12]]), 13), (array([[ 9, 10, 11, 12, 13]]), 14), (array([[10, 11, 12, 13, 14]]), 15), (array([[11, 12, 13, 14, 15]]), 16), (array([[12, 13, 14, 15, 16]]), 17), (array([[13, 14, 15, 16, 17]]), 18), (array([[14, 15, 16, 17, 18]]), 19)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
      <td>16</td>
      <td>17</td>
      <td>18</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[5, 6, 7, 8, 9]]), 10), (array([[10, 11, 12, 13, 14]]), 15)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[  0,   1,   2,   3,   4],
       [  0,  10,  20,  30,  40],
       [  0, 100, 200, 300, 400]]), array([  5,  50, 500])), (array([[  1,   2,   3,   4,   5],
       [ 10,  20,  30,  40,  50],
       [100, 200, 300, 400, 500]]), array([  6,  60, 600])), (array([[  2,   3,   4,   5,   6],
       [ 20,  30,  40,  50,  60],
       [200, 300, 400, 500, 600]]), array([  7,  70, 700])), (array([[  3,   4,   5,   6,   7],
       [ 30,  40,  50,  60,  70],
       [300, 400, 500, 600, 700]]), array([  8,  80, 800])), (array([[  4,   5,   6,   7,   8],
       [ 40,  50,  60,  70,  80],
       [400, 500, 600, 700, 800]]), array([  9,  90, 900]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[  0,   1,   2,   3,   4],
       [  0,  10,  20,  30,  40],
       [  0, 100, 200, 300, 400]]), 5), (array([[  1,   2,   3,   4,   5],
       [ 10,  20,  30,  40,  50],
       [100, 200, 300, 400, 500]]), 6), (array([[  2,   3,   4,   5,   6],
       [ 20,  30,  40,  50,  60],
       [200, 300, 400, 500, 600]]), 7), (array([[  3,   4,   5,   6,   7],
       [ 30,  40,  50,  60,  70],
       [300, 400, 500, 600, 700]]), 8), (array([[  4,   5,   6,   7,   8],
       [ 40,  50,  60,  70,  80],
       [400, 500, 600, 700, 800]]), 9)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[ 0,  1,  2,  3,  4],
       [ 0, 10, 20, 30, 40]]), 500), (array([[ 1,  2,  3,  4,  5],
       [10, 20, 30, 40, 50]]), 600), (array([[ 2,  3,  4,  5,  6],
       [20, 30, 40, 50, 60]]), 700), (array([[ 3,  4,  5,  6,  7],
       [30, 40, 50, 60, 70]]), 800), (array([[ 4,  5,  6,  7,  8],
       [40, 50, 60, 70, 80]]), 900)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(1000, 3)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(200, 2, 5) (200,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 3)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.038634</td>
      <td>0.293615</td>
      <td>0.130515</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.248407</td>
      <td>0.500844</td>
      <td>0.271745</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.541690</td>
      <td>0.569672</td>
      <td>-0.055736</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.316472</td>
      <td>0.700625</td>
      <td>-0.270632</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.031140</td>
      <td>1.097332</td>
      <td>-0.444498</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>2.356627</td>
      <td>2.934182</td>
      <td>-2.219459</td>
    </tr>
    <tr>
      <th>96</th>
      <td>2.368038</td>
      <td>2.805027</td>
      <td>-2.635984</td>
    </tr>
    <tr>
      <th>97</th>
      <td>1.918877</td>
      <td>3.143798</td>
      <td>-2.364252</td>
    </tr>
    <tr>
      <th>98</th>
      <td>2.101522</td>
      <td>3.618043</td>
      <td>-2.641366</td>
    </tr>
    <tr>
      <th>99</th>
      <td>2.404571</td>
      <td>3.448567</td>
      <td>-2.626506</td>
    </tr>
  </tbody>
</table>
<p>100 rows  3 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 2, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.339953</td>
      <td>-0.231598</td>
      <td>-0.158507</td>
      <td>-0.376152</td>
      <td>0.188453</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.518264</td>
      <td>-0.433457</td>
      <td>-0.137378</td>
      <td>-0.121059</td>
      <td>0.197342</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.655277</td>
      <td>-0.763794</td>
      <td>-0.077140</td>
      <td>-0.200773</td>
      <td>-0.022643</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.356016</td>
      <td>-1.168285</td>
      <td>-0.080036</td>
      <td>-0.544722</td>
      <td>0.434156</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.601960</td>
      <td>-0.679113</td>
      <td>-0.425577</td>
      <td>-0.990450</td>
      <td>0.400938</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>-2.182325</td>
      <td>-3.350593</td>
      <td>-0.949227</td>
      <td>3.391806</td>
      <td>0.779867</td>
    </tr>
    <tr>
      <th>96</th>
      <td>-2.107819</td>
      <td>-2.893040</td>
      <td>-0.484622</td>
      <td>3.232320</td>
      <td>0.685009</td>
    </tr>
    <tr>
      <th>97</th>
      <td>-1.809907</td>
      <td>-2.531993</td>
      <td>-0.671675</td>
      <td>3.317745</td>
      <td>0.913918</td>
    </tr>
    <tr>
      <th>98</th>
      <td>-2.114518</td>
      <td>-2.168623</td>
      <td>-0.412025</td>
      <td>3.351040</td>
      <td>1.402285</td>
    </tr>
    <tr>
      <th>99</th>
      <td>-2.123811</td>
      <td>-2.207333</td>
      <td>-0.738185</td>
      <td>3.281220</td>
      <td>1.283133</td>
    </tr>
  </tbody>
</table>
<p>100 rows  5 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 4, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var_0</th>
      <td>-0.296422</td>
      <td>-0.004598</td>
      <td>0.164111</td>
      <td>-0.237543</td>
      <td>-0.667590</td>
      <td>-0.320405</td>
      <td>-0.143456</td>
      <td>-0.143698</td>
      <td>-0.421195</td>
      <td>-0.603614</td>
      <td>...</td>
      <td>-0.971976</td>
      <td>-1.370836</td>
      <td>-1.225850</td>
      <td>-1.025264</td>
      <td>-0.877219</td>
      <td>-1.204666</td>
      <td>-0.722083</td>
      <td>-1.077655</td>
      <td>-1.454563</td>
      <td>-1.050101</td>
    </tr>
    <tr>
      <th>var_1</th>
      <td>-0.422348</td>
      <td>-0.877977</td>
      <td>-0.787166</td>
      <td>-0.334545</td>
      <td>-0.237831</td>
      <td>-0.452418</td>
      <td>-0.363222</td>
      <td>-0.236866</td>
      <td>0.101535</td>
      <td>0.074536</td>
      <td>...</td>
      <td>4.566848</td>
      <td>4.674314</td>
      <td>4.478981</td>
      <td>4.082767</td>
      <td>3.834859</td>
      <td>3.379363</td>
      <td>3.399050</td>
      <td>3.161341</td>
      <td>3.516137</td>
      <td>3.254749</td>
    </tr>
    <tr>
      <th>var_2</th>
      <td>-0.231705</td>
      <td>-0.616732</td>
      <td>-0.698399</td>
      <td>-0.610528</td>
      <td>-0.781778</td>
      <td>-1.030269</td>
      <td>-1.340659</td>
      <td>-1.216868</td>
      <td>-1.275779</td>
      <td>-0.972224</td>
      <td>...</td>
      <td>-3.558979</td>
      <td>-3.288104</td>
      <td>-3.229873</td>
      <td>-2.750648</td>
      <td>-3.196679</td>
      <td>-3.194926</td>
      <td>-3.475573</td>
      <td>-3.428084</td>
      <td>-3.328320</td>
      <td>-3.607683</td>
    </tr>
    <tr>
      <th>var_3</th>
      <td>0.075769</td>
      <td>0.560160</td>
      <td>1.028164</td>
      <td>1.121660</td>
      <td>1.061583</td>
      <td>0.952929</td>
      <td>0.676947</td>
      <td>0.847203</td>
      <td>0.649054</td>
      <td>0.899144</td>
      <td>...</td>
      <td>2.645536</td>
      <td>2.177091</td>
      <td>2.581504</td>
      <td>2.329453</td>
      <td>2.760319</td>
      <td>3.118379</td>
      <td>3.301651</td>
      <td>3.690350</td>
      <td>3.774698</td>
      <td>3.806809</td>
    </tr>
    <tr>
      <th>target</th>
      <td>0.142767</td>
      <td>0.206992</td>
      <td>0.381485</td>
      <td>0.316006</td>
      <td>0.688819</td>
      <td>1.021476</td>
      <td>0.713747</td>
      <td>0.802290</td>
      <td>0.629953</td>
      <td>1.000925</td>
      <td>...</td>
      <td>-0.389506</td>
      <td>-0.009419</td>
      <td>-0.020136</td>
      <td>0.427063</td>
      <td>0.388512</td>
      <td>0.456088</td>
      <td>0.203047</td>
      <td>-0.000248</td>
      <td>-0.336566</td>
      <td>-0.596576</td>
    </tr>
  </tbody>
</table>
<p>5 rows  100 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 4, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var_0</th>
      <td>0.338265</td>
      <td>-0.040953</td>
      <td>0.242118</td>
      <td>-0.197752</td>
      <td>-0.576452</td>
      <td>-0.260678</td>
      <td>-0.239231</td>
      <td>-0.012505</td>
      <td>0.120454</td>
      <td>-0.354439</td>
      <td>...</td>
      <td>1.490092</td>
      <td>1.253580</td>
      <td>1.721258</td>
      <td>1.488228</td>
      <td>1.802736</td>
      <td>1.923919</td>
      <td>2.304937</td>
      <td>2.284354</td>
      <td>2.281791</td>
      <td>2.116329</td>
    </tr>
    <tr>
      <th>var_1</th>
      <td>-0.291316</td>
      <td>0.201609</td>
      <td>0.672053</td>
      <td>1.133244</td>
      <td>1.170812</td>
      <td>1.242230</td>
      <td>1.210180</td>
      <td>0.812463</td>
      <td>0.867917</td>
      <td>0.624656</td>
      <td>...</td>
      <td>-0.992298</td>
      <td>-1.358868</td>
      <td>-1.523304</td>
      <td>-1.501742</td>
      <td>-1.802612</td>
      <td>-1.934327</td>
      <td>-2.048853</td>
      <td>-2.142365</td>
      <td>-1.943028</td>
      <td>-1.896114</td>
    </tr>
    <tr>
      <th>var_2</th>
      <td>-0.432033</td>
      <td>-0.741836</td>
      <td>-0.256991</td>
      <td>0.011420</td>
      <td>-0.143199</td>
      <td>-0.467257</td>
      <td>-0.740336</td>
      <td>-0.807564</td>
      <td>-1.121559</td>
      <td>-1.081806</td>
      <td>...</td>
      <td>-3.053388</td>
      <td>-2.626260</td>
      <td>-2.612326</td>
      <td>-2.848860</td>
      <td>-2.362454</td>
      <td>-1.905001</td>
      <td>-1.770754</td>
      <td>-1.327158</td>
      <td>-1.392714</td>
      <td>-0.932734</td>
    </tr>
    <tr>
      <th>var_3</th>
      <td>-0.284943</td>
      <td>-0.433715</td>
      <td>-0.161271</td>
      <td>-0.633758</td>
      <td>-0.692747</td>
      <td>-1.008369</td>
      <td>-0.794490</td>
      <td>-1.240046</td>
      <td>-1.510646</td>
      <td>-1.264417</td>
      <td>...</td>
      <td>-1.958702</td>
      <td>-1.794524</td>
      <td>-1.523518</td>
      <td>-1.038033</td>
      <td>-1.007817</td>
      <td>-1.046740</td>
      <td>-0.579652</td>
      <td>-0.138143</td>
      <td>0.349164</td>
      <td>-0.098881</td>
    </tr>
    <tr>
      <th>target</th>
      <td>0.236508</td>
      <td>0.280994</td>
      <td>0.695287</td>
      <td>0.897777</td>
      <td>0.542729</td>
      <td>0.633145</td>
      <td>0.214734</td>
      <td>0.271708</td>
      <td>0.421036</td>
      <td>0.792487</td>
      <td>...</td>
      <td>0.699957</td>
      <td>1.095765</td>
      <td>1.590161</td>
      <td>1.915267</td>
      <td>2.182267</td>
      <td>1.797175</td>
      <td>1.917014</td>
      <td>2.205364</td>
      <td>1.716323</td>
      <td>1.360022</td>
    </tr>
  </tbody>
</table>
<p>5 rows  100 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(20, 4, 5) (20,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">TrainValidTestSplitter</span><span class="p">(</span><span class="n">valid_size</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">y</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">splits</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.206897</td>
      <td>-0.392468</td>
      <td>-0.312597</td>
      <td>-0.136980</td>
      <td>0.348403</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.663572</td>
      <td>0.083953</td>
      <td>-0.433040</td>
      <td>-0.093337</td>
      <td>0.154357</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.006646</td>
      <td>-0.397654</td>
      <td>-0.662023</td>
      <td>0.342574</td>
      <td>-0.295306</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.723478</td>
      <td>-0.135558</td>
      <td>-0.311356</td>
      <td>0.366897</td>
      <td>0.055818</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.572234</td>
      <td>0.013035</td>
      <td>-0.629302</td>
      <td>0.583496</td>
      <td>0.326354</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>-0.045156</td>
      <td>-0.867526</td>
      <td>3.110634</td>
      <td>1.365687</td>
      <td>-2.138259</td>
    </tr>
    <tr>
      <th>96</th>
      <td>0.321400</td>
      <td>-1.209710</td>
      <td>3.314232</td>
      <td>1.181084</td>
      <td>-1.785342</td>
    </tr>
    <tr>
      <th>97</th>
      <td>0.510964</td>
      <td>-0.998249</td>
      <td>3.440313</td>
      <td>1.448730</td>
      <td>-1.505673</td>
    </tr>
    <tr>
      <th>98</th>
      <td>0.684856</td>
      <td>-1.487015</td>
      <td>3.247855</td>
      <td>1.375452</td>
      <td>-1.342623</td>
    </tr>
    <tr>
      <th>99</th>
      <td>0.527440</td>
      <td>-1.728492</td>
      <td>3.153996</td>
      <td>1.069943</td>
      <td>-1.824330</td>
    </tr>
  </tbody>
</table>
<p>100 rows  5 columns</p>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((96, 4, 5),
 (96,),
 ((#77) [0,1,2,3,4,5,6,7,8,9...], (#19) [77,78,79,80,81,82,83,84,85,86...]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="SlidingWindowPanel" class="doc_header"><code>SlidingWindowPanel</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/preparation.py#L133" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>SlidingWindowPanel</code>(<strong><code>window_len</code></strong>:<code>int</code>, <strong><code>unique_id_cols</code></strong>:<code>list</code>, <strong><code>stride</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>]=<em><code>1</code></em>, <strong><code>start</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>get_x</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>get_y</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>y_func</code></strong>:<code>Optional</code>[<code>callable</code>]=<em><code>None</code></em>, <strong><code>horizon</code></strong>:<code>Union</code>[<code>int</code>, <code>list</code>]=<em><code>1</code></em>, <strong><code>seq_first</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>sort_by</code></strong>:<code>Optional</code>[<code>list</code>]=<em><code>None</code></em>, <strong><code>ascending</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>check_leakage</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>return_key</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>verbose</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Applies a sliding window to a pd.DataFrame.</p>
<p>Args:
    window_len      = length of lookback window
    unique_id_cols  = pd.DataFrame columns that will be used to identify a time series for each entity.
    stride          = n datapoints the window is moved ahead along the sequence. Default: 1. If None, stride=window_len (no overlap)
    start           = determines the step where the first window is applied: 0 (default), a given step (int), or random within the 1st stride (None).
    horizon         = number of future datapoints to predict:</p>

<pre><code>                    * 0 for last step in each sub-window.
                    * n &gt; 0 for a range of n future steps (1 to n).
                    * n &lt; 0 for a range of n past steps (-n + 1 to 0).
                    * list : for those exact timesteps.
get_x           = indices of columns that contain the independent variable (xs). If None, all data will be used as x.
get_y           = indices of columns that contain the target (ys). If None, all data will be used as y. [] means no y data is created.
y_func          = function to calculate the ys based on the get_y col/s and each y sub-window. y_func must be a function applied to axis=1!
seq_first       = True if input shape (seq_len, n_vars), False if input shape (n_vars, seq_len)
sort_by         = column/s used for sorting the array in ascending order
ascending       = used in sorting
check_leakage   = checks if there's leakage in the output between X and y
return_key      = when True, the key corresponsing to unique_id_cols for each sample is returned


</code></pre>
<p>Input:
    You can use np.ndarray, pd.DataFrame or torch.Tensor as input
    shape: (seq_len, ) or (seq_len, n_vars) if seq_first=True else (n_vars, seq_len)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">samples</span> <span class="o">=</span> <span class="mi">100_000</span>
<span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">samples</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">10</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)]))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;var_0&#39;</span><span class="p">,</span> <span class="s1">&#39;var_1&#39;</span><span class="p">,</span> <span class="s1">&#39;var_2&#39;</span><span class="p">,</span> <span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df2</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">df3</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
<span class="n">df2</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
<span class="n">df3</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df3</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>var_4</th>
      <th>var_5</th>
      <th>var_6</th>
      <th>var_7</th>
      <th>var_8</th>
      <th>var_9</th>
      <th>time</th>
      <th>device</th>
      <th>target</th>
      <th>region</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>40803</td>
      <td>408012</td>
      <td>4080102</td>
      <td>40801000</td>
      <td>408010000</td>
      <td>4080100000</td>
      <td>40801000000</td>
      <td>408010000000</td>
      <td>4080100000000</td>
      <td>40801000000000</td>
      <td>40801</td>
      <td>2</td>
      <td>3</td>
      <td>B</td>
      <td>140805</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13059</td>
      <td>130572</td>
      <td>1305702</td>
      <td>13057000</td>
      <td>130570000</td>
      <td>1305700000</td>
      <td>13057000000</td>
      <td>130570000000</td>
      <td>1305700000000</td>
      <td>13057000000000</td>
      <td>13057</td>
      <td>2</td>
      <td>3</td>
      <td>B</td>
      <td>113061</td>
    </tr>
    <tr>
      <th>2</th>
      <td>19269</td>
      <td>192690</td>
      <td>1926900</td>
      <td>19269000</td>
      <td>192690000</td>
      <td>1926900000</td>
      <td>19269000000</td>
      <td>192690000000</td>
      <td>1926900000000</td>
      <td>19269000000000</td>
      <td>19269</td>
      <td>0</td>
      <td>0</td>
      <td>A</td>
      <td>19269</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10925</td>
      <td>109250</td>
      <td>1092500</td>
      <td>10925000</td>
      <td>109250000</td>
      <td>1092500000</td>
      <td>10925000000</td>
      <td>109250000000</td>
      <td>1092500000000</td>
      <td>10925000000000</td>
      <td>10925</td>
      <td>0</td>
      <td>0</td>
      <td>A</td>
      <td>10925</td>
    </tr>
    <tr>
      <th>4</th>
      <td>62408</td>
      <td>624080</td>
      <td>6240800</td>
      <td>62408000</td>
      <td>624080000</td>
      <td>6240800000</td>
      <td>62408000000</td>
      <td>624080000000</td>
      <td>6240800000000</td>
      <td>62408000000000</td>
      <td>62408</td>
      <td>0</td>
      <td>0</td>
      <td>A</td>
      <td>62408</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(200004, 15)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_key</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='3' class='' max='3' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [3/3 00:00<00:00]
    </div>
    
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;] = [1] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                               <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">key</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='3' class='' max='3' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [3/3 00:00<00:00]
    </div>
    
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;] = [1] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='3' class='' max='3' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [3/3 00:00<00:00]
    </div>
    
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;, &#39;region&#39;] = [1 &#39;A&#39;] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">y_max</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">y_func</span><span class="o">=</span><span class="n">y_max</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='3' class='' max='3' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [3/3 00:00<00:00]
    </div>
    
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;, &#39;region&#39;] = [1 &#39;A&#39;] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199982, 10, 5), (199982,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

