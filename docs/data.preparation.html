---

title: Data preparation


keywords: fastai
sidebar: home_sidebar

summary: "Functions required to prepare X (and y) from a pandas dataframe."
description: "Functions required to prepare X (and y) from a pandas dataframe."
nb_path: "nbs/000c_data.preparation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/000c_data.preparation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="df2xy" class="doc_header"><code>df2xy</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/preparation.py#L12" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>df2xy</code>(<strong><code>df</code></strong>, <strong><code>sample_col</code></strong>=<em><code>None</code></em>, <strong><code>feat_col</code></strong>=<em><code>None</code></em>, <strong><code>step_col</code></strong>=<em><code>None</code></em>, <strong><code>data_cols</code></strong>=<em><code>None</code></em>, <strong><code>target_col</code></strong>=<em><code>None</code></em>, <strong><code>to3d</code></strong>=<em><code>True</code></em>, <strong><code>splits</code></strong>=<em><code>None</code></em>, <strong><code>sort</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>This function allows you to transform a pandas dataframe into X and y numpy arrays that can be used to craete a TSDataset.
sample_col: column that uniquely identifies each sample.
feat_col: used for multivariate datasets. It indicates which is the column that indicates the feature by row.
step_col: used to indicate the order of the (time)steps when indicated in a column. It's only used to order data.
data_col: indicates ths column/s where the data is located. If None, it means all columns (except the sample_col, feat_col, step_col and target_col)
target_col: indicates the column/s where the target is.
to3d: turns X to 3d (including univariate time series)
sort: indicates whether the df needs to be sorted or not. If sorted, it will use sample col first, and feat_col second. For more complex sorting
      you'll need to pass a pre-sorted dataframe.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="split_xy" class="doc_header"><code>split_xy</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/preparation.py#L96" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>split_xy</code>(<strong><code>X</code></strong>, <strong><code>y</code></strong>=<em><code>None</code></em>, <strong><code>splits</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;value_0;value_1;target</span>
<span class="s2">    rob;2;3;hot</span>
<span class="s2">    alice;6;7;lukewarm</span>
<span class="s2">    eve;11;12;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value_0&#39;</span><span class="p">,</span> <span class="s1">&#39;value_1&#39;</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>value_0</th>
      <th>value_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>alice</td>
      <td>6</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>2</th>
      <td>eve</td>
      <td>11</td>
      <td>12</td>
      <td>cold</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;timestep;values;target</span>
<span class="s2">    rob;1;2;hot</span>
<span class="s2">    alice;1;6;lukewarm</span>
<span class="s2">    eve;1;11;cold</span>
<span class="s2">    </span>
<span class="s2">    rob;2;3;hot</span>
<span class="s2">    alice;2;7;lukewarm</span>
<span class="s2">    eve;2;12;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">step_col</span><span class="o">=</span><span class="s1">&#39;timestep&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">to3d</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>timestep</th>
      <th>values</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>1</td>
      <td>2</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>alice</td>
      <td>1</td>
      <td>6</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>2</th>
      <td>eve</td>
      <td>1</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>2</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>5</th>
      <td>eve</td>
      <td>2</td>
      <td>12</td>
      <td>cold</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;trait;value_0;value_1;target</span>
<span class="s2">    rob;green;2;3;hot</span>
<span class="s2">    rob;yellow;3;4;hot</span>
<span class="s2">    rob;blue;4;5;hot</span>
<span class="s2">    rob;red;5;6;hot</span>
<span class="s2">    alice;green;6;7;lukewarm</span>
<span class="s2">    alice;yellow;7;8;lukewarm</span>
<span class="s2">    alice;blue;8;9;lukewarm</span>
<span class="s2">    alice;red;9;10;lukewarm</span>
<span class="s2">    eve;yellow;11;12;cold</span>
<span class="s2">    eve;green;10;11;cold</span>
<span class="s2">    eve;blue;12;12;cold</span>
<span class="s2">    eve;red;13;14;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;trait&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value_0&#39;</span><span class="p">,</span> <span class="s1">&#39;value_1&#39;</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>trait</th>
      <th>value_0</th>
      <th>value_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>eve</td>
      <td>blue</td>
      <td>12</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rob</td>
      <td>yellow</td>
      <td>3</td>
      <td>4</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alice</td>
      <td>yellow</td>
      <td>7</td>
      <td>8</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>11</th>
      <td>eve</td>
      <td>red</td>
      <td>13</td>
      <td>14</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>green</td>
      <td>6</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>8</th>
      <td>eve</td>
      <td>yellow</td>
      <td>11</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>6</th>
      <td>alice</td>
      <td>blue</td>
      <td>8</td>
      <td>9</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>green</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rob</td>
      <td>blue</td>
      <td>4</td>
      <td>5</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>red</td>
      <td>5</td>
      <td>6</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>7</th>
      <td>alice</td>
      <td>red</td>
      <td>9</td>
      <td>10</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>9</th>
      <td>eve</td>
      <td>green</td>
      <td>10</td>
      <td>11</td>
      <td>cold</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[[ 8  9]
  [ 6  7]
  [ 9 10]
  [ 7  8]]

 [[12 12]
  [10 11]
  [13 14]
  [11 12]]

 [[ 4  5]
  [ 2  3]
  [ 5  6]
  [ 3  4]]] [&#39;lukewarm&#39; &#39;cold&#39; &#39;hot&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;trait;value_0;value_1;target1;target2</span>
<span class="s2">    rob;green;2;3;hot;good</span>
<span class="s2">    rob;yellow;3;4;hot;good</span>
<span class="s2">    rob;blue;4;5;hot;good</span>
<span class="s2">    rob;red;5;6;hot;good</span>
<span class="s2">    alice;green;6;7;lukewarm;good</span>
<span class="s2">    alice;yellow;7;8;lukewarm;good</span>
<span class="s2">    alice;blue;8;9;lukewarm;good</span>
<span class="s2">    alice;red;9;10;lukewarm;good</span>
<span class="s2">    eve;yellow;11;12;cold;bad</span>
<span class="s2">    eve;green;10;11;cold;bad</span>
<span class="s2">    eve;blue;12;12;cold;bad</span>
<span class="s2">    eve;red;13;14;cold;bad</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;trait&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target1&#39;</span><span class="p">,</span> <span class="s1">&#39;target2&#39;</span><span class="p">],</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value_0&#39;</span><span class="p">,</span> <span class="s1">&#39;value_1&#39;</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>trait</th>
      <th>value_0</th>
      <th>value_1</th>
      <th>target1</th>
      <th>target2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>green</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
      <td>good</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rob</td>
      <td>yellow</td>
      <td>3</td>
      <td>4</td>
      <td>hot</td>
      <td>good</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rob</td>
      <td>blue</td>
      <td>4</td>
      <td>5</td>
      <td>hot</td>
      <td>good</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>red</td>
      <td>5</td>
      <td>6</td>
      <td>hot</td>
      <td>good</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>green</td>
      <td>6</td>
      <td>7</td>
      <td>lukewarm</td>
      <td>good</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alice</td>
      <td>yellow</td>
      <td>7</td>
      <td>8</td>
      <td>lukewarm</td>
      <td>good</td>
    </tr>
    <tr>
      <th>6</th>
      <td>alice</td>
      <td>blue</td>
      <td>8</td>
      <td>9</td>
      <td>lukewarm</td>
      <td>good</td>
    </tr>
    <tr>
      <th>7</th>
      <td>alice</td>
      <td>red</td>
      <td>9</td>
      <td>10</td>
      <td>lukewarm</td>
      <td>good</td>
    </tr>
    <tr>
      <th>8</th>
      <td>eve</td>
      <td>yellow</td>
      <td>11</td>
      <td>12</td>
      <td>cold</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>9</th>
      <td>eve</td>
      <td>green</td>
      <td>10</td>
      <td>11</td>
      <td>cold</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>10</th>
      <td>eve</td>
      <td>blue</td>
      <td>12</td>
      <td>12</td>
      <td>cold</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>11</th>
      <td>eve</td>
      <td>red</td>
      <td>13</td>
      <td>14</td>
      <td>cold</td>
      <td>bad</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;trait;value_0;value_1;target</span>
<span class="s2">    rob;green;2;3;hot</span>
<span class="s2">    rob;yellow;3;4;hot</span>
<span class="s2">    rob;blue;4;5;hot</span>
<span class="s2">    rob;red;5;6;hot</span>
<span class="s2">    alice;green;6;7;lukewarm</span>
<span class="s2">    alice;yellow;7;8;lukewarm</span>
<span class="s2">    alice;blue;8;9;lukewarm</span>
<span class="s2">    alice;red;9;10;lukewarm</span>
<span class="s2">    eve;yellow;11;12;cold</span>
<span class="s2">    eve;green;10;11;cold</span>
<span class="s2">    eve;blue;12;12;cold</span>
<span class="s2">    eve;red;13;14;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;trait&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value_0&#39;</span><span class="p">,</span> <span class="s1">&#39;value_1&#39;</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>trait</th>
      <th>value_0</th>
      <th>value_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>rob</td>
      <td>blue</td>
      <td>4</td>
      <td>5</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>11</th>
      <td>eve</td>
      <td>red</td>
      <td>13</td>
      <td>14</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alice</td>
      <td>yellow</td>
      <td>7</td>
      <td>8</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>green</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rob</td>
      <td>yellow</td>
      <td>3</td>
      <td>4</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>7</th>
      <td>alice</td>
      <td>red</td>
      <td>9</td>
      <td>10</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>10</th>
      <td>eve</td>
      <td>blue</td>
      <td>12</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>9</th>
      <td>eve</td>
      <td>green</td>
      <td>10</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>green</td>
      <td>6</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>8</th>
      <td>eve</td>
      <td>yellow</td>
      <td>11</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>red</td>
      <td>5</td>
      <td>6</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>6</th>
      <td>alice</td>
      <td>blue</td>
      <td>8</td>
      <td>9</td>
      <td>lukewarm</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[[ 8  9]
  [ 6  7]
  [ 9 10]
  [ 7  8]]

 [[12 12]
  [10 11]
  [13 14]
  [11 12]]

 [[ 4  5]
  [ 2  3]
  [ 5  6]
  [ 3  4]]] None
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TESTDATA</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;sample_id;trait;timestep;values;target</span>
<span class="s2">    rob;green;1;2;hot</span>
<span class="s2">    rob;yellow;1;3;hot</span>
<span class="s2">    rob;blue;1;4;hot</span>
<span class="s2">    rob;red;1;5;hot</span>
<span class="s2">    alice;green;1;6;lukewarm</span>
<span class="s2">    alice;yellow;1;7;lukewarm</span>
<span class="s2">    alice;blue;1;8;lukewarm</span>
<span class="s2">    alice;red;1;9;lukewarm</span>
<span class="s2">    eve;yellow;1;11;cold</span>
<span class="s2">    eve;green;1;10;cold</span>
<span class="s2">    eve;blue;1;12;cold</span>
<span class="s2">    eve;red;1;13;cold</span>
<span class="s2">    </span>
<span class="s2">    rob;green;2;3;hot</span>
<span class="s2">    rob;yellow;2;4;hot</span>
<span class="s2">    rob;blue;2;5;hot</span>
<span class="s2">    rob;red;2;6;hot</span>
<span class="s2">    alice;green;2;7;lukewarm</span>
<span class="s2">    alice;yellow;2;8;lukewarm</span>
<span class="s2">    alice;blue;2;9;lukewarm</span>
<span class="s2">    alice;red;2;10;lukewarm</span>
<span class="s2">    eve;yellow;2;12;cold</span>
<span class="s2">    eve;green;2;11;cold</span>
<span class="s2">    eve;blue;2;13;cold</span>
<span class="s2">    eve;red;2;14;cold</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TESTDATA</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df2xy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_col</span><span class="o">=</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="n">feat_col</span><span class="o">=</span><span class="s1">&#39;trait&#39;</span><span class="p">,</span> <span class="n">step_col</span><span class="o">=</span><span class="s1">&#39;timestep&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">data_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>trait</th>
      <th>timestep</th>
      <th>values</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rob</td>
      <td>green</td>
      <td>1</td>
      <td>2</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rob</td>
      <td>yellow</td>
      <td>1</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rob</td>
      <td>blue</td>
      <td>1</td>
      <td>4</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rob</td>
      <td>red</td>
      <td>1</td>
      <td>5</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>4</th>
      <td>alice</td>
      <td>green</td>
      <td>1</td>
      <td>6</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alice</td>
      <td>yellow</td>
      <td>1</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>6</th>
      <td>alice</td>
      <td>blue</td>
      <td>1</td>
      <td>8</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>7</th>
      <td>alice</td>
      <td>red</td>
      <td>1</td>
      <td>9</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>8</th>
      <td>eve</td>
      <td>yellow</td>
      <td>1</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>9</th>
      <td>eve</td>
      <td>green</td>
      <td>1</td>
      <td>10</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>10</th>
      <td>eve</td>
      <td>blue</td>
      <td>1</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>11</th>
      <td>eve</td>
      <td>red</td>
      <td>1</td>
      <td>13</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>12</th>
      <td>rob</td>
      <td>green</td>
      <td>2</td>
      <td>3</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>13</th>
      <td>rob</td>
      <td>yellow</td>
      <td>2</td>
      <td>4</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>14</th>
      <td>rob</td>
      <td>blue</td>
      <td>2</td>
      <td>5</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>15</th>
      <td>rob</td>
      <td>red</td>
      <td>2</td>
      <td>6</td>
      <td>hot</td>
    </tr>
    <tr>
      <th>16</th>
      <td>alice</td>
      <td>green</td>
      <td>2</td>
      <td>7</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>17</th>
      <td>alice</td>
      <td>yellow</td>
      <td>2</td>
      <td>8</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>18</th>
      <td>alice</td>
      <td>blue</td>
      <td>2</td>
      <td>9</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>19</th>
      <td>alice</td>
      <td>red</td>
      <td>2</td>
      <td>10</td>
      <td>lukewarm</td>
    </tr>
    <tr>
      <th>20</th>
      <td>eve</td>
      <td>yellow</td>
      <td>2</td>
      <td>12</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>21</th>
      <td>eve</td>
      <td>green</td>
      <td>2</td>
      <td>11</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>22</th>
      <td>eve</td>
      <td>blue</td>
      <td>2</td>
      <td>13</td>
      <td>cold</td>
    </tr>
    <tr>
      <th>23</th>
      <td>eve</td>
      <td>red</td>
      <td>2</td>
      <td>14</td>
      <td>cold</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="SlidingWindow" class="doc_header"><code>SlidingWindow</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/preparation.py#L119" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>SlidingWindow</code>(<strong><code>window_len</code></strong>:<code>int</code>, <strong><code>stride</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>]=<em><code>1</code></em>, <strong><code>start</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>get_x</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>get_y</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>y_func</code></strong>:<code>Optional</code>[<code>callable</code>]=<em><code>None</code></em>, <strong><code>horizon</code></strong>:<code>Union</code>[<code>int</code>, <code>list</code>]=<em><code>1</code></em>, <strong><code>seq_first</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>sort_by</code></strong>:<code>Optional</code>[<code>list</code>]=<em><code>None</code></em>, <strong><code>ascending</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>check_leakage</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Applies a sliding window to a 1d or 2d input (np.ndarray, torch.Tensor or pd.DataFrame)</p>
<p>Args:
    window_len      = length of lookback window
    stride          = n datapoints the window is moved ahead along the sequence. Default: 1. If None, stride=window_len (no overlap)
    start           = determines the step where the first window is applied: 0 (default), a given step (int), or random within the 1st stride (None).
    horizon         = number of future datapoints to predict:</p>

<pre><code>                    * 0 for last step in each sub-window.
                    * n &gt; 0 for a range of n future steps (1 to n).
                    * n &lt; 0 for a range of n past steps (-n + 1 to 0).
                    * list : for those exact timesteps.
get_x           = indices of columns that contain the independent variable (xs). If None, all data will be used as x.
get_y           = indices of columns that contain the target (ys). If None, all data will be used as y. [] means no y data is created.
y_func          = function to calculate the ys based on the get_y col/s and each y sub-window. y_func must be a function applied to axis=1!
seq_first       = True if input shape (seq_len, n_vars), False if input shape (n_vars, seq_len)
sort_by         = column/s used for sorting the array in ascending order
ascending       = used in sorting
check_leakage   = checks if there's leakage in the output between X and y


</code></pre>
<p>Input:
    You can use np.ndarray, pd.DataFrame or torch.Tensor as input
    shape: (seq_len, ) or (seq_len, n_vars) if seq_first=True else (n_vars, seq_len)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#5) [(array([[0, 1, 2, 3, 4]]),),(array([[1, 2, 3, 4, 5]]),),(array([[2, 3, 4, 5, 6]]),),(array([[3, 4, 5, 6, 7]]),),(array([[4, 5, 6, 7, 8]]),)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
[(array([[0, 1, 2, 3, 4]]), 5), (array([[1, 2, 3, 4, 5]]), 6), (array([[2, 3, 4, 5, 6]]), 7), (array([[3, 4, 5, 6, 7]]), 8), (array([[4, 5, 6, 7, 8]]), 9)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (10,)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># 2 or more</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), array([5, 6])), (array([[1, 2, 3, 4, 5]]), array([6, 7])), (array([[2, 3, 4, 5, 6]]), array([7, 8])), (array([[3, 4, 5, 6, 7]]), array([8, 9]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (1, 10)
[(array([[0, 1, 2, 3, 4]]), 5), (array([[3, 4, 5, 6, 7]]), 8)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">start</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
[(array([[3, 4, 5, 6, 7]]), 8), (array([[ 8,  9, 10, 11, 12]]), 13), (array([[13, 14, 15, 16, 17]]), 18)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[5, 6, 7, 8, 9]]), 10), (array([[10, 11, 12, 13, 14]]), 15)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[1, 2, 3, 4, 5]]), 6), (array([[2, 3, 4, 5, 6]]), 7), (array([[3, 4, 5, 6, 7]]), 8), (array([[4, 5, 6, 7, 8]]), 9), (array([[5, 6, 7, 8, 9]]), 10), (array([[ 6,  7,  8,  9, 10]]), 11), (array([[ 7,  8,  9, 10, 11]]), 12), (array([[ 8,  9, 10, 11, 12]]), 13), (array([[ 9, 10, 11, 12, 13]]), 14), (array([[10, 11, 12, 13, 14]]), 15), (array([[11, 12, 13, 14, 15]]), 16), (array([[12, 13, 14, 15, 16]]), 17), (array([[13, 14, 15, 16, 17]]), 18), (array([[14, 15, 16, 17, 18]]), 19)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: (20,)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
      <td>16</td>
      <td>17</td>
      <td>18</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[0, 1, 2, 3, 4]]), 5), (array([[5, 6, 7, 8, 9]]), 10), (array([[10, 11, 12, 13, 14]]), 15)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[  0,   1,   2,   3,   4],
       [  0,  10,  20,  30,  40],
       [  0, 100, 200, 300, 400]]), array([  5,  50, 500])), (array([[  1,   2,   3,   4,   5],
       [ 10,  20,  30,  40,  50],
       [100, 200, 300, 400, 500]]), array([  6,  60, 600])), (array([[  2,   3,   4,   5,   6],
       [ 20,  30,  40,  50,  60],
       [200, 300, 400, 500, 600]]), array([  7,  70, 700])), (array([[  3,   4,   5,   6,   7],
       [ 30,  40,  50,  60,  70],
       [300, 400, 500, 600, 700]]), array([  8,  80, 800])), (array([[  4,   5,   6,   7,   8],
       [ 40,  50,  60,  70,  80],
       [400, 500, 600, 700, 800]]), array([  9,  90, 900]))]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">0</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[  0,   1,   2,   3,   4],
       [  0,  10,  20,  30,  40],
       [  0, 100, 200, 300, 400]]), 5), (array([[  1,   2,   3,   4,   5],
       [ 10,  20,  30,  40,  50],
       [100, 200, 300, 400, 500]]), 6), (array([[  2,   3,   4,   5,   6],
       [ 20,  30,  40,  50,  60],
       [200, 300, 400, 500, 600]]), 7), (array([[  3,   4,   5,   6,   7],
       [ 30,  40,  50,  60,  70],
       [300, 400, 500, 600, 700]]), 8), (array([[  4,   5,   6,   7,   8],
       [ 40,  50,  60,  70,  80],
       [400, 500, 600, 700, 800]]), 9)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input shape:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">itemify</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>input shape: torch.Size([10, 3])
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>20</td>
      <td>200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>30</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>40</td>
      <td>400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>50</td>
      <td>500</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>60</td>
      <td>600</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>70</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>80</td>
      <td>800</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>90</td>
      <td>900</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(array([[ 0,  1,  2,  3,  4],
       [ 0, 10, 20, 30, 40]]), 500), (array([[ 1,  2,  3,  4,  5],
       [10, 20, 30, 40, 50]]), 600), (array([[ 2,  3,  4,  5,  6],
       [20, 30, 40, 50, 60]]), 700), (array([[ 3,  4,  5,  6,  7],
       [30, 40, 50, 60, 70]]), 800), (array([[ 4,  5,  6,  7,  8],
       [40, 50, 60, 70, 80]]), 900)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(1000, 3)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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+9//zt///neKioq4/fbbqayspKKiIm7fqXDfXdX6fvnLX1JVVcWKFSu44YYb2LVr15T+O3cx3O/zSD6DKWv2cblcaLXauDadTtdDICcjer2em2++mW984xt88MEH/Pa3v+33fifzZ7Fq1apIidBYpur9xlJbW8v27dsJBAKUlpZy5MgRCgsLp+R9L126lN27d1NeXo7f7+e9996jra2NuXPnTsn77c5wv88j+Qym7Mi/vr6eFStWRN6rVCrS0tKorq6ewF6NHI1Gw3e+8x06Ozt54IEHsNlsQP/3azabJ+1nUVxczMKFC/nd734HyPf/jW98A7fbHTetnSr320VLSwtKZfzYTKlU8txzz3HaaadF2qbKfft8PtTqeDkKBoO88847U/J+uzPc3+9IPoMpO/Lfu3cvOTk5LFq0CK1Wy1VXXUVlZWVELCcry5YtQ61W88c//jHuXvq738n8WTz55JPceeedkX+tra38/ve/57777puS99vFwYMHSUhIYNWqVajVakpKSpg5cyYHDhyYkve9b98+Tj31VIqKilCr1Sxfvhyz2cxHH300Je+3O8P9/Y7kM5jSKZ2Li4tZu3YtycnJlJeX8/TTT0/KL0Ys119/Peecc07EI6KLv/3tb9hstj7vd6p8Fg899BAbNmygtLS033uaCvebk5PD9ddfT15eHk1NTbzwwgscPXp0yt73aaedxmWXXUZSUhJ1dXX885//pLq6esre7913382HH34Y8fMf7n0O9zOY0uIvEAgEgt6ZsmYfgUAgEPSNEH+BQCCYhgjxFwgEgmmIEH+BQCCYhgjxFwgEgmmIEH+BQCCYhgjxFwgEgmmIEH+BQCCYhvx/DjWcD+7gQXkAAAAASUVORK5CYII=
"
>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(200, 2, 5) (200,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 3)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.231978</td>
      <td>0.073219</td>
      <td>0.133267</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.467310</td>
      <td>0.393773</td>
      <td>-0.145846</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.596566</td>
      <td>0.206710</td>
      <td>-0.166565</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.685837</td>
      <td>-0.234336</td>
      <td>0.033277</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.134745</td>
      <td>0.107733</td>
      <td>0.232557</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>-5.460119</td>
      <td>-2.531420</td>
      <td>2.144726</td>
    </tr>
    <tr>
      <th>96</th>
      <td>-5.651039</td>
      <td>-2.287359</td>
      <td>2.137362</td>
    </tr>
    <tr>
      <th>97</th>
      <td>-5.768159</td>
      <td>-2.291407</td>
      <td>2.056863</td>
    </tr>
    <tr>
      <th>98</th>
      <td>-5.335280</td>
      <td>-1.887203</td>
      <td>1.920184</td>
    </tr>
    <tr>
      <th>99</th>
      <td>-5.103885</td>
      <td>-1.486621</td>
      <td>1.886013</td>
    </tr>
  </tbody>
</table>
<p>100 rows  3 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 2, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.193542</td>
      <td>0.324859</td>
      <td>-0.439214</td>
      <td>0.427244</td>
      <td>-0.410780</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.078862</td>
      <td>0.147746</td>
      <td>-0.681942</td>
      <td>0.380159</td>
      <td>-0.104505</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.355172</td>
      <td>0.365881</td>
      <td>-0.432425</td>
      <td>0.725684</td>
      <td>-0.585669</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.602106</td>
      <td>0.783386</td>
      <td>-0.789050</td>
      <td>0.928138</td>
      <td>-1.006820</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.053169</td>
      <td>1.243051</td>
      <td>-0.817524</td>
      <td>1.250919</td>
      <td>-0.912237</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>2.177680</td>
      <td>0.023329</td>
      <td>-6.360521</td>
      <td>-1.917417</td>
      <td>1.037216</td>
    </tr>
    <tr>
      <th>96</th>
      <td>2.300952</td>
      <td>0.452308</td>
      <td>-6.840108</td>
      <td>-2.008926</td>
      <td>1.506521</td>
    </tr>
    <tr>
      <th>97</th>
      <td>2.645694</td>
      <td>0.470447</td>
      <td>-7.125660</td>
      <td>-2.367854</td>
      <td>1.572651</td>
    </tr>
    <tr>
      <th>98</th>
      <td>2.149996</td>
      <td>0.699077</td>
      <td>-6.795947</td>
      <td>-2.094254</td>
      <td>1.527571</td>
    </tr>
    <tr>
      <th>99</th>
      <td>1.715769</td>
      <td>1.065219</td>
      <td>-6.919268</td>
      <td>-2.408687</td>
      <td>1.427634</td>
    </tr>
  </tbody>
</table>
<p>100 rows  5 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 4, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var_0</th>
      <td>0.037698</td>
      <td>-0.105557</td>
      <td>-0.070702</td>
      <td>-0.264796</td>
      <td>-0.357515</td>
      <td>-0.819990</td>
      <td>-1.112825</td>
      <td>-1.390167</td>
      <td>-1.604567</td>
      <td>-1.996689</td>
      <td>...</td>
      <td>-3.339660</td>
      <td>-2.987781</td>
      <td>-2.724810</td>
      <td>-2.304022</td>
      <td>-2.054406</td>
      <td>-1.834835</td>
      <td>-2.096242</td>
      <td>-2.543453</td>
      <td>-2.119549</td>
      <td>-2.443395</td>
    </tr>
    <tr>
      <th>var_1</th>
      <td>-0.388118</td>
      <td>-0.511601</td>
      <td>-0.683879</td>
      <td>-0.655155</td>
      <td>-0.893629</td>
      <td>-0.985884</td>
      <td>-1.001955</td>
      <td>-1.314903</td>
      <td>-0.819247</td>
      <td>-0.822493</td>
      <td>...</td>
      <td>3.212981</td>
      <td>3.117866</td>
      <td>2.661699</td>
      <td>2.220735</td>
      <td>1.950584</td>
      <td>1.890528</td>
      <td>1.920944</td>
      <td>2.275084</td>
      <td>2.149109</td>
      <td>1.854139</td>
    </tr>
    <tr>
      <th>var_2</th>
      <td>-0.308623</td>
      <td>0.083552</td>
      <td>0.479843</td>
      <td>0.585789</td>
      <td>0.977275</td>
      <td>1.349887</td>
      <td>0.961452</td>
      <td>1.330115</td>
      <td>1.400043</td>
      <td>0.904188</td>
      <td>...</td>
      <td>1.424624</td>
      <td>1.729130</td>
      <td>1.924212</td>
      <td>1.935811</td>
      <td>2.364440</td>
      <td>1.927599</td>
      <td>1.804408</td>
      <td>2.148883</td>
      <td>1.710551</td>
      <td>1.435207</td>
    </tr>
    <tr>
      <th>var_3</th>
      <td>0.246121</td>
      <td>0.426827</td>
      <td>0.216639</td>
      <td>0.493663</td>
      <td>0.570160</td>
      <td>0.930049</td>
      <td>1.162472</td>
      <td>0.753258</td>
      <td>0.294986</td>
      <td>0.608925</td>
      <td>...</td>
      <td>2.294901</td>
      <td>2.730669</td>
      <td>2.846544</td>
      <td>2.717469</td>
      <td>3.056577</td>
      <td>2.625756</td>
      <td>3.024835</td>
      <td>3.197316</td>
      <td>3.060408</td>
      <td>2.947579</td>
    </tr>
    <tr>
      <th>target</th>
      <td>0.159147</td>
      <td>0.424405</td>
      <td>0.127447</td>
      <td>0.538327</td>
      <td>0.421830</td>
      <td>-0.036106</td>
      <td>0.443024</td>
      <td>0.481708</td>
      <td>0.974320</td>
      <td>0.614118</td>
      <td>...</td>
      <td>2.356571</td>
      <td>2.853381</td>
      <td>3.046959</td>
      <td>3.066095</td>
      <td>2.986333</td>
      <td>2.648783</td>
      <td>2.965836</td>
      <td>3.152990</td>
      <td>3.433206</td>
      <td>3.860239</td>
    </tr>
  </tbody>
</table>
<p>5 rows  100 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(96, 4, 5) (96,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var_0</th>
      <td>-0.016014</td>
      <td>-0.193834</td>
      <td>-0.339561</td>
      <td>-0.152544</td>
      <td>-0.588451</td>
      <td>-0.564479</td>
      <td>-0.690441</td>
      <td>-0.282655</td>
      <td>-0.241216</td>
      <td>-0.682800</td>
      <td>...</td>
      <td>3.219176</td>
      <td>3.295780</td>
      <td>3.355775</td>
      <td>3.667801</td>
      <td>3.230419</td>
      <td>2.906828</td>
      <td>3.121994</td>
      <td>3.049943</td>
      <td>2.612439</td>
      <td>2.622993</td>
    </tr>
    <tr>
      <th>var_1</th>
      <td>0.357825</td>
      <td>0.824825</td>
      <td>0.458150</td>
      <td>0.194628</td>
      <td>0.592070</td>
      <td>0.920952</td>
      <td>0.511189</td>
      <td>0.692682</td>
      <td>0.312670</td>
      <td>0.268487</td>
      <td>...</td>
      <td>-1.814576</td>
      <td>-1.716377</td>
      <td>-2.153985</td>
      <td>-2.628978</td>
      <td>-2.918884</td>
      <td>-2.823221</td>
      <td>-3.041023</td>
      <td>-2.706213</td>
      <td>-2.371573</td>
      <td>-2.359086</td>
    </tr>
    <tr>
      <th>var_2</th>
      <td>-0.483149</td>
      <td>-0.827982</td>
      <td>-0.673997</td>
      <td>-0.428824</td>
      <td>-0.670703</td>
      <td>-0.685619</td>
      <td>-0.860849</td>
      <td>-0.449036</td>
      <td>-0.510888</td>
      <td>-0.823725</td>
      <td>...</td>
      <td>-0.062656</td>
      <td>0.363169</td>
      <td>0.444994</td>
      <td>0.628416</td>
      <td>0.731142</td>
      <td>0.977617</td>
      <td>1.472593</td>
      <td>1.450841</td>
      <td>1.077101</td>
      <td>1.041675</td>
    </tr>
    <tr>
      <th>var_3</th>
      <td>0.486444</td>
      <td>0.723155</td>
      <td>0.466988</td>
      <td>0.840850</td>
      <td>0.350828</td>
      <td>0.614538</td>
      <td>0.685082</td>
      <td>1.148884</td>
      <td>0.774725</td>
      <td>0.924849</td>
      <td>...</td>
      <td>-2.383779</td>
      <td>-2.830171</td>
      <td>-2.995482</td>
      <td>-3.248839</td>
      <td>-2.842244</td>
      <td>-2.443995</td>
      <td>-2.590630</td>
      <td>-3.026265</td>
      <td>-2.920851</td>
      <td>-3.382990</td>
    </tr>
    <tr>
      <th>target</th>
      <td>-0.119082</td>
      <td>-0.298034</td>
      <td>-0.275854</td>
      <td>-0.273088</td>
      <td>0.047840</td>
      <td>-0.271275</td>
      <td>0.046206</td>
      <td>0.126967</td>
      <td>-0.256164</td>
      <td>0.098582</td>
      <td>...</td>
      <td>0.581407</td>
      <td>0.919777</td>
      <td>1.228744</td>
      <td>1.552627</td>
      <td>1.515195</td>
      <td>1.387484</td>
      <td>1.186082</td>
      <td>0.794743</td>
      <td>0.598146</td>
      <td>0.211030</td>
    </tr>
  </tbody>
</table>
<p>5 rows  100 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(20, 4, 5) (20,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">n_vars</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">TrainValidTestSplitter</span><span class="p">(</span><span class="n">valid_size</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">y</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">splits</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.131496</td>
      <td>0.070269</td>
      <td>0.412551</td>
      <td>0.189576</td>
      <td>-0.153332</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.167632</td>
      <td>0.465777</td>
      <td>-0.060265</td>
      <td>-0.011191</td>
      <td>0.296560</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.116138</td>
      <td>0.897045</td>
      <td>0.097421</td>
      <td>0.445967</td>
      <td>-0.144950</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.226665</td>
      <td>0.652027</td>
      <td>0.147494</td>
      <td>0.820836</td>
      <td>-0.241105</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.000226</td>
      <td>0.283581</td>
      <td>0.024860</td>
      <td>1.108368</td>
      <td>-0.089519</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>3.773133</td>
      <td>0.422684</td>
      <td>-2.050712</td>
      <td>1.405679</td>
      <td>1.166771</td>
    </tr>
    <tr>
      <th>96</th>
      <td>3.457718</td>
      <td>0.269076</td>
      <td>-2.312521</td>
      <td>1.252371</td>
      <td>1.210241</td>
    </tr>
    <tr>
      <th>97</th>
      <td>3.378739</td>
      <td>-0.203600</td>
      <td>-2.188210</td>
      <td>1.495613</td>
      <td>0.795452</td>
    </tr>
    <tr>
      <th>98</th>
      <td>3.592979</td>
      <td>-0.389619</td>
      <td>-1.935572</td>
      <td>1.903787</td>
      <td>1.111848</td>
    </tr>
    <tr>
      <th>99</th>
      <td>4.043369</td>
      <td>0.057584</td>
      <td>-2.044682</td>
      <td>1.914914</td>
      <td>1.423631</td>
    </tr>
  </tbody>
</table>
<p>100 rows  5 columns</p>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((96, 4, 5),
 (96,),
 ((#77) [0,1,2,3,4,5,6,7,8,9...], (#19) [77,78,79,80,81,82,83,84,85,86...]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="SlidingWindowPanel" class="doc_header"><code>SlidingWindowPanel</code><a href="https://github.com/timeseriesAI/tsai/tree/master/tsai/data/preparation.py#L198" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>SlidingWindowPanel</code>(<strong><code>window_len</code></strong>:<code>int</code>, <strong><code>unique_id_cols</code></strong>:<code>list</code>, <strong><code>stride</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>]=<em><code>1</code></em>, <strong><code>start</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>get_x</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>get_y</code></strong>:<code>Union</code>[<code>NoneType</code>, <code>int</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>y_func</code></strong>:<code>Optional</code>[<code>callable</code>]=<em><code>None</code></em>, <strong><code>horizon</code></strong>:<code>Union</code>[<code>int</code>, <code>list</code>]=<em><code>1</code></em>, <strong><code>seq_first</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>sort_by</code></strong>:<code>Optional</code>[<code>list</code>]=<em><code>None</code></em>, <strong><code>ascending</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>check_leakage</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>return_key</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>verbose</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Applies a sliding window to a pd.DataFrame.</p>
<p>Args:
    window_len      = length of lookback window
    unique_id_cols  = pd.DataFrame columns that will be used to identify a time series for each entity.
    stride          = n datapoints the window is moved ahead along the sequence. Default: 1. If None, stride=window_len (no overlap)
    start           = determines the step where the first window is applied: 0 (default), a given step (int), or random within the 1st stride (None).
    horizon         = number of future datapoints to predict:</p>

<pre><code>                    * 0 for last step in each sub-window.
                    * n &gt; 0 for a range of n future steps (1 to n).
                    * n &lt; 0 for a range of n past steps (-n + 1 to 0).
                    * list : for those exact timesteps.
get_x           = indices of columns that contain the independent variable (xs). If None, all data will be used as x.
get_y           = indices of columns that contain the target (ys). If None, all data will be used as y. [] means no y data is created.
y_func          = function to calculate the ys based on the get_y col/s and each y sub-window. y_func must be a function applied to axis=1!
seq_first       = True if input shape (seq_len, n_vars), False if input shape (n_vars, seq_len)
sort_by         = column/s used for sorting the array in ascending order
ascending       = used in sorting
check_leakage   = checks if there's leakage in the output between X and y
return_key      = when True, the key corresponsing to unique_id_cols for each sample is returned


</code></pre>
<p>Input:
    You can use np.ndarray, pd.DataFrame or torch.Tensor as input
    shape: (seq_len, ) or (seq_len, n_vars) if seq_first=True else (n_vars, seq_len)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">samples</span> <span class="o">=</span> <span class="mi">100_000</span>
<span class="n">wl</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_vars</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">n_vars</span> <span class="o">*</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">samples</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">10</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)]))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;var_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;var_0&#39;</span><span class="p">,</span> <span class="s1">&#39;var_1&#39;</span><span class="p">,</span> <span class="s1">&#39;var_2&#39;</span><span class="p">,</span> <span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">df2</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">df3</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
<span class="n">df2</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
<span class="n">df3</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df3</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_0</th>
      <th>var_1</th>
      <th>var_2</th>
      <th>var_3</th>
      <th>var_4</th>
      <th>var_5</th>
      <th>var_6</th>
      <th>var_7</th>
      <th>var_8</th>
      <th>var_9</th>
      <th>time</th>
      <th>device</th>
      <th>target</th>
      <th>region</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9152</td>
      <td>91502</td>
      <td>915002</td>
      <td>9150000</td>
      <td>91500000</td>
      <td>915000000</td>
      <td>9150000000</td>
      <td>91500000000</td>
      <td>915000000000</td>
      <td>9150000000000</td>
      <td>9150</td>
      <td>2</td>
      <td>3</td>
      <td>B</td>
      <td>109154</td>
    </tr>
    <tr>
      <th>1</th>
      <td>89744</td>
      <td>897440</td>
      <td>8974400</td>
      <td>89744000</td>
      <td>897440000</td>
      <td>8974400000</td>
      <td>89744000000</td>
      <td>897440000000</td>
      <td>8974400000000</td>
      <td>89744000000000</td>
      <td>89744</td>
      <td>0</td>
      <td>1</td>
      <td>A</td>
      <td>89744</td>
    </tr>
    <tr>
      <th>2</th>
      <td>54719</td>
      <td>547172</td>
      <td>5471702</td>
      <td>54717000</td>
      <td>547170000</td>
      <td>5471700000</td>
      <td>54717000000</td>
      <td>547170000000</td>
      <td>5471700000000</td>
      <td>54717000000000</td>
      <td>54717</td>
      <td>2</td>
      <td>3</td>
      <td>B</td>
      <td>154721</td>
    </tr>
    <tr>
      <th>3</th>
      <td>30152</td>
      <td>301520</td>
      <td>3015200</td>
      <td>30152000</td>
      <td>301520000</td>
      <td>3015200000</td>
      <td>30152000000</td>
      <td>301520000000</td>
      <td>3015200000000</td>
      <td>30152000000000</td>
      <td>30152</td>
      <td>0</td>
      <td>1</td>
      <td>A</td>
      <td>30152</td>
    </tr>
    <tr>
      <th>4</th>
      <td>34153</td>
      <td>341512</td>
      <td>3415102</td>
      <td>34151000</td>
      <td>341510000</td>
      <td>3415100000</td>
      <td>34151000000</td>
      <td>341510000000</td>
      <td>3415100000000</td>
      <td>34151000000000</td>
      <td>34151</td>
      <td>2</td>
      <td>3</td>
      <td>B</td>
      <td>134155</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(200004, 15)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_key</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;] = [1] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                               <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">key</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;] = [1] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">horizon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;, &#39;region&#39;] = [1 &#39;A&#39;] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199992, 10, 5), (199992,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">y_max</span><span class="p">(</span><span class="n">o</span><span class="p">):</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SlidingWindowPanel</span><span class="p">(</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unique_id_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="n">n_vars</span><span class="p">],</span> <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> 
                          <span class="n">y_func</span><span class="o">=</span><span class="n">y_max</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">seq_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cannot use [&#39;device&#39;, &#39;region&#39;] = [1 &#39;A&#39;] due to not having enough records
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((199982, 10, 5), (199982,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

